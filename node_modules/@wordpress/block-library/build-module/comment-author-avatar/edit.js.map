{"version":3,"sources":["@wordpress/block-library/src/comment-author-avatar/edit.js"],"names":["InspectorControls","useBlockProps","__experimentalGetSpacingClassesAndStyles","useSpacingProps","store","blockEditorStore","PanelBody","ResizableBox","RangeControl","useEntityProp","useSelect","__","isRTL","Edit","attributes","context","commentId","setAttributes","isSelected","height","width","avatars","authorName","avatarUrls","Object","values","sizes","keys","minSize","maxSize","length","blockProps","spacingProps","maxSizeBuffer","Math","floor","avatarURL","select","getSettings","__experimentalDiscussionSettings","inspectorControls","newWidth","resizableAvatar","event","direction","elt","delta","parseInt","top","right","bottom","left"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tInspectorControls,\n\tuseBlockProps,\n\t__experimentalGetSpacingClassesAndStyles as useSpacingProps,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { PanelBody, ResizableBox, RangeControl } from '@wordpress/components';\nimport { useEntityProp } from '@wordpress/core-data';\nimport { useSelect } from '@wordpress/data';\nimport { __, isRTL } from '@wordpress/i18n';\n\nexport default function Edit( {\n\tattributes,\n\tcontext: { commentId },\n\tsetAttributes,\n\tisSelected,\n} ) {\n\tconst { height, width } = attributes;\n\n\tconst [ avatars ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_avatar_urls',\n\t\tcommentId\n\t);\n\n\tconst [ authorName ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_name',\n\t\tcommentId\n\t);\n\tconst avatarUrls = avatars ? Object.values( avatars ) : null;\n\tconst sizes = avatars ? Object.keys( avatars ) : null;\n\tconst minSize = sizes ? sizes[ 0 ] : 24;\n\tconst maxSize = sizes ? sizes[ sizes.length - 1 ] : 96;\n\tconst blockProps = useBlockProps();\n\tconst spacingProps = useSpacingProps( attributes );\n\tconst maxSizeBuffer = Math.floor( maxSize * 2.5 );\n\tconst { avatarURL } = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst { __experimentalDiscussionSettings } = getSettings();\n\t\treturn __experimentalDiscussionSettings;\n\t} );\n\n\tconst inspectorControls = (\n\t\t<InspectorControls>\n\t\t\t<PanelBody title={ __( 'Avatar Settings' ) }>\n\t\t\t\t<RangeControl\n\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\tlabel={ __( 'Image size' ) }\n\t\t\t\t\tonChange={ ( newWidth ) =>\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\twidth: newWidth,\n\t\t\t\t\t\t\theight: newWidth,\n\t\t\t\t\t\t} )\n\t\t\t\t\t}\n\t\t\t\t\tmin={ minSize }\n\t\t\t\t\tmax={ maxSizeBuffer }\n\t\t\t\t\tinitialPosition={ width }\n\t\t\t\t\tvalue={ width }\n\t\t\t\t/>\n\t\t\t</PanelBody>\n\t\t</InspectorControls>\n\t);\n\n\tconst resizableAvatar = (\n\t\t<ResizableBox\n\t\t\tsize={ {\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t} }\n\t\t\tshowHandle={ isSelected }\n\t\t\tonResizeStop={ ( event, direction, elt, delta ) => {\n\t\t\t\tsetAttributes( {\n\t\t\t\t\theight: parseInt( height + delta.height, 10 ),\n\t\t\t\t\twidth: parseInt( width + delta.width, 10 ),\n\t\t\t\t} );\n\t\t\t} }\n\t\t\tlockAspectRatio\n\t\t\tenable={ {\n\t\t\t\ttop: false,\n\t\t\t\tright: ! isRTL(),\n\t\t\t\tbottom: true,\n\t\t\t\tleft: isRTL(),\n\t\t\t} }\n\t\t\tminWidth={ minSize }\n\t\t\tmaxWidth={ maxSizeBuffer }\n\t\t>\n\t\t\t<img\n\t\t\t\tsrc={\n\t\t\t\t\tavatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : avatarURL\n\t\t\t\t}\n\t\t\t\talt={ `${ authorName } ${ __( 'Avatar' ) }` }\n\t\t\t\t{ ...blockProps }\n\t\t\t/>\n\t\t</ResizableBox>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ inspectorControls }\n\t\t\t<div { ...spacingProps }>{ resizableAvatar }</div>\n\t\t</>\n\t);\n}\n"]}