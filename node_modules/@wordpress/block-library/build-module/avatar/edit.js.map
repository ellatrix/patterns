{"version":3,"sources":["@wordpress/block-library/src/avatar/edit.js"],"names":["classnames","InspectorControls","useBlockProps","__experimentalUseBorderProps","useBorderProps","PanelBody","RangeControl","ResizableBox","ToggleControl","__","isRTL","addQueryArgs","removeQueryArgs","useUserAvatar","useCommentAvatar","UserControl","AvatarInspectorControls","setAttributes","avatar","attributes","selectUser","newSize","size","minSize","maxSize","isLink","value","linkTarget","userId","ResizableAvatar","blockProps","isSelected","borderProps","doubledSizedSrc","src","s","width","height","event","direction","elt","delta","parseInt","top","right","bottom","left","alt","className","style","CommentEdit","context","commentId","preventDefault","UserEdit","postId","postType","Edit","props"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tInspectorControls,\n\tuseBlockProps,\n\t__experimentalUseBorderProps as useBorderProps,\n} from '@wordpress/block-editor';\nimport {\n\tPanelBody,\n\tRangeControl,\n\tResizableBox,\n\tToggleControl,\n} from '@wordpress/components';\nimport { __, isRTL } from '@wordpress/i18n';\nimport { addQueryArgs, removeQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport { useUserAvatar, useCommentAvatar } from './hooks';\nimport UserControl from './user-control';\n\nconst AvatarInspectorControls = ( {\n\tsetAttributes,\n\tavatar,\n\tattributes,\n\tselectUser,\n} ) => (\n\t<InspectorControls>\n\t\t<PanelBody title={ __( 'Settings' ) }>\n\t\t\t<RangeControl\n\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\tlabel={ __( 'Image size' ) }\n\t\t\t\tonChange={ ( newSize ) =>\n\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\tsize: newSize,\n\t\t\t\t\t} )\n\t\t\t\t}\n\t\t\t\tmin={ avatar.minSize }\n\t\t\t\tmax={ avatar.maxSize }\n\t\t\t\tinitialPosition={ attributes?.size }\n\t\t\t\tvalue={ attributes?.size }\n\t\t\t/>\n\t\t\t<ToggleControl\n\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\tlabel={ __( 'Link to user profile' ) }\n\t\t\t\tonChange={ () =>\n\t\t\t\t\tsetAttributes( { isLink: ! attributes.isLink } )\n\t\t\t\t}\n\t\t\t\tchecked={ attributes.isLink }\n\t\t\t/>\n\t\t\t{ attributes.isLink && (\n\t\t\t\t<ToggleControl\n\t\t\t\t\tlabel={ __( 'Open in new tab' ) }\n\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\tlinkTarget: value ? '_blank' : '_self',\n\t\t\t\t\t\t} )\n\t\t\t\t\t}\n\t\t\t\t\tchecked={ attributes.linkTarget === '_blank' }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ selectUser && (\n\t\t\t\t<UserControl\n\t\t\t\t\tvalue={ attributes?.userId }\n\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\tuserId: value,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</PanelBody>\n\t</InspectorControls>\n);\n\nconst ResizableAvatar = ( {\n\tsetAttributes,\n\tattributes,\n\tavatar,\n\tblockProps,\n\tisSelected,\n} ) => {\n\tconst borderProps = useBorderProps( attributes );\n\tconst doubledSizedSrc = addQueryArgs(\n\t\tremoveQueryArgs( avatar?.src, [ 's' ] ),\n\t\t{\n\t\t\ts: attributes?.size * 2,\n\t\t}\n\t);\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<ResizableBox\n\t\t\t\tsize={ {\n\t\t\t\t\twidth: attributes.size,\n\t\t\t\t\theight: attributes.size,\n\t\t\t\t} }\n\t\t\t\tshowHandle={ isSelected }\n\t\t\t\tonResizeStop={ ( event, direction, elt, delta ) => {\n\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\tsize: parseInt(\n\t\t\t\t\t\t\tattributes.size + ( delta.height || delta.width ),\n\t\t\t\t\t\t\t10\n\t\t\t\t\t\t),\n\t\t\t\t\t} );\n\t\t\t\t} }\n\t\t\t\tlockAspectRatio\n\t\t\t\tenable={ {\n\t\t\t\t\ttop: false,\n\t\t\t\t\tright: ! isRTL(),\n\t\t\t\t\tbottom: true,\n\t\t\t\t\tleft: isRTL(),\n\t\t\t\t} }\n\t\t\t\tminWidth={ avatar.minSize }\n\t\t\t\tmaxWidth={ avatar.maxSize }\n\t\t\t>\n\t\t\t\t<img\n\t\t\t\t\tsrc={ doubledSizedSrc }\n\t\t\t\t\talt={ avatar.alt }\n\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t'avatar',\n\t\t\t\t\t\t'avatar-' + attributes.size,\n\t\t\t\t\t\t'photo',\n\t\t\t\t\t\t'wp-block-avatar__image',\n\t\t\t\t\t\tborderProps.className\n\t\t\t\t\t) }\n\t\t\t\t\tstyle={ borderProps.style }\n\t\t\t\t/>\n\t\t\t</ResizableBox>\n\t\t</div>\n\t);\n};\nconst CommentEdit = ( { attributes, context, setAttributes, isSelected } ) => {\n\tconst { commentId } = context;\n\tconst blockProps = useBlockProps();\n\tconst avatar = useCommentAvatar( { commentId } );\n\treturn (\n\t\t<>\n\t\t\t<AvatarInspectorControls\n\t\t\t\tavatar={ avatar }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\tattributes={ attributes }\n\t\t\t\tselectUser={ false }\n\t\t\t/>\n\t\t\t{ attributes.isLink ? (\n\t\t\t\t<a\n\t\t\t\t\thref=\"#avatar-pseudo-link\"\n\t\t\t\t\tclassName=\"wp-block-avatar__link\"\n\t\t\t\t\tonClick={ ( event ) => event.preventDefault() }\n\t\t\t\t>\n\t\t\t\t\t<ResizableAvatar\n\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\tavatar={ avatar }\n\t\t\t\t\t\tblockProps={ blockProps }\n\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t/>\n\t\t\t\t</a>\n\t\t\t) : (\n\t\t\t\t<ResizableAvatar\n\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\tavatar={ avatar }\n\t\t\t\t\tblockProps={ blockProps }\n\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n};\n\nconst UserEdit = ( { attributes, context, setAttributes, isSelected } ) => {\n\tconst { postId, postType } = context;\n\tconst avatar = useUserAvatar( {\n\t\tuserId: attributes?.userId,\n\t\tpostId,\n\t\tpostType,\n\t} );\n\tconst blockProps = useBlockProps();\n\treturn (\n\t\t<>\n\t\t\t<AvatarInspectorControls\n\t\t\t\tselectUser={ true }\n\t\t\t\tattributes={ attributes }\n\t\t\t\tavatar={ avatar }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t/>\n\t\t\t<div>\n\t\t\t\t{ attributes.isLink ? (\n\t\t\t\t\t<a\n\t\t\t\t\t\thref=\"#avatar-pseudo-link\"\n\t\t\t\t\t\tclassName=\"wp-block-avatar__link\"\n\t\t\t\t\t\tonClick={ ( event ) => event.preventDefault() }\n\t\t\t\t\t>\n\t\t\t\t\t\t<ResizableAvatar\n\t\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\t\tavatar={ avatar }\n\t\t\t\t\t\t\tblockProps={ blockProps }\n\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</a>\n\t\t\t\t) : (\n\t\t\t\t\t<ResizableAvatar\n\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\tavatar={ avatar }\n\t\t\t\t\t\tblockProps={ blockProps }\n\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default function Edit( props ) {\n\t// Don't show the Comment Edit controls if we have a comment ID set, or if we're in the Site Editor (where it is `null`).\n\tif ( props?.context?.commentId || props?.context?.commentId === null ) {\n\t\treturn <CommentEdit { ...props } />;\n\t}\n\treturn <UserEdit { ...props } />;\n}\n"]}