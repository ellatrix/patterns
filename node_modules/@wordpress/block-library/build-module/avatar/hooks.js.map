{"version":3,"sources":["@wordpress/block-library/src/avatar/hooks.js"],"names":["store","blockEditorStore","coreStore","useEntityProp","__","sprintf","useSelect","getAvatarSizes","sizes","minSize","maxSize","length","maxSizeBuffer","Math","floor","useDefaultAvatar","avatarURL","defaultAvatarUrl","select","getSettings","__experimentalDiscussionSettings","useCommentAvatar","commentId","avatars","authorName","avatarUrls","Object","values","keys","defaultAvatar","src","alt","useUserAvatar","userId","postId","postType","authorDetails","getEditedEntityRecord","getUser","_authorId","author","avatar_urls","name"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { store as coreStore, useEntityProp } from '@wordpress/core-data';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\n\nfunction getAvatarSizes( sizes ) {\n\tconst minSize = sizes ? sizes[ 0 ] : 24;\n\tconst maxSize = sizes ? sizes[ sizes.length - 1 ] : 96;\n\tconst maxSizeBuffer = Math.floor( maxSize * 2.5 );\n\treturn {\n\t\tminSize,\n\t\tmaxSize: maxSizeBuffer,\n\t};\n}\n\nfunction useDefaultAvatar() {\n\tconst { avatarURL: defaultAvatarUrl } = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst { __experimentalDiscussionSettings } = getSettings();\n\t\treturn __experimentalDiscussionSettings;\n\t} );\n\treturn defaultAvatarUrl;\n}\n\nexport function useCommentAvatar( { commentId } ) {\n\tconst [ avatars ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_avatar_urls',\n\t\tcommentId\n\t);\n\n\tconst [ authorName ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_name',\n\t\tcommentId\n\t);\n\tconst avatarUrls = avatars ? Object.values( avatars ) : null;\n\tconst sizes = avatars ? Object.keys( avatars ) : null;\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\n\tconst defaultAvatar = useDefaultAvatar();\n\treturn {\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\n\t\tminSize,\n\t\tmaxSize,\n\t\t// translators: %s is the Author name.\n\t\talt: authorName\n\t\t\t? // translators: %s is the Author name.\n\t\t\t  sprintf( __( '%s Avatar' ), authorName )\n\t\t\t: __( 'Default Avatar' ),\n\t};\n}\n\nexport function useUserAvatar( { userId, postId, postType } ) {\n\tconst { authorDetails } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEditedEntityRecord, getUser } = select( coreStore );\n\t\t\tif ( userId ) {\n\t\t\t\treturn {\n\t\t\t\t\tauthorDetails: getUser( userId ),\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst _authorId = getEditedEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\tpostType,\n\t\t\t\tpostId\n\t\t\t)?.author;\n\n\t\t\treturn {\n\t\t\t\tauthorDetails: _authorId ? getUser( _authorId ) : null,\n\t\t\t};\n\t\t},\n\t\t[ postType, postId, userId ]\n\t);\n\tconst avatarUrls = authorDetails?.avatar_urls\n\t\t? Object.values( authorDetails.avatar_urls )\n\t\t: null;\n\tconst sizes = authorDetails?.avatar_urls\n\t\t? Object.keys( authorDetails.avatar_urls )\n\t\t: null;\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\n\tconst defaultAvatar = useDefaultAvatar();\n\treturn {\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\n\t\tminSize,\n\t\tmaxSize,\n\t\talt: authorDetails\n\t\t\t? // translators: %s is the Author name.\n\t\t\t  sprintf( __( '%s Avatar' ), authorDetails?.name )\n\t\t\t: __( 'Default Avatar' ),\n\t};\n}\n"]}