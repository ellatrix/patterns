{"version":3,"sources":["@wordpress/block-library/src/list-item/hooks/use-enter.native.js"],"names":["createBlock","getDefaultBlockName","cloneBlock","useRef","useSelect","useDispatch","store","blockEditorStore","useOutdentListItem","useEnter","props","preventDefault","replaceBlocks","selectionChange","getBlock","getBlockRootClientId","getBlockIndex","propsRef","current","canOutdent","outdentListItem","clientId","onEnter","content","length","topParentListBlock","blockIndex","head","innerBlocks","slice","middle","after","tail"],"mappings":"AAAA;AACA;AACA;AACA,SACCA,WADD,EAECC,mBAFD,EAGCC,UAHD,QAIO,mBAJP;AAKA,SAASC,MAAT,QAAuB,oBAAvB;AACA,SAASC,SAAT,EAAoBC,WAApB,QAAuC,iBAAvC;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,yBAA1C;AAEA;AACA;AACA;;AACA,OAAOC,kBAAP,MAA+B,yBAA/B;AAEA,eAAe,SAASC,QAAT,CAAmBC,KAAnB,EAA0BC,cAA1B,EAA2C;AACzD,QAAM;AAAEC,IAAAA,aAAF;AAAiBC,IAAAA;AAAjB,MAAqCR,WAAW,CAAEE,gBAAF,CAAtD;AACA,QAAM;AAAEO,IAAAA,QAAF;AAAYC,IAAAA,oBAAZ;AAAkCC,IAAAA;AAAlC,MACLZ,SAAS,CAAEG,gBAAF,CADV;AAEA,QAAMU,QAAQ,GAAGd,MAAM,CAAEO,KAAF,CAAvB;AACAO,EAAAA,QAAQ,CAACC,OAAT,GAAmBR,KAAnB;AACA,QAAM,CAAES,UAAF,EAAcC,eAAd,IAAkCZ,kBAAkB,CACzDS,QAAQ,CAACC,OAAT,CAAiBG,QADwC,CAA1D;AAIA,SAAO;AACNC,IAAAA,OAAO,GAAG;AAAA;;AACT,YAAM;AAAEC,QAAAA,OAAF;AAAWF,QAAAA;AAAX,UAAwBJ,QAAQ,CAACC,OAAvC;;AACA,UAAKK,OAAO,CAACC,MAAb,EAAsB;AACrB;AACA;;AACDb,MAAAA,cAAc,CAACO,OAAf,GAAyB,IAAzB;;AACA,UAAKC,UAAL,EAAkB;AACjBC,QAAAA,eAAe;AACf;AACA,OATQ,CAUT;;;AACA,YAAMK,kBAAkB,GAAGX,QAAQ,CAClCC,oBAAoB,CAAEM,QAAF,CADc,CAAnC;AAGA,YAAMK,UAAU,GAAGV,aAAa,CAAEK,QAAF,CAAhC;AACA,YAAMM,IAAI,GAAGzB,UAAU,CAAE,EACxB,GAAGuB,kBADqB;AAExBG,QAAAA,WAAW,EAAEH,kBAAkB,CAACG,WAAnB,CAA+BC,KAA/B,CACZ,CADY,EAEZH,UAFY;AAFW,OAAF,CAAvB;AAOA,YAAMI,MAAM,GAAG9B,WAAW,CAAEC,mBAAmB,EAArB,CAA1B,CAtBS,CAuBT;AACA;;AACA,YAAM8B,KAAK,GAAG,CACb,IAAK,0BAAAN,kBAAkB,CAACG,WAAnB,CAAgCF,UAAhC,EACHE,WADG,CACU,CADV,iFACeA,WADf,KAC8B,EADnC,CADa,EAGb,GAAGH,kBAAkB,CAACG,WAAnB,CAA+BC,KAA/B,CAAsCH,UAAU,GAAG,CAAnD,CAHU,CAAd;AAKA,YAAMM,IAAI,GAAGD,KAAK,CAACP,MAAN,GACV,CACAtB,UAAU,CAAE,EACX,GAAGuB,kBADQ;AAEXG,QAAAA,WAAW,EAAEG;AAFF,OAAF,CADV,CADU,GAOV,EAPH;AAQAnB,MAAAA,aAAa,CACZa,kBAAkB,CAACJ,QADP,EAEZ,CAAEM,IAAF,EAAQG,MAAR,EAAgB,GAAGE,IAAnB,CAFY,EAGZ,CAHY,CAAb,CAtCS,CA2CT;AACA;;AACAnB,MAAAA,eAAe,CAAEiB,MAAM,CAACT,QAAT,CAAf;AACA;;AA/CK,GAAP;AAiDA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tcreateBlock,\n\tgetDefaultBlockName,\n\tcloneBlock,\n} from '@wordpress/blocks';\nimport { useRef } from '@wordpress/element';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\n\n/**\n * Internal dependencies\n */\nimport useOutdentListItem from './use-outdent-list-item';\n\nexport default function useEnter( props, preventDefault ) {\n\tconst { replaceBlocks, selectionChange } = useDispatch( blockEditorStore );\n\tconst { getBlock, getBlockRootClientId, getBlockIndex } =\n\t\tuseSelect( blockEditorStore );\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\tconst [ canOutdent, outdentListItem ] = useOutdentListItem(\n\t\tpropsRef.current.clientId\n\t);\n\n\treturn {\n\t\tonEnter() {\n\t\t\tconst { content, clientId } = propsRef.current;\n\t\t\tif ( content.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpreventDefault.current = true;\n\t\t\tif ( canOutdent ) {\n\t\t\t\toutdentListItem();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Here we are in top level list so we need to split.\n\t\t\tconst topParentListBlock = getBlock(\n\t\t\t\tgetBlockRootClientId( clientId )\n\t\t\t);\n\t\t\tconst blockIndex = getBlockIndex( clientId );\n\t\t\tconst head = cloneBlock( {\n\t\t\t\t...topParentListBlock,\n\t\t\t\tinnerBlocks: topParentListBlock.innerBlocks.slice(\n\t\t\t\t\t0,\n\t\t\t\t\tblockIndex\n\t\t\t\t),\n\t\t\t} );\n\t\t\tconst middle = createBlock( getDefaultBlockName() );\n\t\t\t// Last list item might contain a `list` block innerBlock\n\t\t\t// In that case append remaining innerBlocks blocks.\n\t\t\tconst after = [\n\t\t\t\t...( topParentListBlock.innerBlocks[ blockIndex ]\n\t\t\t\t\t.innerBlocks[ 0 ]?.innerBlocks || [] ),\n\t\t\t\t...topParentListBlock.innerBlocks.slice( blockIndex + 1 ),\n\t\t\t];\n\t\t\tconst tail = after.length\n\t\t\t\t? [\n\t\t\t\t\t\tcloneBlock( {\n\t\t\t\t\t\t\t...topParentListBlock,\n\t\t\t\t\t\t\tinnerBlocks: after,\n\t\t\t\t\t\t} ),\n\t\t\t\t  ]\n\t\t\t\t: [];\n\t\t\treplaceBlocks(\n\t\t\t\ttopParentListBlock.clientId,\n\t\t\t\t[ head, middle, ...tail ],\n\t\t\t\t1\n\t\t\t);\n\t\t\t// We manually change the selection here because we are replacing\n\t\t\t// a different block than the selected one.\n\t\t\tselectionChange( middle.clientId );\n\t\t},\n\t};\n}\n"]}