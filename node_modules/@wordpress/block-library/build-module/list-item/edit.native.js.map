{"version":3,"sources":["@wordpress/block-library/src/list-item/edit.native.js"],"names":["View","RichText","useBlockProps","useInnerBlocksProps","BlockControls","store","blockEditorStore","__","usePreferredColorSchemeStyle","useSelect","useState","useCallback","useRef","useSplit","useMerge","useEnter","convertToListItems","IndentUI","styles","ListStyleType","OPACITY","ListItemEdit","attributes","setAttributes","onReplace","clientId","style","mergeBlocks","contentWidth","setContentWidth","placeholder","content","blockIndex","hasInnerBlocks","indentationLevel","numberOfListItems","ordered","reversed","start","select","getBlockAttributes","getBlockCount","getBlockIndex","getBlockParentsByBlockName","getBlockRootClientId","currentIdentationLevel","length","currentBlockIndex","blockWithInnerBlocks","rootClientId","blockAttributes","totalListItems","isOrdered","isReversed","startValue","blockProps","innerBlocksProps","allowedBlocks","useCompactList","defaultPlaceholderFromScheme","currentTextColor","color","baseColors","text","defaultPlaceholderTextColor","defaultPlaceholderTextColorWithOpacity","styleWithPlaceholderOpacity","placeholderColor","preventDefault","onEnter","onSplit","onMerge","onSplitList","value","current","onReplaceList","blocks","args","onLayout","nativeEvent","prevState","width","layout","Math","floor","nextContent"],"mappings":";;AAAA;AACA;AACA;AACA,SAASA,IAAT,QAAqB,cAArB;AAEA;AACA;AACA;;AACA,SACCC,QADD,EAECC,aAFD,EAGCC,mBAHD,EAICC,aAJD,EAKCC,KAAK,IAAIC,gBALV,QAMO,yBANP;AAOA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,4BAAT,QAA6C,oBAA7C;AACA,SAASC,SAAT,QAA0B,iBAA1B;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,MAAhC,QAA8C,oBAA9C;AAEA;AACA;AACA;;AACA,SAASC,QAAT,EAAmBC,QAAnB,EAA6BC,QAA7B,QAA6C,SAA7C;AACA,SAASC,kBAAT,QAAmC,SAAnC;AACA,SAASC,QAAT,QAAyB,WAAzB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAOC,aAAP,MAA0B,mBAA1B;AAEA,MAAMC,OAAO,GAAG,IAAhB;AAEA,eAAe,SAASC,YAAT,OAOX;AAAA;;AAAA,MAPkC;AACrCC,IAAAA,UADqC;AAErCC,IAAAA,aAFqC;AAGrCC,IAAAA,SAHqC;AAIrCC,IAAAA,QAJqC;AAKrCC,IAAAA,KALqC;AAMrCC,IAAAA;AANqC,GAOlC;AACH,QAAM,CAAEC,YAAF,EAAgBC,eAAhB,IAAoCnB,QAAQ,EAAlD;AACA,QAAM;AAAEoB,IAAAA,WAAF;AAAeC,IAAAA;AAAf,MAA2BT,UAAjC;AACA,QAAM;AACLU,IAAAA,UADK;AAELC,IAAAA,cAFK;AAGLC,IAAAA,gBAHK;AAILC,IAAAA,iBAJK;AAKLC,IAAAA,OALK;AAMLC,IAAAA,QANK;AAOLC,IAAAA;AAPK,MAQF7B,SAAS,CACV8B,MAAF,IAAc;AACb,UAAM;AACLC,MAAAA,kBADK;AAELC,MAAAA,aAFK;AAGLC,MAAAA,aAHK;AAILC,MAAAA,0BAJK;AAKLC,MAAAA;AALK,QAMFL,MAAM,CAAEjC,gBAAF,CANV;AAOA,UAAMuC,sBAAsB,GAAGF,0BAA0B,CACxDlB,QADwD,EAExD,gBAFwD,EAGxD,IAHwD,CAA1B,CAI7BqB,MAJF;AAKA,UAAMC,iBAAiB,GAAGL,aAAa,CAAEjB,QAAF,CAAvC;AACA,UAAMuB,oBAAoB,GAAGP,aAAa,CAAEhB,QAAF,CAAb,GAA4B,CAAzD;AACA,UAAMwB,YAAY,GAAGL,oBAAoB,CAAEnB,QAAF,CAAzC;AACA,UAAMyB,eAAe,GAAGV,kBAAkB,CAAES,YAAF,CAA1C;AACA,UAAME,cAAc,GAAGV,aAAa,CAAEQ,YAAF,CAApC;AACA,UAAM;AACLb,MAAAA,OAAO,EAAEgB,SADJ;AAELf,MAAAA,QAAQ,EAAEgB,UAFL;AAGLf,MAAAA,KAAK,EAAEgB;AAHF,QAIFJ,eAAe,IAAI,EAJvB;AAMA,WAAO;AACNlB,MAAAA,UAAU,EAAEe,iBADN;AAENd,MAAAA,cAAc,EAAEe,oBAFV;AAGNd,MAAAA,gBAAgB,EAAEW,sBAHZ;AAINV,MAAAA,iBAAiB,EAAEgB,cAJb;AAKNf,MAAAA,OAAO,EAAEgB,SALH;AAMNf,MAAAA,QAAQ,EAAEgB,UANJ;AAONf,MAAAA,KAAK,EAAEgB;AAPD,KAAP;AASA,GAlCW,EAmCZ,CAAE7B,QAAF,CAnCY,CARb;AA8CA,QAAM8B,UAAU,GAAGrD,aAAa,CAAE,EACjC,IAAK+B,cAAc,IAAIf,MAAM,CAAE,mCAAF,CAA7B;AADiC,GAAF,CAAhC;AAIA,QAAMsC,gBAAgB,GAAGrD,mBAAmB,CAAEoD,UAAF,EAAc;AACzDE,IAAAA,aAAa,EAAE,CAAE,WAAF,CAD0C;AAEzDC,IAAAA,cAAc,EAAE;AAFyC,GAAd,CAA5C,CArDG,CA0DH;;AACA,QAAMC,4BAA4B,GAAGnD,4BAA4B,CAChEU,MAAM,CAAE,2CAAF,CAD0D,EAEhEA,MAAM,CAAE,iDAAF,CAF0D,CAAjE;AAKA,QAAM0C,gBAAgB,GAAG,CAAAlC,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEmC,KAAP,MAAgBnC,KAAhB,aAAgBA,KAAhB,4CAAgBA,KAAK,CAAEoC,UAAvB,+EAAgB,kBAAmBD,KAAnC,0DAAgB,sBAA0BE,IAA1C,CAAzB;AAEA,QAAMC,2BAA2B,GAAGJ,gBAAgB,GACjDA,gBADiD,GAEjDD,4BAFiD,aAEjDA,4BAFiD,uBAEjDA,4BAA4B,CAAEE,KAFjC,CAlEG,CAsEH;;AACA,QAAMI,sCAAsC,GAC3CD,2BAA2B,GAAG5C,OAD/B;AAGA,QAAM8C,2BAA2B,GAAG,EACnC,GAAGxC,KADgC;AAEnC,QAAK,CAAAA,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEmC,KAAP,KAAgB;AACpBM,MAAAA,gBAAgB,EAAEzC,KAAK,CAACmC,KAAN,GAAczC;AADZ,KAArB;AAFmC,GAApC;AAOA,QAAMgD,cAAc,GAAGxD,MAAM,CAAE,KAAF,CAA7B;AACA,QAAM;AAAEyD,IAAAA;AAAF,MAActD,QAAQ,CAAE;AAAEgB,IAAAA,OAAF;AAAWN,IAAAA;AAAX,GAAF,EAAyB2C,cAAzB,CAA5B;AACA,QAAME,OAAO,GAAGzD,QAAQ,CAAEY,QAAF,CAAxB;AACA,QAAM8C,OAAO,GAAGzD,QAAQ,CAAEW,QAAF,EAAYE,WAAZ,CAAxB;AACA,QAAM6C,WAAW,GAAG7D,WAAW,CAC5B8D,KAAF,IAAa;AACZ,QAAK,CAAEL,cAAc,CAACM,OAAtB,EAAgC;AAC/B,aAAOJ,OAAO,CAAEG,KAAF,CAAd;AACA;AACD,GAL6B,EAM9B,CAAEhD,QAAF,EAAY6C,OAAZ,CAN8B,CAA/B;AAQA,QAAMK,aAAa,GAAGhE,WAAW,CAChC,UAAEiE,MAAF,EAAuB;AACtB,QAAK,CAAER,cAAc,CAACM,OAAtB,EAAgC;AAAA,wCADpBG,IACoB;AADpBA,QAAAA,IACoB;AAAA;;AAC/BrD,MAAAA,SAAS,CAAER,kBAAkB,CAAE4D,MAAF,CAApB,EAAgC,GAAGC,IAAnC,CAAT;AACA;AACD,GAL+B,EAMhC,CAAEpD,QAAF,EAAYD,SAAZ,EAAuBR,kBAAvB,CANgC,CAAjC;AAQA,QAAM8D,QAAQ,GAAGnE,WAAW,CAAE,SAAuB;AAAA,QAArB;AAAEoE,MAAAA;AAAF,KAAqB;AACpDlD,IAAAA,eAAe,CAAImD,SAAF,IAAiB;AACjC,YAAM;AAAEC,QAAAA;AAAF,UAAYF,WAAW,CAACG,MAA9B;;AAEA,UAAK,CAAEF,SAAF,IAAeA,SAAS,CAACC,KAAV,KAAoBA,KAAxC,EAAgD;AAC/C,eAAOE,IAAI,CAACC,KAAL,CAAYH,KAAZ,CAAP;AACA;;AACD,aAAOD,SAAP;AACA,KAPc,CAAf;AAQA,GAT2B,EASzB,EATyB,CAA5B;AAWA,SACC,cAAC,IAAD;AAAM,IAAA,KAAK,EAAG9D,MAAM,CAAE,sCAAF;AAApB,KACC,cAAC,IAAD;AAAM,IAAA,KAAK,EAAGA,MAAM,CAAE,+BAAF;AAApB,KACC,cAAC,IAAD;AAAM,IAAA,KAAK,EAAGA,MAAM,CAAE,oCAAF;AAApB,KACC,cAAC,aAAD;AACC,IAAA,UAAU,EAAGc,UADd;AAEC,IAAA,gBAAgB,EAAGE,gBAFpB;AAGC,IAAA,iBAAiB,EAAGC,iBAHrB;AAIC,IAAA,OAAO,EAAGC,OAJX;AAKC,IAAA,QAAQ,EAAGC,QALZ;AAMC,IAAA,KAAK,EAAGC,KANT;AAOC,IAAA,KAAK,EAAGZ;AAPT,IADD,CADD,EAYC,cAAC,IAAD;AACC,IAAA,KAAK,EAAGR,MAAM,CAAE,uCAAF,CADf;AAEC,IAAA,QAAQ,EAAG4D;AAFZ,KAIC,cAAC,QAAD;AACC,IAAA,UAAU,EAAC,SADZ;AAEC,IAAA,OAAO,EAAC,GAFT;AAGC,IAAA,QAAQ,EAAKO,WAAF,IACV9D,aAAa,CAAE;AAAEQ,MAAAA,OAAO,EAAEsD;AAAX,KAAF,CAJf;AAMC,IAAA,KAAK,EAAGtD,OANT;AAOC,IAAA,WAAW,EAAGD,WAAW,IAAIvB,EAAE,CAAE,MAAF,CAPhC;AAQC,IAAA,oBAAoB,EACnB0D,sCATF;AAWC,IAAA,OAAO,EAAGO,WAXX;AAYC,IAAA,OAAO,EAAGD,OAZX;AAaC,IAAA,SAAS,EAAGI,aAbb;AAcC,IAAA,OAAO,EAAGN,OAdX;AAeC,IAAA,KAAK,EAAGH,2BAfT;AAgBC,IAAA,WAAW,EAAG,IAhBf;AAiBC,IAAA,cAAc,EAAGtC;AAjBlB,IAJD,CAZD,CADD,EAsCC,cAAC,IAAD,EAAW4B,gBAAX,CAtCD,EAuCC,cAAC,aAAD;AAAe,IAAA,KAAK,EAAC;AAArB,KACC,cAAC,QAAD;AAAU,IAAA,QAAQ,EAAG/B;AAArB,IADD,CAvCD,CADD;AA6CA","sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tRichText,\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\tBlockControls,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { __ } from '@wordpress/i18n';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\nimport { useSelect } from '@wordpress/data';\nimport { useState, useCallback, useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { useSplit, useMerge, useEnter } from './hooks';\nimport { convertToListItems } from './utils';\nimport { IndentUI } from './edit.js';\nimport styles from './style.scss';\nimport ListStyleType from './list-style-type';\n\nconst OPACITY = '9e';\n\nexport default function ListItemEdit( {\n\tattributes,\n\tsetAttributes,\n\tonReplace,\n\tclientId,\n\tstyle,\n\tmergeBlocks,\n} ) {\n\tconst [ contentWidth, setContentWidth ] = useState();\n\tconst { placeholder, content } = attributes;\n\tconst {\n\t\tblockIndex,\n\t\thasInnerBlocks,\n\t\tindentationLevel,\n\t\tnumberOfListItems,\n\t\tordered,\n\t\treversed,\n\t\tstart,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockAttributes,\n\t\t\t\tgetBlockCount,\n\t\t\t\tgetBlockIndex,\n\t\t\t\tgetBlockParentsByBlockName,\n\t\t\t\tgetBlockRootClientId,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst currentIdentationLevel = getBlockParentsByBlockName(\n\t\t\t\tclientId,\n\t\t\t\t'core/list-item',\n\t\t\t\ttrue\n\t\t\t).length;\n\t\t\tconst currentBlockIndex = getBlockIndex( clientId );\n\t\t\tconst blockWithInnerBlocks = getBlockCount( clientId ) > 0;\n\t\t\tconst rootClientId = getBlockRootClientId( clientId );\n\t\t\tconst blockAttributes = getBlockAttributes( rootClientId );\n\t\t\tconst totalListItems = getBlockCount( rootClientId );\n\t\t\tconst {\n\t\t\t\tordered: isOrdered,\n\t\t\t\treversed: isReversed,\n\t\t\t\tstart: startValue,\n\t\t\t} = blockAttributes || {};\n\n\t\t\treturn {\n\t\t\t\tblockIndex: currentBlockIndex,\n\t\t\t\thasInnerBlocks: blockWithInnerBlocks,\n\t\t\t\tindentationLevel: currentIdentationLevel,\n\t\t\t\tnumberOfListItems: totalListItems,\n\t\t\t\tordered: isOrdered,\n\t\t\t\treversed: isReversed,\n\t\t\t\tstart: startValue,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst blockProps = useBlockProps( {\n\t\t...( hasInnerBlocks && styles[ 'wp-block-list-item__nested-blocks' ] ),\n\t} );\n\n\tconst innerBlocksProps = useInnerBlocksProps( blockProps, {\n\t\tallowedBlocks: [ 'core/list' ],\n\t\tuseCompactList: true,\n\t} );\n\n\t// Set default placeholder text color from light/dark scheme or base colors\n\tconst defaultPlaceholderFromScheme = usePreferredColorSchemeStyle(\n\t\tstyles[ 'wp-block-list-item__list-item-placeholder' ],\n\t\tstyles[ 'wp-block-list-item__list-item-placeholder--dark' ]\n\t);\n\n\tconst currentTextColor = style?.color || style?.baseColors?.color?.text;\n\n\tconst defaultPlaceholderTextColor = currentTextColor\n\t\t? currentTextColor\n\t\t: defaultPlaceholderFromScheme?.color;\n\n\t// Add hex opacity to default placeholder text color and style object\n\tconst defaultPlaceholderTextColorWithOpacity =\n\t\tdefaultPlaceholderTextColor + OPACITY;\n\n\tconst styleWithPlaceholderOpacity = {\n\t\t...style,\n\t\t...( style?.color && {\n\t\t\tplaceholderColor: style.color + OPACITY,\n\t\t} ),\n\t};\n\n\tconst preventDefault = useRef( false );\n\tconst { onEnter } = useEnter( { content, clientId }, preventDefault );\n\tconst onSplit = useSplit( clientId );\n\tconst onMerge = useMerge( clientId, mergeBlocks );\n\tconst onSplitList = useCallback(\n\t\t( value ) => {\n\t\t\tif ( ! preventDefault.current ) {\n\t\t\t\treturn onSplit( value );\n\t\t\t}\n\t\t},\n\t\t[ clientId, onSplit ]\n\t);\n\tconst onReplaceList = useCallback(\n\t\t( blocks, ...args ) => {\n\t\t\tif ( ! preventDefault.current ) {\n\t\t\t\tonReplace( convertToListItems( blocks ), ...args );\n\t\t\t}\n\t\t},\n\t\t[ clientId, onReplace, convertToListItems ]\n\t);\n\tconst onLayout = useCallback( ( { nativeEvent } ) => {\n\t\tsetContentWidth( ( prevState ) => {\n\t\t\tconst { width } = nativeEvent.layout;\n\n\t\t\tif ( ! prevState || prevState.width !== width ) {\n\t\t\t\treturn Math.floor( width );\n\t\t\t}\n\t\t\treturn prevState;\n\t\t} );\n\t}, [] );\n\n\treturn (\n\t\t<View style={ styles[ 'wp-block-list-item__list-item-parent' ] }>\n\t\t\t<View style={ styles[ 'wp-block-list-item__list-item' ] }>\n\t\t\t\t<View style={ styles[ 'wp-block-list-item__list-item-icon' ] }>\n\t\t\t\t\t<ListStyleType\n\t\t\t\t\t\tblockIndex={ blockIndex }\n\t\t\t\t\t\tindentationLevel={ indentationLevel }\n\t\t\t\t\t\tnumberOfListItems={ numberOfListItems }\n\t\t\t\t\t\tordered={ ordered }\n\t\t\t\t\t\treversed={ reversed }\n\t\t\t\t\t\tstart={ start }\n\t\t\t\t\t\tstyle={ style }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t\t<View\n\t\t\t\t\tstyle={ styles[ 'wp-block-list-item__list-item-content' ] }\n\t\t\t\t\tonLayout={ onLayout }\n\t\t\t\t>\n\t\t\t\t\t<RichText\n\t\t\t\t\t\tidentifier=\"content\"\n\t\t\t\t\t\ttagName=\"p\"\n\t\t\t\t\t\tonChange={ ( nextContent ) =>\n\t\t\t\t\t\t\tsetAttributes( { content: nextContent } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue={ content }\n\t\t\t\t\t\tplaceholder={ placeholder || __( 'List' ) }\n\t\t\t\t\t\tplaceholderTextColor={\n\t\t\t\t\t\t\tdefaultPlaceholderTextColorWithOpacity\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonSplit={ onSplitList }\n\t\t\t\t\t\tonMerge={ onMerge }\n\t\t\t\t\t\tonReplace={ onReplaceList }\n\t\t\t\t\t\tonEnter={ onEnter }\n\t\t\t\t\t\tstyle={ styleWithPlaceholderOpacity }\n\t\t\t\t\t\tdeleteEnter={ true }\n\t\t\t\t\t\tcontainerWidth={ contentWidth }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</View>\n\t\t\t<View { ...innerBlocksProps }></View>\n\t\t\t<BlockControls group=\"block\">\n\t\t\t\t<IndentUI clientId={ clientId } />\n\t\t\t</BlockControls>\n\t\t</View>\n\t);\n}\n"]}