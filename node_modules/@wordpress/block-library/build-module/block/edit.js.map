{"version":3,"sources":["@wordpress/block-library/src/block/edit.js"],"names":["useDispatch","useSelect","useEntityBlockEditor","useEntityProp","useEntityRecord","Placeholder","Spinner","ToolbarGroup","ToolbarButton","TextControl","PanelBody","__","useInnerBlocksProps","__experimentalRecursionProvider","RecursionProvider","__experimentalUseHasRecursion","useHasRecursion","InnerBlocks","BlockControls","InspectorControls","useBlockProps","Warning","store","blockEditorStore","reusableBlocksStore","ungroup","ReusableBlockEdit","attributes","ref","clientId","hasAlreadyRendered","record","hasResolved","isMissing","canRemove","innerBlockCount","select","canRemoveBlock","getBlockCount","__experimentalConvertBlockToStatic","convertBlockToStatic","blocks","onInput","onChange","id","title","setTitle","blockProps","className","innerBlocksProps","value","renderAppender","length","undefined","ButtonBlockAppender"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport {\n\tuseEntityBlockEditor,\n\tuseEntityProp,\n\tuseEntityRecord,\n} from '@wordpress/core-data';\nimport {\n\tPlaceholder,\n\tSpinner,\n\tToolbarGroup,\n\tToolbarButton,\n\tTextControl,\n\tPanelBody,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tuseInnerBlocksProps,\n\t__experimentalRecursionProvider as RecursionProvider,\n\t__experimentalUseHasRecursion as useHasRecursion,\n\tInnerBlocks,\n\tBlockControls,\n\tInspectorControls,\n\tuseBlockProps,\n\tWarning,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { store as reusableBlocksStore } from '@wordpress/reusable-blocks';\nimport { ungroup } from '@wordpress/icons';\n\nexport default function ReusableBlockEdit( { attributes: { ref }, clientId } ) {\n\tconst hasAlreadyRendered = useHasRecursion( ref );\n\tconst { record, hasResolved } = useEntityRecord(\n\t\t'postType',\n\t\t'wp_block',\n\t\tref\n\t);\n\tconst isMissing = hasResolved && ! record;\n\n\tconst { canRemove, innerBlockCount } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { canRemoveBlock, getBlockCount } =\n\t\t\t\tselect( blockEditorStore );\n\t\t\treturn {\n\t\t\t\tcanRemove: canRemoveBlock( clientId ),\n\t\t\t\tinnerBlockCount: getBlockCount( clientId ),\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst { __experimentalConvertBlockToStatic: convertBlockToStatic } =\n\t\tuseDispatch( reusableBlocksStore );\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\t'wp_block',\n\t\t{ id: ref }\n\t);\n\tconst [ title, setTitle ] = useEntityProp(\n\t\t'postType',\n\t\t'wp_block',\n\t\t'title',\n\t\tref\n\t);\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: 'block-library-block__reusable-block-container',\n\t} );\n\n\tconst innerBlocksProps = useInnerBlocksProps( blockProps, {\n\t\tvalue: blocks,\n\t\tonInput,\n\t\tonChange,\n\t\trenderAppender: blocks?.length\n\t\t\t? undefined\n\t\t\t: InnerBlocks.ButtonBlockAppender,\n\t} );\n\n\tif ( hasAlreadyRendered ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Block cannot be rendered inside itself.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( isMissing ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Block has been deleted or is unavailable.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( ! hasResolved ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder>\n\t\t\t\t\t<Spinner />\n\t\t\t\t</Placeholder>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<RecursionProvider uniqueId={ ref }>\n\t\t\t{ canRemove && (\n\t\t\t\t<BlockControls>\n\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\tonClick={ () => convertBlockToStatic( clientId ) }\n\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\tinnerBlockCount > 1\n\t\t\t\t\t\t\t\t\t? __( 'Convert to regular blocks' )\n\t\t\t\t\t\t\t\t\t: __( 'Convert to regular block' )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticon={ ungroup }\n\t\t\t\t\t\t\tshowTooltip\n\t\t\t\t\t\t/>\n\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={ __( 'Name' ) }\n\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\tonChange={ setTitle }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<div { ...innerBlocksProps } />\n\t\t</RecursionProvider>\n\t);\n}\n"]}