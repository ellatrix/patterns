{"version":3,"sources":["@wordpress/block-library/src/video/edit.native.js"],"names":["View","TouchableWithoutFeedback","Text","Component","mediaUploadSync","requestImageFailedRetryDialog","requestImageUploadCancelDialog","Icon","ToolbarButton","ToolbarGroup","PanelBody","withPreferredColorScheme","compose","BlockCaption","MediaPlaceholder","MediaUpload","MediaUploadProgress","MEDIA_TYPE_VIDEO","BlockControls","VIDEO_ASPECT_RATIO","VideoPlayer","InspectorControls","store","blockEditorStore","__","sprintf","isURL","getProtocol","doAction","hasAction","video","SvgIcon","replace","withDispatch","withSelect","noticesStore","createUpgradedEmbedBlock","style","SvgIconRetry","VideoCommonSettings","ICON_TYPE","PLACEHOLDER","RETRY","UPLOAD","VideoEdit","constructor","props","state","isCaptionSelected","videoContainerHeight","mediaUploadStateReset","bind","onSelectMediaUploadOption","onSelectURL","finishMediaUploadWithSuccess","finishMediaUploadWithFailure","updateMediaProgress","onVideoPressed","onVideoContanerLayout","onFocusCaption","componentDidMount","attributes","id","src","componentWillUnmount","isUploadInProgress","getDerivedStateFromProps","isSelected","setState","payload","setAttributes","mediaUrl","url","mediaServerId","mediaId","createErrorNotice","onReplace","embedBlock","undefined","event","width","nativeEvent","layout","height","getIcon","iconType","iconStyle","icon","getStylesFromColorScheme","iconDark","iconUploading","iconUploadingDark","render","wasBlockJustInserted","toolbarEditButton","open","getMediaOptions","flex","onFocus","isUploadFailed","retryMessage","showVideo","styleIconContainer","modalIconRetry","modalIcon","iconContainer","videoStyle","containerStyle","containerFocused","container","videoContainer","uri","placeholderContainer","placeholderContainerDark","uploadFailedText","caption","clientId","onBlur","insertBlocksAfter","select","dispatch"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,IAAT,EAAeC,wBAAf,EAAyCC,IAAzC,QAAqD,cAArD;AAEA;AACA;AACA;;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SACCC,eADD,EAECC,6BAFD,EAGCC,8BAHD,QAIO,gCAJP;AAKA,SACCC,IADD,EAECC,aAFD,EAGCC,YAHD,EAICC,SAJD,QAKO,uBALP;AAMA,SAASC,wBAAT,EAAmCC,OAAnC,QAAkD,oBAAlD;AACA,SACCC,YADD,EAECC,gBAFD,EAGCC,WAHD,EAICC,mBAJD,EAKCC,gBALD,EAMCC,aAND,EAOCC,kBAPD,EAQCC,WARD,EASCC,iBATD,EAUCC,KAAK,IAAIC,gBAVV,QAWO,yBAXP;AAYA,SAASC,EAAT,EAAaC,OAAb,QAA4B,iBAA5B;AACA,SAASC,KAAT,EAAgBC,WAAhB,QAAmC,gBAAnC;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,kBAApC;AACA,SAASC,KAAK,IAAIC,OAAlB,EAA2BC,OAA3B,QAA0C,kBAA1C;AACA,SAASC,YAAT,EAAuBC,UAAvB,QAAyC,iBAAzC;AACA,SAASZ,KAAK,IAAIa,YAAlB,QAAsC,oBAAtC;AAEA;AACA;AACA;;AACA,SAASC,wBAAT,QAAyC,eAAzC;AACA,OAAOC,KAAP,MAAkB,cAAlB;AACA,OAAOC,YAAP,MAAyB,cAAzB;AACA,OAAOC,mBAAP,MAAgC,wBAAhC;AAEA,MAAMC,SAAS,GAAG;AACjBC,EAAAA,WAAW,EAAE,aADI;AAEjBC,EAAAA,KAAK,EAAE,OAFU;AAGjBC,EAAAA,MAAM,EAAE;AAHS,CAAlB;;AAMA,MAAMC,SAAN,SAAwBzC,SAAxB,CAAkC;AACjC0C,EAAAA,WAAW,CAAEC,KAAF,EAAU;AACpB,UAAOA,KAAP;AAEA,SAAKC,KAAL,GAAa;AACZC,MAAAA,iBAAiB,EAAE,KADP;AAEZC,MAAAA,oBAAoB,EAAE;AAFV,KAAb;AAKA,SAAKC,qBAAL,GAA6B,KAAKA,qBAAL,CAA2BC,IAA3B,CAAiC,IAAjC,CAA7B;AACA,SAAKC,yBAAL,GACC,KAAKA,yBAAL,CAA+BD,IAA/B,CAAqC,IAArC,CADD;AAEA,SAAKE,WAAL,GAAmB,KAAKA,WAAL,CAAiBF,IAAjB,CAAuB,IAAvB,CAAnB;AACA,SAAKG,4BAAL,GACC,KAAKA,4BAAL,CAAkCH,IAAlC,CAAwC,IAAxC,CADD;AAEA,SAAKI,4BAAL,GACC,KAAKA,4BAAL,CAAkCJ,IAAlC,CAAwC,IAAxC,CADD;AAEA,SAAKK,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBL,IAAzB,CAA+B,IAA/B,CAA3B;AACA,SAAKM,cAAL,GAAsB,KAAKA,cAAL,CAAoBN,IAApB,CAA0B,IAA1B,CAAtB;AACA,SAAKO,qBAAL,GAA6B,KAAKA,qBAAL,CAA2BP,IAA3B,CAAiC,IAAjC,CAA7B;AACA,SAAKQ,cAAL,GAAsB,KAAKA,cAAL,CAAoBR,IAApB,CAA0B,IAA1B,CAAtB;AACA;;AAEDS,EAAAA,iBAAiB,GAAG;AACnB,UAAM;AAAEC,MAAAA;AAAF,QAAiB,KAAKf,KAA5B;;AACA,QAAKe,UAAU,CAACC,EAAX,IAAiBnC,WAAW,CAAEkC,UAAU,CAACE,GAAb,CAAX,KAAkC,OAAxD,EAAkE;AACjE3D,MAAAA,eAAe;AACf;AACD;;AAED4D,EAAAA,oBAAoB,GAAG;AACtB;AACA,QACCnC,SAAS,CAAE,iCAAF,CAAT,IACA,KAAKkB,KAAL,CAAWkB,kBAFZ,EAGE;AACDrC,MAAAA,QAAQ,CACP,iCADO,EAEP,KAAKkB,KAAL,CAAWe,UAAX,CAAsBC,EAFf,CAAR;AAIA;AACD;;AAE8B,SAAxBI,wBAAwB,CAAEpB,KAAF,EAASC,KAAT,EAAiB;AAC/C;AACA;AACA,WAAO;AACNC,MAAAA,iBAAiB,EAAEF,KAAK,CAACqB,UAAN,IAAoBpB,KAAK,CAACC;AADvC,KAAP;AAGA;;AAEDS,EAAAA,cAAc,GAAG;AAChB,UAAM;AAAEI,MAAAA;AAAF,QAAiB,KAAKf,KAA5B;;AAEA,QAAK,KAAKC,KAAL,CAAWkB,kBAAhB,EAAqC;AACpC3D,MAAAA,8BAA8B,CAAEuD,UAAU,CAACC,EAAb,CAA9B;AACA,KAFD,MAEO,IACND,UAAU,CAACC,EAAX,IACAnC,WAAW,CAAEkC,UAAU,CAACE,GAAb,CAAX,KAAkC,OAF5B,EAGL;AACD1D,MAAAA,6BAA6B,CAAEwD,UAAU,CAACC,EAAb,CAA7B;AACA;;AAED,SAAKM,QAAL,CAAe;AACdpB,MAAAA,iBAAiB,EAAE;AADL,KAAf;AAGA;;AAEDW,EAAAA,cAAc,GAAG;AAChB,QAAK,CAAE,KAAKZ,KAAL,CAAWC,iBAAlB,EAAsC;AACrC,WAAKoB,QAAL,CAAe;AAAEpB,QAAAA,iBAAiB,EAAE;AAArB,OAAf;AACA;AACD;;AAEDQ,EAAAA,mBAAmB,CAAEa,OAAF,EAAY;AAC9B,UAAM;AAAEC,MAAAA;AAAF,QAAoB,KAAKxB,KAA/B;;AACA,QAAKuB,OAAO,CAACE,QAAb,EAAwB;AACvBD,MAAAA,aAAa,CAAE;AAAEE,QAAAA,GAAG,EAAEH,OAAO,CAACE;AAAf,OAAF,CAAb;AACA;;AACD,QAAK,CAAE,KAAKxB,KAAL,CAAWkB,kBAAlB,EAAuC;AACtC,WAAKG,QAAL,CAAe;AAAEH,QAAAA,kBAAkB,EAAE;AAAtB,OAAf;AACA;AACD;;AAEDX,EAAAA,4BAA4B,CAAEe,OAAF,EAAY;AACvC,UAAM;AAAEC,MAAAA;AAAF,QAAoB,KAAKxB,KAA/B;AACAwB,IAAAA,aAAa,CAAE;AAAEP,MAAAA,GAAG,EAAEM,OAAO,CAACE,QAAf;AAAyBT,MAAAA,EAAE,EAAEO,OAAO,CAACI;AAArC,KAAF,CAAb;AACA,SAAKL,QAAL,CAAe;AAAEH,MAAAA,kBAAkB,EAAE;AAAtB,KAAf;AACA;;AAEDV,EAAAA,4BAA4B,CAAEc,OAAF,EAAY;AACvC,UAAM;AAAEC,MAAAA;AAAF,QAAoB,KAAKxB,KAA/B;AACAwB,IAAAA,aAAa,CAAE;AAAER,MAAAA,EAAE,EAAEO,OAAO,CAACK;AAAd,KAAF,CAAb;AACA,SAAKN,QAAL,CAAe;AAAEH,MAAAA,kBAAkB,EAAE;AAAtB,KAAf;AACA;;AAEDf,EAAAA,qBAAqB,GAAG;AACvB,UAAM;AAAEoB,MAAAA;AAAF,QAAoB,KAAKxB,KAA/B;AACAwB,IAAAA,aAAa,CAAE;AAAER,MAAAA,EAAE,EAAE,IAAN;AAAYC,MAAAA,GAAG,EAAE;AAAjB,KAAF,CAAb;AACA,SAAKK,QAAL,CAAe;AAAEH,MAAAA,kBAAkB,EAAE;AAAtB,KAAf;AACA;;AAEDb,EAAAA,yBAAyB,OAAgB;AAAA,QAAd;AAAEU,MAAAA,EAAF;AAAMU,MAAAA;AAAN,KAAc;AACxC,UAAM;AAAEF,MAAAA;AAAF,QAAoB,KAAKxB,KAA/B;AACAwB,IAAAA,aAAa,CAAE;AAAER,MAAAA,EAAF;AAAMC,MAAAA,GAAG,EAAES;AAAX,KAAF,CAAb;AACA;;AAEDnB,EAAAA,WAAW,CAAEmB,GAAF,EAAQ;AAClB,UAAM;AAAEG,MAAAA,iBAAF;AAAqBC,MAAAA,SAArB;AAAgCN,MAAAA;AAAhC,QAAkD,KAAKxB,KAA7D;;AAEA,QAAKpB,KAAK,CAAE8C,GAAF,CAAV,EAAoB;AACnB;AACA,YAAMK,UAAU,GAAGzC,wBAAwB,CAAE;AAC5CyB,QAAAA,UAAU,EAAE;AAAEW,UAAAA;AAAF;AADgC,OAAF,CAA3C;;AAGA,UAAKM,SAAS,KAAKD,UAAnB,EAAgC;AAC/BD,QAAAA,SAAS,CAAEC,UAAF,CAAT;AACA;AACA;;AAEDP,MAAAA,aAAa,CAAE;AAAER,QAAAA,EAAE,EAAEU,GAAN;AAAWT,QAAAA,GAAG,EAAES;AAAhB,OAAF,CAAb;AACA,KAXD,MAWO;AACNG,MAAAA,iBAAiB,CAAEnD,EAAE,CAAE,cAAF,CAAJ,CAAjB;AACA;AACD;;AAEDkC,EAAAA,qBAAqB,CAAEqB,KAAF,EAAU;AAC9B,UAAM;AAAEC,MAAAA;AAAF,QAAYD,KAAK,CAACE,WAAN,CAAkBC,MAApC;AACA,UAAMC,MAAM,GAAGH,KAAK,GAAG7D,kBAAvB;;AACA,QAAKgE,MAAM,KAAK,KAAKpC,KAAL,CAAWE,oBAA3B,EAAkD;AACjD,WAAKmB,QAAL,CAAe;AAAEnB,QAAAA,oBAAoB,EAAEkC;AAAxB,OAAf;AACA;AACD;;AAEDC,EAAAA,OAAO,CAAEC,QAAF,EAAa;AACnB,QAAIC,SAAJ;;AACA,YAASD,QAAT;AACC,WAAK7C,SAAS,CAACE,KAAf;AACC,eAAO,cAAC,IAAD;AAAM,UAAA,IAAI,EAAGJ;AAAb,WAAiCD,KAAK,CAACkD,IAAvC,EAAP;;AACD,WAAK/C,SAAS,CAACC,WAAf;AACC6C,QAAAA,SAAS,GAAG,KAAKxC,KAAL,CAAW0C,wBAAX,CACXnD,KAAK,CAACkD,IADK,EAEXlD,KAAK,CAACoD,QAFK,CAAZ;AAIA;;AACD,WAAKjD,SAAS,CAACG,MAAf;AACC2C,QAAAA,SAAS,GAAG,KAAKxC,KAAL,CAAW0C,wBAAX,CACXnD,KAAK,CAACqD,aADK,EAEXrD,KAAK,CAACsD,iBAFK,CAAZ;AAIA;AAdF;;AAiBA,WAAO,cAAC,IAAD;AAAM,MAAA,IAAI,EAAG5D;AAAb,OAA4BuD,SAA5B,EAAP;AACA;;AAEDM,EAAAA,MAAM,GAAG;AACR,UAAM;AAAEtB,MAAAA,aAAF;AAAiBT,MAAAA,UAAjB;AAA6BM,MAAAA,UAA7B;AAAyC0B,MAAAA;AAAzC,QACL,KAAK/C,KADN;AAEA,UAAM;AAAEgB,MAAAA,EAAF;AAAMC,MAAAA;AAAN,QAAcF,UAApB;AACA,UAAM;AAAEZ,MAAAA;AAAF,QAA2B,KAAKF,KAAtC;AAEA,UAAM+C,iBAAiB,GACtB,cAAC,WAAD;AACC,MAAA,YAAY,EAAG,CAAE7E,gBAAF,CADhB;AAEC,MAAA,gBAAgB,EAAG,IAFpB;AAGC,MAAA,QAAQ,EAAG,KAAKmC,yBAHjB;AAIC,MAAA,WAAW,EAAG,KAAKC,WAJpB;AAKC,MAAA,MAAM,EAAG,SAAiC;AAAA,YAA/B;AAAE0C,UAAAA,IAAF;AAAQC,UAAAA;AAAR,SAA+B;AACzC,eACC,cAAC,YAAD,QACGA,eAAe,EADlB,EAEC,cAAC,aAAD;AACC,UAAA,KAAK,EAAGxE,EAAE,CAAE,YAAF,CADX;AAEC,UAAA,IAAI,EAAGQ,OAFR;AAGC,UAAA,OAAO,EAAG+D;AAHX,UAFD,CADD;AAUA;AAhBF,MADD;;AAqBA,QAAK,CAAEjC,EAAP,EAAY;AACX,aACC,cAAC,IAAD;AAAM,QAAA,KAAK,EAAG;AAAEmC,UAAAA,IAAI,EAAE;AAAR;AAAd,SACC,cAAC,gBAAD;AACC,QAAA,YAAY,EAAG,CAAEhF,gBAAF,CADhB;AAEC,QAAA,QAAQ,EAAG,KAAKmC,yBAFjB;AAGC,QAAA,WAAW,EAAG,KAAKC,WAHpB;AAIC,QAAA,IAAI,EAAG,KAAK+B,OAAL,CAAc5C,SAAS,CAACC,WAAxB,CAJR;AAKC,QAAA,OAAO,EAAG,KAAKK,KAAL,CAAWoD,OALtB;AAMC,QAAA,mBAAmB,EAClB/B,UAAU,IAAI0B;AAPhB,QADD,CADD;AAcA;;AAED,WACC,cAAC,wBAAD;AACC,MAAA,UAAU,EAAG,CAAE1B,UADhB;AAEC,MAAA,OAAO,EAAG,KAAKV,cAFhB;AAGC,MAAA,QAAQ,EAAG,CAAEU;AAHd,OAKC,cAAC,IAAD;AAAM,MAAA,KAAK,EAAG;AAAE8B,QAAAA,IAAI,EAAE;AAAR;AAAd,OACG,CAAE,KAAKlD,KAAL,CAAWC,iBAAb,IACD,cAAC,aAAD,QAAiB8C,iBAAjB,CAFF,EAIG3B,UAAU,IACX,cAAC,iBAAD,QACC,cAAC,SAAD;AAAW,MAAA,KAAK,EAAG3C,EAAE,CAAE,UAAF;AAArB,OACC,cAAC,mBAAD;AACC,MAAA,aAAa,EAAG8C,aADjB;AAEC,MAAA,UAAU,EAAGT;AAFd,MADD,CADD,CALF,EAcC,cAAC,mBAAD;AACC,MAAA,OAAO,EAAGC,EADX;AAEC,MAAA,8BAA8B,EAC7B,KAAKR,4BAHP;AAKC,MAAA,8BAA8B,EAC7B,KAAKC,4BANP;AAQC,MAAA,qBAAqB,EAAG,KAAKC,mBAR9B;AASC,MAAA,uBAAuB,EAAG,KAAKN,qBAThC;AAUC,MAAA,aAAa,EAAG,SAIT;AAAA,YAJW;AACjBe,UAAAA,kBADiB;AAEjBkC,UAAAA,cAFiB;AAGjBC,UAAAA;AAHiB,SAIX;AACN,cAAMC,SAAS,GACd3E,KAAK,CAAEqC,GAAF,CAAL,IACA,CAAEE,kBADF,IAEA,CAAEkC,cAHH;AAIA,cAAMZ,IAAI,GAAG,KAAKH,OAAL,CACZe,cAAc,GACX3D,SAAS,CAACE,KADC,GAEXF,SAAS,CAACG,MAHD,CAAb;AAKA,cAAM2D,kBAAkB,GAAGH,cAAc,GACtC9D,KAAK,CAACkE,cADgC,GAEtClE,KAAK,CAACmE,SAFT;AAIA,cAAMC,aAAa,GAClB,cAAC,IAAD;AAAM,UAAA,KAAK,EAAGH;AAAd,WACGf,IADH,CADD;AAMA,cAAMmB,UAAU,GAAG;AAClBvB,UAAAA,MAAM,EAAElC,oBADU;AAElB,aAAGZ,KAAK,CAACP;AAFS,SAAnB;AAKA,cAAM6E,cAAc,GACnBN,SAAS,IAAIlC,UAAb,GACG9B,KAAK,CAACuE,gBADT,GAEGvE,KAAK,CAACwE,SAHV;AAKA,eACC,cAAC,IAAD;AACC,UAAA,QAAQ,EAAG,KAAKnD,qBADjB;AAEC,UAAA,KAAK,EAAGiD;AAFT,WAIGN,SAAS,IACV,cAAC,IAAD;AAAM,UAAA,KAAK,EAAGhE,KAAK,CAACyE;AAApB,WACC,cAAC,WAAD;AACC,UAAA,UAAU,EACT3C,UAAU,IACV,CAAE,KAAKpB,KAAL,CACAC,iBAJJ;AAMC,UAAA,KAAK,EAAG0D,UANT;AAOC,UAAA,MAAM,EAAG;AAAEK,YAAAA,GAAG,EAAEhD;AAAP,WAPV;AAQC,UAAA,MAAM,EAAG;AARV,UADD,CALF,EAkBG,CAAEsC,SAAF,IACD,cAAC,IAAD;AACC,UAAA,KAAK,EAAG;AACPlB,YAAAA,MAAM,EAAElC,oBADD;AAEP+B,YAAAA,KAAK,EAAE,MAFA;AAGP,eAAG,KAAKlC,KAAL,CAAW0C,wBAAX,CACFnD,KAAK,CAAC2E,oBADJ,EAEF3E,KAAK,CAAC4E,wBAFJ;AAHI;AADT,WAUGhE,oBAAoB,GAAG,CAAvB,IACDwD,aAXF,EAYGN,cAAc,IACf,cAAC,IAAD;AACC,UAAA,KAAK,EACJ9D,KAAK,CAAC6E;AAFR,WAKGd,YALH,CAbF,CAnBF,CADD;AA6CA;AAzFF,MAdD,EAyGC,cAAC,YAAD;AACC,MAAA,UAAU,EAAG,IADd;AAEC,MAAA,yBAAyB,EAAKe,OAAF,IAC3B,CAAEA,OAAF;AACG;AACA3F,MAAAA,EAAE,CAAE,sBAAF,CAFL,GAGGC,OAAO;AACP;AACAD,MAAAA,EAAE,CAAE,mBAAF,CAFK,EAGP2F,OAHO,CANZ;AAYC,MAAA,QAAQ,EAAG,KAAKrE,KAAL,CAAWsE,QAZvB;AAaC,MAAA,UAAU,EAAG,KAAKrE,KAAL,CAAWC,iBAbzB;AAcC,MAAA,OAAO,EAAG,KAAKW,cAdhB;AAeC,MAAA,MAAM,EAAG,KAAKb,KAAL,CAAWuE,MAfrB,CAe8B;AAf9B;AAgBC,MAAA,iBAAiB,EAAG,KAAKvE,KAAL,CAAWwE;AAhBhC,MAzGD,CALD,CADD;AAoIA;;AA5UgC;;AA+UlC,eAAe1G,OAAO,CAAE,CACvBsB,UAAU,CAAE,CAAEqF,MAAF;AAAA,MAAU;AAAEH,IAAAA;AAAF,GAAV;AAAA,SAA8B;AACzCvB,IAAAA,oBAAoB,EAAE0B,MAAM,CAAEhG,gBAAF,CAAN,CAA2BsE,oBAA3B,CACrBuB,QADqB,EAErB,eAFqB;AADmB,GAA9B;AAAA,CAAF,CADa,EAOvBnF,YAAY,CAAIuF,QAAF,IAAgB;AAC7B,QAAM;AAAE7C,IAAAA;AAAF,MAAwB6C,QAAQ,CAAErF,YAAF,CAAtC;AAEA,SAAO;AAAEwC,IAAAA;AAAF,GAAP;AACA,CAJW,CAPW,EAYvBhE,wBAZuB,CAAF,CAAP,CAaViC,SAbU,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { View, TouchableWithoutFeedback, Text } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport {\n\tmediaUploadSync,\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n} from '@wordpress/react-native-bridge';\nimport {\n\tIcon,\n\tToolbarButton,\n\tToolbarGroup,\n\tPanelBody,\n} from '@wordpress/components';\nimport { withPreferredColorScheme, compose } from '@wordpress/compose';\nimport {\n\tBlockCaption,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tMediaUploadProgress,\n\tMEDIA_TYPE_VIDEO,\n\tBlockControls,\n\tVIDEO_ASPECT_RATIO,\n\tVideoPlayer,\n\tInspectorControls,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { isURL, getProtocol } from '@wordpress/url';\nimport { doAction, hasAction } from '@wordpress/hooks';\nimport { video as SvgIcon, replace } from '@wordpress/icons';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport { createUpgradedEmbedBlock } from '../embed/util';\nimport style from './style.scss';\nimport SvgIconRetry from './icon-retry';\nimport VideoCommonSettings from './edit-common-settings';\n\nconst ICON_TYPE = {\n\tPLACEHOLDER: 'placeholder',\n\tRETRY: 'retry',\n\tUPLOAD: 'upload',\n};\n\nclass VideoEdit extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tisCaptionSelected: false,\n\t\t\tvideoContainerHeight: 0,\n\t\t};\n\n\t\tthis.mediaUploadStateReset = this.mediaUploadStateReset.bind( this );\n\t\tthis.onSelectMediaUploadOption =\n\t\t\tthis.onSelectMediaUploadOption.bind( this );\n\t\tthis.onSelectURL = this.onSelectURL.bind( this );\n\t\tthis.finishMediaUploadWithSuccess =\n\t\t\tthis.finishMediaUploadWithSuccess.bind( this );\n\t\tthis.finishMediaUploadWithFailure =\n\t\t\tthis.finishMediaUploadWithFailure.bind( this );\n\t\tthis.updateMediaProgress = this.updateMediaProgress.bind( this );\n\t\tthis.onVideoPressed = this.onVideoPressed.bind( this );\n\t\tthis.onVideoContanerLayout = this.onVideoContanerLayout.bind( this );\n\t\tthis.onFocusCaption = this.onFocusCaption.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { attributes } = this.props;\n\t\tif ( attributes.id && getProtocol( attributes.src ) === 'file:' ) {\n\t\t\tmediaUploadSync();\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\t// This action will only exist if the user pressed the trash button on the block holder.\n\t\tif (\n\t\t\thasAction( 'blocks.onRemoveBlockCheckUpload' ) &&\n\t\t\tthis.state.isUploadInProgress\n\t\t) {\n\t\t\tdoAction(\n\t\t\t\t'blocks.onRemoveBlockCheckUpload',\n\t\t\t\tthis.props.attributes.id\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\t// Avoid a UI flicker in the toolbar by insuring that isCaptionSelected\n\t\t// is updated immediately any time the isSelected prop becomes false.\n\t\treturn {\n\t\t\tisCaptionSelected: props.isSelected && state.isCaptionSelected,\n\t\t};\n\t}\n\n\tonVideoPressed() {\n\t\tconst { attributes } = this.props;\n\n\t\tif ( this.state.isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( attributes.id );\n\t\t} else if (\n\t\t\tattributes.id &&\n\t\t\tgetProtocol( attributes.src ) === 'file:'\n\t\t) {\n\t\t\trequestImageFailedRetryDialog( attributes.id );\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tisCaptionSelected: false,\n\t\t} );\n\t}\n\n\tonFocusCaption() {\n\t\tif ( ! this.state.isCaptionSelected ) {\n\t\t\tthis.setState( { isCaptionSelected: true } );\n\t\t}\n\t}\n\n\tupdateMediaProgress( payload ) {\n\t\tconst { setAttributes } = this.props;\n\t\tif ( payload.mediaUrl ) {\n\t\t\tsetAttributes( { url: payload.mediaUrl } );\n\t\t}\n\t\tif ( ! this.state.isUploadInProgress ) {\n\t\t\tthis.setState( { isUploadInProgress: true } );\n\t\t}\n\t}\n\n\tfinishMediaUploadWithSuccess( payload ) {\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( { src: payload.mediaUrl, id: payload.mediaServerId } );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tfinishMediaUploadWithFailure( payload ) {\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( { id: payload.mediaId } );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tmediaUploadStateReset() {\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( { id: null, src: null } );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tonSelectMediaUploadOption( { id, url } ) {\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( { id, src: url } );\n\t}\n\n\tonSelectURL( url ) {\n\t\tconst { createErrorNotice, onReplace, setAttributes } = this.props;\n\n\t\tif ( isURL( url ) ) {\n\t\t\t// Check if there's an embed block that handles this URL.\n\t\t\tconst embedBlock = createUpgradedEmbedBlock( {\n\t\t\t\tattributes: { url },\n\t\t\t} );\n\t\t\tif ( undefined !== embedBlock ) {\n\t\t\t\tonReplace( embedBlock );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetAttributes( { id: url, src: url } );\n\t\t} else {\n\t\t\tcreateErrorNotice( __( 'Invalid URL.' ) );\n\t\t}\n\t}\n\n\tonVideoContanerLayout( event ) {\n\t\tconst { width } = event.nativeEvent.layout;\n\t\tconst height = width / VIDEO_ASPECT_RATIO;\n\t\tif ( height !== this.state.videoContainerHeight ) {\n\t\t\tthis.setState( { videoContainerHeight: height } );\n\t\t}\n\t}\n\n\tgetIcon( iconType ) {\n\t\tlet iconStyle;\n\t\tswitch ( iconType ) {\n\t\t\tcase ICON_TYPE.RETRY:\n\t\t\t\treturn <Icon icon={ SvgIconRetry } { ...style.icon } />;\n\t\t\tcase ICON_TYPE.PLACEHOLDER:\n\t\t\t\ticonStyle = this.props.getStylesFromColorScheme(\n\t\t\t\t\tstyle.icon,\n\t\t\t\t\tstyle.iconDark\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase ICON_TYPE.UPLOAD:\n\t\t\t\ticonStyle = this.props.getStylesFromColorScheme(\n\t\t\t\t\tstyle.iconUploading,\n\t\t\t\t\tstyle.iconUploadingDark\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn <Icon icon={ SvgIcon } { ...iconStyle } />;\n\t}\n\n\trender() {\n\t\tconst { setAttributes, attributes, isSelected, wasBlockJustInserted } =\n\t\t\tthis.props;\n\t\tconst { id, src } = attributes;\n\t\tconst { videoContainerHeight } = this.state;\n\n\t\tconst toolbarEditButton = (\n\t\t\t<MediaUpload\n\t\t\t\tallowedTypes={ [ MEDIA_TYPE_VIDEO ] }\n\t\t\t\tisReplacingMedia={ true }\n\t\t\t\tonSelect={ this.onSelectMediaUploadOption }\n\t\t\t\tonSelectURL={ this.onSelectURL }\n\t\t\t\trender={ ( { open, getMediaOptions } ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t\t{ getMediaOptions() }\n\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\tlabel={ __( 'Edit video' ) }\n\t\t\t\t\t\t\t\ticon={ replace }\n\t\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t></MediaUpload>\n\t\t);\n\n\t\tif ( ! id ) {\n\t\t\treturn (\n\t\t\t\t<View style={ { flex: 1 } }>\n\t\t\t\t\t<MediaPlaceholder\n\t\t\t\t\t\tallowedTypes={ [ MEDIA_TYPE_VIDEO ] }\n\t\t\t\t\t\tonSelect={ this.onSelectMediaUploadOption }\n\t\t\t\t\t\tonSelectURL={ this.onSelectURL }\n\t\t\t\t\t\ticon={ this.getIcon( ICON_TYPE.PLACEHOLDER ) }\n\t\t\t\t\t\tonFocus={ this.props.onFocus }\n\t\t\t\t\t\tautoOpenMediaUpload={\n\t\t\t\t\t\t\tisSelected && wasBlockJustInserted\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<TouchableWithoutFeedback\n\t\t\t\taccessible={ ! isSelected }\n\t\t\t\tonPress={ this.onVideoPressed }\n\t\t\t\tdisabled={ ! isSelected }\n\t\t\t>\n\t\t\t\t<View style={ { flex: 1 } }>\n\t\t\t\t\t{ ! this.state.isCaptionSelected && (\n\t\t\t\t\t\t<BlockControls>{ toolbarEditButton }</BlockControls>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isSelected && (\n\t\t\t\t\t\t<InspectorControls>\n\t\t\t\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\n\t\t\t\t\t\t\t\t<VideoCommonSettings\n\t\t\t\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t</InspectorControls>\n\t\t\t\t\t) }\n\t\t\t\t\t<MediaUploadProgress\n\t\t\t\t\t\tmediaId={ id }\n\t\t\t\t\t\tonFinishMediaUploadWithSuccess={\n\t\t\t\t\t\t\tthis.finishMediaUploadWithSuccess\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonFinishMediaUploadWithFailure={\n\t\t\t\t\t\t\tthis.finishMediaUploadWithFailure\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonUpdateMediaProgress={ this.updateMediaProgress }\n\t\t\t\t\t\tonMediaUploadStateReset={ this.mediaUploadStateReset }\n\t\t\t\t\t\trenderContent={ ( {\n\t\t\t\t\t\t\tisUploadInProgress,\n\t\t\t\t\t\t\tisUploadFailed,\n\t\t\t\t\t\t\tretryMessage,\n\t\t\t\t\t\t} ) => {\n\t\t\t\t\t\t\tconst showVideo =\n\t\t\t\t\t\t\t\tisURL( src ) &&\n\t\t\t\t\t\t\t\t! isUploadInProgress &&\n\t\t\t\t\t\t\t\t! isUploadFailed;\n\t\t\t\t\t\t\tconst icon = this.getIcon(\n\t\t\t\t\t\t\t\tisUploadFailed\n\t\t\t\t\t\t\t\t\t? ICON_TYPE.RETRY\n\t\t\t\t\t\t\t\t\t: ICON_TYPE.UPLOAD\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst styleIconContainer = isUploadFailed\n\t\t\t\t\t\t\t\t? style.modalIconRetry\n\t\t\t\t\t\t\t\t: style.modalIcon;\n\n\t\t\t\t\t\t\tconst iconContainer = (\n\t\t\t\t\t\t\t\t<View style={ styleIconContainer }>\n\t\t\t\t\t\t\t\t\t{ icon }\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst videoStyle = {\n\t\t\t\t\t\t\t\theight: videoContainerHeight,\n\t\t\t\t\t\t\t\t...style.video,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tconst containerStyle =\n\t\t\t\t\t\t\t\tshowVideo && isSelected\n\t\t\t\t\t\t\t\t\t? style.containerFocused\n\t\t\t\t\t\t\t\t\t: style.container;\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\t\tonLayout={ this.onVideoContanerLayout }\n\t\t\t\t\t\t\t\t\tstyle={ containerStyle }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ showVideo && (\n\t\t\t\t\t\t\t\t\t\t<View style={ style.videoContainer }>\n\t\t\t\t\t\t\t\t\t\t\t<VideoPlayer\n\t\t\t\t\t\t\t\t\t\t\t\tisSelected={\n\t\t\t\t\t\t\t\t\t\t\t\t\tisSelected &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t! this.state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.isCaptionSelected\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={ videoStyle }\n\t\t\t\t\t\t\t\t\t\t\t\tsource={ { uri: src } }\n\t\t\t\t\t\t\t\t\t\t\t\tpaused={ true }\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t{ ! showVideo && (\n\t\t\t\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\t\t\t\theight: videoContainerHeight,\n\t\t\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\t\t\t...this.props.getStylesFromColorScheme(\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle.placeholderContainer,\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle.placeholderContainerDark\n\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{ videoContainerHeight > 0 &&\n\t\t\t\t\t\t\t\t\t\t\t\ticonContainer }\n\t\t\t\t\t\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Text\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle.uploadFailedText\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ retryMessage }\n\t\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<BlockCaption\n\t\t\t\t\t\taccessible={ true }\n\t\t\t\t\t\taccessibilityLabelCreator={ ( caption ) =>\n\t\t\t\t\t\t\t! caption\n\t\t\t\t\t\t\t\t? /* translators: accessibility text. Empty video caption. */\n\t\t\t\t\t\t\t\t  __( 'Video caption. Empty' )\n\t\t\t\t\t\t\t\t: sprintf(\n\t\t\t\t\t\t\t\t\t\t/* translators: accessibility text. %s: video caption. */\n\t\t\t\t\t\t\t\t\t\t__( 'Video caption. %s' ),\n\t\t\t\t\t\t\t\t\t\tcaption\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclientId={ this.props.clientId }\n\t\t\t\t\t\tisSelected={ this.state.isCaptionSelected }\n\t\t\t\t\t\tonFocus={ this.onFocusCaption }\n\t\t\t\t\t\tonBlur={ this.props.onBlur } // Always assign onBlur as props.\n\t\t\t\t\t\tinsertBlocksAfter={ this.props.insertBlocksAfter }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => ( {\n\t\twasBlockJustInserted: select( blockEditorStore ).wasBlockJustInserted(\n\t\t\tclientId,\n\t\t\t'inserter_menu'\n\t\t),\n\t} ) ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createErrorNotice } = dispatch( noticesStore );\n\n\t\treturn { createErrorNotice };\n\t} ),\n\twithPreferredColorScheme,\n] )( VideoEdit );\n"]}