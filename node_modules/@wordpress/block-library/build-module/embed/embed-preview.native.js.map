{"version":3,"sources":["@wordpress/block-library/src/embed/embed-preview.native.js"],"names":["TouchableWithoutFeedback","classnames","View","BlockCaption","store","blockEditorStore","__","sprintf","memo","useState","SandBox","useSelect","getPhotoHtml","EmbedNoPreview","WpEmbedPreview","styles","EmbedPreview","align","className","clientId","icon","insertBlocksAfter","isSelected","label","onFocus","preview","previewable","isProviderPreviewable","type","url","isDefaultEmbedInfo","isCaptionSelected","setIsCaptionSelected","locale","getSettings","wrapperStyle","wrapperAlignStyle","sandboxAlignStyle","accessibilityLabelCreator","caption","onEmbedPreviewPress","onFocusCaption","provider_url","providerUrl","html","parsedHost","URL","host","split","parsedHostBaseUrl","splice","length","join","iframeTitle","sandboxClassnames","PreviewContent","embedWrapper"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { TouchableWithoutFeedback } from 'react-native';\nimport classnames from 'classnames/dedupe';\n\n/**\n * WordPress dependencies\n */\nimport { View } from '@wordpress/primitives';\nimport {\n\tBlockCaption,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { memo, useState } from '@wordpress/element';\nimport { SandBox } from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { getPhotoHtml } from './util';\nimport EmbedNoPreview from './embed-no-preview';\nimport WpEmbedPreview from './wp-embed-preview';\nimport styles from './styles.scss';\n\nconst EmbedPreview = ( {\n\talign,\n\tclassName,\n\tclientId,\n\ticon,\n\tinsertBlocksAfter,\n\tisSelected,\n\tlabel,\n\tonFocus,\n\tpreview,\n\tpreviewable,\n\tisProviderPreviewable,\n\ttype,\n\turl,\n\tisDefaultEmbedInfo,\n} ) => {\n\tconst [ isCaptionSelected, setIsCaptionSelected ] = useState( false );\n\tconst { locale } = useSelect( blockEditorStore ).getSettings();\n\n\tconst wrapperStyle = styles[ 'embed-preview__wrapper' ];\n\tconst wrapperAlignStyle =\n\t\tstyles[ `embed-preview__wrapper--align-${ align }` ];\n\tconst sandboxAlignStyle =\n\t\tstyles[ `embed-preview__sandbox--align-${ align }` ];\n\n\tfunction accessibilityLabelCreator( caption ) {\n\t\treturn ! caption\n\t\t\t? /* translators: accessibility text. Empty Embed caption. */\n\t\t\t  __( 'Embed caption. Empty' )\n\t\t\t: sprintf(\n\t\t\t\t\t/* translators: accessibility text. %s: Embed caption. */\n\t\t\t\t\t__( 'Embed caption. %s' ),\n\t\t\t\t\tcaption\n\t\t\t  );\n\t}\n\n\tfunction onEmbedPreviewPress() {\n\t\tsetIsCaptionSelected( false );\n\t}\n\n\tfunction onFocusCaption() {\n\t\tif ( onFocus ) {\n\t\t\tonFocus();\n\t\t}\n\t\tif ( ! isCaptionSelected ) {\n\t\t\tsetIsCaptionSelected( true );\n\t\t}\n\t}\n\n\tconst { provider_url: providerUrl } = preview;\n\tconst html = 'photo' === type ? getPhotoHtml( preview ) : preview.html;\n\tconst parsedHost = new URL( url ).host.split( '.' );\n\tconst parsedHostBaseUrl = parsedHost\n\t\t.splice( parsedHost.length - 2, parsedHost.length - 1 )\n\t\t.join( '.' );\n\tconst iframeTitle = sprintf(\n\t\t// translators: %s: host providing embed content e.g: www.youtube.com\n\t\t__( 'Embedded content from %s' ),\n\t\tparsedHostBaseUrl\n\t);\n\tconst sandboxClassnames = classnames(\n\t\ttype,\n\t\tclassName,\n\t\t'wp-block-embed__wrapper'\n\t);\n\n\tconst PreviewContent = 'wp-embed' === type ? WpEmbedPreview : SandBox;\n\tconst embedWrapper = (\n\t\t<>\n\t\t\t<TouchableWithoutFeedback\n\t\t\t\tonPress={ () => {\n\t\t\t\t\tif ( onFocus ) {\n\t\t\t\t\t\tonFocus();\n\t\t\t\t\t}\n\t\t\t\t\tif ( isCaptionSelected ) {\n\t\t\t\t\t\tsetIsCaptionSelected( false );\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t<View\n\t\t\t\t\tpointerEvents=\"box-only\"\n\t\t\t\t\tstyle={ [ wrapperStyle, wrapperAlignStyle ] }\n\t\t\t\t>\n\t\t\t\t\t<PreviewContent\n\t\t\t\t\t\thtml={ html }\n\t\t\t\t\t\tlang={ locale }\n\t\t\t\t\t\ttitle={ iframeTitle }\n\t\t\t\t\t\ttype={ sandboxClassnames }\n\t\t\t\t\t\tproviderUrl={ providerUrl }\n\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\tcontainerStyle={ sandboxAlignStyle }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t</>\n\t);\n\treturn (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isSelected }\n\t\t\tonPress={ onEmbedPreviewPress }\n\t\t\tdisabled={ ! isSelected }\n\t\t>\n\t\t\t<View>\n\t\t\t\t{ isProviderPreviewable && previewable ? (\n\t\t\t\t\tembedWrapper\n\t\t\t\t) : (\n\t\t\t\t\t<EmbedNoPreview\n\t\t\t\t\t\tlabel={ label }\n\t\t\t\t\t\ticon={ icon }\n\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\tonPress={ () => setIsCaptionSelected( false ) }\n\t\t\t\t\t\tpreviewable={ previewable }\n\t\t\t\t\t\tisDefaultEmbedInfo={ isDefaultEmbedInfo }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t<BlockCaption\n\t\t\t\t\taccessibilityLabelCreator={ accessibilityLabelCreator }\n\t\t\t\t\taccessible\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t\t\t\tisSelected={ isCaptionSelected }\n\t\t\t\t\tonFocus={ onFocusCaption }\n\t\t\t\t/>\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n};\n\nexport default memo( EmbedPreview );\n"]}