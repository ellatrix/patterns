{"version":3,"sources":["@wordpress/block-library/src/list/edit.js"],"names":["BlockControls","useBlockProps","useInnerBlocksProps","store","blockEditorStore","ToolbarButton","useDispatch","useSelect","useRegistry","isRTL","__","formatListBullets","formatListBulletsRTL","formatListNumbered","formatListNumberedRTL","formatOutdent","formatOutdentRTL","createBlock","useCallback","useEffect","Platform","deprecated","OrderedListSettings","migrateToListV2","TagName","TEMPLATE","NATIVE_MARGIN_SPACING","useMigrateOnLoad","attributes","clientId","registry","updateBlockAttributes","replaceInnerBlocks","values","newAttributes","newInnerBlocks","since","version","alternative","batch","useOutdentList","canOutdent","innerSelect","getBlockRootClientId","getBlock","parentId","name","replaceBlocks","selectionChange","getBlockAttributes","parentBlockId","parentBlockAttributes","newParentBlock","innerBlocks","length","IndentUI","outdentList","Edit","setAttributes","style","blockProps","isNative","innerBlocksProps","allowedBlocks","template","templateLock","templateInsertUpdatesSelection","marginVertical","marginHorizontal","useCompactList","ordered","type","reversed","start","controls"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { ToolbarButton } from '@wordpress/components';\nimport { useDispatch, useSelect, useRegistry } from '@wordpress/data';\nimport { isRTL, __ } from '@wordpress/i18n';\nimport {\n\tformatListBullets,\n\tformatListBulletsRTL,\n\tformatListNumbered,\n\tformatListNumberedRTL,\n\tformatOutdent,\n\tformatOutdentRTL,\n} from '@wordpress/icons';\nimport { createBlock } from '@wordpress/blocks';\nimport { useCallback, useEffect, Platform } from '@wordpress/element';\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport OrderedListSettings from './ordered-list-settings';\nimport { migrateToListV2 } from './utils';\nimport TagName from './tag-name';\n\nconst TEMPLATE = [ [ 'core/list-item' ] ];\nconst NATIVE_MARGIN_SPACING = 8;\n\n/**\n * At the moment, deprecations don't handle create blocks from attributes\n * (like when using CPT templates). For this reason, this hook is necessary\n * to avoid breaking templates using the old list block format.\n *\n * @param {Object} attributes Block attributes.\n * @param {string} clientId   Block client ID.\n */\nfunction useMigrateOnLoad( attributes, clientId ) {\n\tconst registry = useRegistry();\n\tconst { updateBlockAttributes, replaceInnerBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tuseEffect( () => {\n\t\t// As soon as the block is loaded, migrate it to the new version.\n\n\t\tif ( ! attributes.values ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [ newAttributes, newInnerBlocks ] = migrateToListV2( attributes );\n\n\t\tdeprecated( 'Value attribute on the list block', {\n\t\t\tsince: '6.0',\n\t\t\tversion: '6.5',\n\t\t\talternative: 'inner blocks',\n\t\t} );\n\n\t\tregistry.batch( () => {\n\t\t\tupdateBlockAttributes( clientId, newAttributes );\n\t\t\treplaceInnerBlocks( clientId, newInnerBlocks );\n\t\t} );\n\t}, [ attributes.values ] );\n}\n\nfunction useOutdentList( clientId ) {\n\tconst { canOutdent } = useSelect(\n\t\t( innerSelect ) => {\n\t\t\tconst { getBlockRootClientId, getBlock } =\n\t\t\t\tinnerSelect( blockEditorStore );\n\t\t\tconst parentId = getBlockRootClientId( clientId );\n\t\t\treturn {\n\t\t\t\tcanOutdent:\n\t\t\t\t\t!! parentId &&\n\t\t\t\t\tgetBlock( parentId ).name === 'core/list-item',\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\tconst { replaceBlocks, selectionChange } = useDispatch( blockEditorStore );\n\tconst { getBlockRootClientId, getBlockAttributes, getBlock } =\n\t\tuseSelect( blockEditorStore );\n\n\treturn [\n\t\tcanOutdent,\n\t\tuseCallback( () => {\n\t\t\tconst parentBlockId = getBlockRootClientId( clientId );\n\t\t\tconst parentBlockAttributes = getBlockAttributes( parentBlockId );\n\t\t\t// Create a new parent block without the inner blocks.\n\t\t\tconst newParentBlock = createBlock(\n\t\t\t\t'core/list-item',\n\t\t\t\tparentBlockAttributes\n\t\t\t);\n\t\t\tconst { innerBlocks } = getBlock( clientId );\n\t\t\t// Replace the parent block with a new parent block without inner blocks,\n\t\t\t// and make the inner blocks siblings of the parent.\n\t\t\treplaceBlocks(\n\t\t\t\t[ parentBlockId ],\n\t\t\t\t[ newParentBlock, ...innerBlocks ]\n\t\t\t);\n\t\t\t// Select the last child of the list being outdent.\n\t\t\tselectionChange( innerBlocks[ innerBlocks.length - 1 ].clientId );\n\t\t}, [ clientId ] ),\n\t];\n}\n\nfunction IndentUI( { clientId } ) {\n\tconst [ canOutdent, outdentList ] = useOutdentList( clientId );\n\treturn (\n\t\t<>\n\t\t\t<ToolbarButton\n\t\t\t\ticon={ isRTL() ? formatOutdentRTL : formatOutdent }\n\t\t\t\ttitle={ __( 'Outdent' ) }\n\t\t\t\tdescribedBy={ __( 'Outdent list item' ) }\n\t\t\t\tdisabled={ ! canOutdent }\n\t\t\t\tonClick={ outdentList }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport default function Edit( { attributes, setAttributes, clientId, style } ) {\n\tconst blockProps = useBlockProps( {\n\t\t...( Platform.isNative && { style } ),\n\t} );\n\tconst innerBlocksProps = useInnerBlocksProps( blockProps, {\n\t\tallowedBlocks: [ 'core/list-item' ],\n\t\ttemplate: TEMPLATE,\n\t\ttemplateLock: false,\n\t\ttemplateInsertUpdatesSelection: true,\n\t\t...( Platform.isNative && {\n\t\t\tmarginVertical: NATIVE_MARGIN_SPACING,\n\t\t\tmarginHorizontal: NATIVE_MARGIN_SPACING,\n\t\t\tuseCompactList: true,\n\t\t} ),\n\t} );\n\tuseMigrateOnLoad( attributes, clientId );\n\tconst { ordered, type, reversed, start } = attributes;\n\n\tconst controls = (\n\t\t<BlockControls group=\"block\">\n\t\t\t<ToolbarButton\n\t\t\t\ticon={ isRTL() ? formatListBulletsRTL : formatListBullets }\n\t\t\t\ttitle={ __( 'Unordered' ) }\n\t\t\t\tdescribedBy={ __( 'Convert to unordered list' ) }\n\t\t\t\tisActive={ ordered === false }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tsetAttributes( { ordered: false } );\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<ToolbarButton\n\t\t\t\ticon={ isRTL() ? formatListNumberedRTL : formatListNumbered }\n\t\t\t\ttitle={ __( 'Ordered' ) }\n\t\t\t\tdescribedBy={ __( 'Convert to ordered list' ) }\n\t\t\t\tisActive={ ordered === true }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tsetAttributes( { ordered: true } );\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<IndentUI clientId={ clientId } />\n\t\t</BlockControls>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<TagName\n\t\t\t\tordered={ ordered }\n\t\t\t\treversed={ reversed }\n\t\t\t\tstart={ start }\n\t\t\t\ttype={ type }\n\t\t\t\t{ ...innerBlocksProps }\n\t\t\t/>\n\t\t\t{ controls }\n\t\t\t{ ordered && (\n\t\t\t\t<OrderedListSettings\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\tordered={ ordered }\n\t\t\t\t\treversed={ reversed }\n\t\t\t\t\tstart={ start }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n}\n"]}