{"version":3,"sources":["@wordpress/block-library/src/list/utils.js"],"names":["createBlock","rawHandler","createListBlockFromDOMElement","listElement","listAttributes","ordered","tagName","anchor","id","undefined","start","getAttribute","parseInt","reversed","hasAttribute","type","innerBlocks","Array","from","children","map","listItem","childNodes","filter","node","nodeType","TEXT_NODE","textContent","trim","length","reverse","nestedList","nodes","hasNestedList","content","innerHTML","htmlNodes","outerHTML","childAttributes","join","childInnerBlocks","migrateToListV2","attributes","values","otherAttributes","list","document","createElement","setAttribute","listBlock","HTML"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createBlock, rawHandler } from '@wordpress/blocks';\n\nexport function createListBlockFromDOMElement( listElement ) {\n\tconst listAttributes = {\n\t\tordered: 'OL' === listElement.tagName,\n\t\tanchor: listElement.id === '' ? undefined : listElement.id,\n\t\tstart: listElement.getAttribute( 'start' )\n\t\t\t? parseInt( listElement.getAttribute( 'start' ), 10 )\n\t\t\t: undefined,\n\t\treversed: listElement.hasAttribute( 'reversed' ) ? true : undefined,\n\t\ttype: listElement.getAttribute( 'type' ) ?? undefined,\n\t};\n\n\tconst innerBlocks = Array.from( listElement.children ).map(\n\t\t( listItem ) => {\n\t\t\tconst children = Array.from( listItem.childNodes ).filter(\n\t\t\t\t( node ) =>\n\t\t\t\t\tnode.nodeType !== node.TEXT_NODE ||\n\t\t\t\t\tnode.textContent.trim().length !== 0\n\t\t\t);\n\t\t\tchildren.reverse();\n\t\t\tconst [ nestedList, ...nodes ] = children;\n\n\t\t\tconst hasNestedList =\n\t\t\t\tnestedList?.tagName === 'UL' || nestedList?.tagName === 'OL';\n\t\t\tif ( ! hasNestedList ) {\n\t\t\t\treturn createBlock( 'core/list-item', {\n\t\t\t\t\tcontent: listItem.innerHTML,\n\t\t\t\t} );\n\t\t\t}\n\t\t\tconst htmlNodes = nodes.map( ( node ) => {\n\t\t\t\tif ( node.nodeType === node.TEXT_NODE ) {\n\t\t\t\t\treturn node.textContent;\n\t\t\t\t}\n\t\t\t\treturn node.outerHTML;\n\t\t\t} );\n\t\t\thtmlNodes.reverse();\n\t\t\tconst childAttributes = {\n\t\t\t\tcontent: htmlNodes.join( '' ).trim(),\n\t\t\t};\n\t\t\tconst childInnerBlocks = [\n\t\t\t\tcreateListBlockFromDOMElement( nestedList ),\n\t\t\t];\n\t\t\treturn createBlock(\n\t\t\t\t'core/list-item',\n\t\t\t\tchildAttributes,\n\t\t\t\tchildInnerBlocks\n\t\t\t);\n\t\t}\n\t);\n\n\treturn createBlock( 'core/list', listAttributes, innerBlocks );\n}\n\nexport function migrateToListV2( attributes ) {\n\tconst { values, start, reversed, ordered, type, ...otherAttributes } =\n\t\tattributes;\n\n\tconst list = document.createElement( ordered ? 'ol' : 'ul' );\n\tlist.innerHTML = values;\n\tif ( start ) {\n\t\tlist.setAttribute( 'start', start );\n\t}\n\tif ( reversed ) {\n\t\tlist.setAttribute( 'reversed', true );\n\t}\n\tif ( type ) {\n\t\tlist.setAttribute( 'type', type );\n\t}\n\n\tconst [ listBlock ] = rawHandler( { HTML: list.outerHTML } );\n\n\treturn [\n\t\t{ ...otherAttributes, ...listBlock.attributes },\n\t\tlistBlock.innerBlocks,\n\t];\n}\n"]}