{"version":3,"sources":["@wordpress/block-library/src/cover/edit.native.js"],"names":["View","TouchableWithoutFeedback","InteractionManager","AccessibilityInfo","Platform","Video","classnames","requestImageFailedRetryDialog","requestImageUploadCancelDialog","requestImageFullscreenPreview","mediaUploadSync","__","Icon","Image","ImageEditingButton","IMAGE_DEFAULT_FOCAL_POINT","ToolbarButton","Gradient","ColorPalette","ColorPicker","BottomSheetConsumer","useConvertUnitToMobile","useMobileGlobalStylesColors","BlockControls","InnerBlocks","InspectorControls","MEDIA_TYPE_IMAGE","MediaPlaceholder","MediaUpload","MediaUploadProgress","getColorObjectByColorValue","getColorObjectByAttributeValues","getGradientValueBySlug","store","blockEditorStore","compose","withPreferredColorScheme","useDispatch","withSelect","withDispatch","useEffect","useState","useRef","useCallback","useMemo","cover","icon","replace","image","warning","getProtocol","editPostStore","styles","attributesFromMedia","ALLOWED_MEDIA_TYPES","IMAGE_BACKGROUND_TYPE","VIDEO_BACKGROUND_TYPE","COVER_DEFAULT_HEIGHT","Controls","useCoverIsDark","INNER_BLOCKS_TEMPLATE","align","placeholder","useIsScreenReaderEnabled","isScreenReaderEnabled","setIsScreenReaderEnabled","mounted","changeListener","addEventListener","enabled","then","screenReaderEnabled","remove","Cover","attributes","getStylesFromColorScheme","isParentSelected","onFocus","setAttributes","openGeneralSidebar","closeSettingsBottomSheet","isSelected","selectBlock","blockWidth","hasInnerBlocks","backgroundType","dimRatio","focalPoint","minHeight","url","id","style","customOverlayColor","minHeightUnit","allowedBlocks","templateLock","customGradient","gradient","overlayColor","isDark","convertedMinHeight","isImage","THEME_COLORS_COUNT","colorsDefault","coverDefaultPalette","colors","slice","gradients","gradientValue","overlayColorValue","hasBackground","color","background","hasOnlyColorBackground","isCustomColorPickerShowing","setCustomColorPickerShowing","openMediaOptionsRef","isUploadInProgress","setIsUploadInProgress","didUploadFail","setDidUploadFail","shouldShowFailure","onSelectMedia","media","onSelect","onMediaPressed","isVideoLoading","setIsVideoLoading","onVideoLoadStart","onVideoLoad","onClearMedia","undefined","hasParallax","setColor","colorValue","slug","openColorPicker","__unstableMarkNextChangeAsNotPersistent","isCoverDark","childrenStyles","defaultColor","defaultColorLightMode","className","includes","backgroundColor","backgroundSolid","backgroundSolidDark","overlayStyles","overlay","opacity","overlaySelected","placeholderIconStyle","iconDark","placeholderIcon","toolbarControls","open","accessibilityHint","OS","addMediaButton","current","selectImageContainer","selectImage","selectImageIcon","onBottomSheetClosed","runAfterInteractions","colorPickerControls","shouldEnableBottomSheetScroll","shouldEnableBottomSheetMaxHeight","onHandleClosingBottomSheet","onHandleHardwareButtonPress","isBottomSheetContentScrolling","renderContent","getMediaOptions","renderBackground","mediaServerId","mediaUrl","imageContainer","width","uri","mediaPlaceholderEmptyStateContainer","height","title","colorPaletteWrapper","paletteColorIndicator","paletteCustomIndicatorWrapper","backgroundContainer","content","overlayContainer","imageEditButton","destructiveButton","label","onPress","separated","value","uploadFailedContainer","uploadFailed","uploadFailedIcon","select","clientId","getSelectedBlockClientId","getBlock","selectedBlockClientId","innerBlocks","length","dispatch","closeGeneralSidebar"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tView,\n\tTouchableWithoutFeedback,\n\tInteractionManager,\n\tAccessibilityInfo,\n\tPlatform,\n} from 'react-native';\nimport Video from 'react-native-video';\nimport classnames from 'classnames/dedupe';\n\n/**\n * WordPress dependencies\n */\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n\trequestImageFullscreenPreview,\n\tmediaUploadSync,\n} from '@wordpress/react-native-bridge';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tIcon,\n\tImage,\n\tImageEditingButton,\n\tIMAGE_DEFAULT_FOCAL_POINT,\n\tToolbarButton,\n\tGradient,\n\tColorPalette,\n\tColorPicker,\n\tBottomSheetConsumer,\n\tuseConvertUnitToMobile,\n\tuseMobileGlobalStylesColors,\n} from '@wordpress/components';\nimport {\n\tBlockControls,\n\tInnerBlocks,\n\tInspectorControls,\n\tMEDIA_TYPE_IMAGE,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tMediaUploadProgress,\n\tgetColorObjectByColorValue,\n\tgetColorObjectByAttributeValues,\n\tgetGradientValueBySlug,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { useDispatch, withSelect, withDispatch } from '@wordpress/data';\nimport {\n\tuseEffect,\n\tuseState,\n\tuseRef,\n\tuseCallback,\n\tuseMemo,\n} from '@wordpress/element';\nimport { cover as icon, replace, image, warning } from '@wordpress/icons';\nimport { getProtocol } from '@wordpress/url';\n// eslint-disable-next-line no-restricted-imports\nimport { store as editPostStore } from '@wordpress/edit-post';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport {\n\tattributesFromMedia,\n\tALLOWED_MEDIA_TYPES,\n\tIMAGE_BACKGROUND_TYPE,\n\tVIDEO_BACKGROUND_TYPE,\n\tCOVER_DEFAULT_HEIGHT,\n} from './shared';\nimport Controls from './controls';\nimport useCoverIsDark from './use-cover-is-dark';\n\n/**\n * Constants\n */\nconst INNER_BLOCKS_TEMPLATE = [\n\t[\n\t\t'core/paragraph',\n\t\t{\n\t\t\talign: 'center',\n\t\t\tplaceholder: __( 'Write title…' ),\n\t\t},\n\t],\n];\n\nfunction useIsScreenReaderEnabled() {\n\tconst [ isScreenReaderEnabled, setIsScreenReaderEnabled ] =\n\t\tuseState( false );\n\n\tuseEffect( () => {\n\t\tlet mounted = true;\n\n\t\tconst changeListener = AccessibilityInfo.addEventListener(\n\t\t\t'screenReaderChanged',\n\t\t\t( enabled ) => setIsScreenReaderEnabled( enabled )\n\t\t);\n\n\t\tAccessibilityInfo.isScreenReaderEnabled().then(\n\t\t\t( screenReaderEnabled ) => {\n\t\t\t\tif ( mounted && screenReaderEnabled ) {\n\t\t\t\t\tsetIsScreenReaderEnabled( screenReaderEnabled );\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn () => {\n\t\t\tmounted = false;\n\n\t\t\tchangeListener.remove();\n\t\t};\n\t}, [] );\n\n\treturn isScreenReaderEnabled;\n}\n\nconst Cover = ( {\n\tattributes,\n\tgetStylesFromColorScheme,\n\tisParentSelected,\n\tonFocus,\n\tsetAttributes,\n\topenGeneralSidebar,\n\tcloseSettingsBottomSheet,\n\tisSelected,\n\tselectBlock,\n\tblockWidth,\n\thasInnerBlocks,\n} ) => {\n\tconst {\n\t\tbackgroundType,\n\t\tdimRatio,\n\t\tfocalPoint,\n\t\tminHeight,\n\t\turl,\n\t\tid,\n\t\tstyle,\n\t\tcustomOverlayColor,\n\t\tminHeightUnit = 'px',\n\t\tallowedBlocks,\n\t\ttemplateLock,\n\t\tcustomGradient,\n\t\tgradient,\n\t\toverlayColor,\n\t\tisDark,\n\t} = attributes;\n\tconst isScreenReaderEnabled = useIsScreenReaderEnabled();\n\n\tuseEffect( () => {\n\t\t// Sync with local media store.\n\t\tmediaUploadSync();\n\t}, [] );\n\n\tconst convertedMinHeight = useConvertUnitToMobile(\n\t\tminHeight || COVER_DEFAULT_HEIGHT,\n\t\tminHeightUnit\n\t);\n\n\tconst isImage = backgroundType === MEDIA_TYPE_IMAGE;\n\n\tconst THEME_COLORS_COUNT = 4;\n\tconst colorsDefault = useMobileGlobalStylesColors();\n\tconst coverDefaultPalette = useMemo( () => {\n\t\treturn {\n\t\t\tcolors: colorsDefault.slice( 0, THEME_COLORS_COUNT ),\n\t\t};\n\t}, [ colorsDefault ] );\n\tconst gradients = useMobileGlobalStylesColors( 'gradients' );\n\tconst gradientValue =\n\t\tcustomGradient || getGradientValueBySlug( gradients, gradient );\n\tconst overlayColorValue = getColorObjectByAttributeValues(\n\t\tcolorsDefault,\n\t\toverlayColor\n\t);\n\n\tconst hasBackground = !! (\n\t\turl ||\n\t\t( style && style.color && style.color.background ) ||\n\t\tattributes.overlayColor ||\n\t\toverlayColorValue.color ||\n\t\tcustomOverlayColor ||\n\t\tgradientValue\n\t);\n\n\tconst hasOnlyColorBackground = ! url && ( hasBackground || hasInnerBlocks );\n\n\tconst [ isCustomColorPickerShowing, setCustomColorPickerShowing ] =\n\t\tuseState( false );\n\n\tconst openMediaOptionsRef = useRef();\n\n\t// Initialize uploading flag to false, awaiting sync.\n\tconst [ isUploadInProgress, setIsUploadInProgress ] = useState( false );\n\n\t// Initialize upload failure flag to true if url is local.\n\tconst [ didUploadFail, setDidUploadFail ] = useState(\n\t\tid && getProtocol( url ) === 'file:'\n\t);\n\n\t// Don't show failure if upload is in progress.\n\tconst shouldShowFailure = didUploadFail && ! isUploadInProgress;\n\n\tconst onSelectMedia = ( media ) => {\n\t\tsetDidUploadFail( false );\n\t\tconst onSelect = attributesFromMedia( setAttributes, dimRatio );\n\t\tonSelect( media );\n\t};\n\n\tconst onMediaPressed = () => {\n\t\tif ( isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( id );\n\t\t} else if ( shouldShowFailure ) {\n\t\t\trequestImageFailedRetryDialog( id );\n\t\t} else if ( isImage && url ) {\n\t\t\trequestImageFullscreenPreview( url );\n\t\t}\n\t};\n\n\tconst [ isVideoLoading, setIsVideoLoading ] = useState( true );\n\n\tconst onVideoLoadStart = () => {\n\t\tsetIsVideoLoading( true );\n\t};\n\n\tconst onVideoLoad = () => {\n\t\tsetIsVideoLoading( false );\n\t};\n\n\tconst onClearMedia = useCallback( () => {\n\t\tsetAttributes( {\n\t\t\tfocalPoint: undefined,\n\t\t\thasParallax: undefined,\n\t\t\tid: undefined,\n\t\t\turl: undefined,\n\t\t} );\n\t\tcloseSettingsBottomSheet();\n\t}, [ closeSettingsBottomSheet ] );\n\n\tfunction setColor( color ) {\n\t\tconst colorValue = getColorObjectByColorValue( colorsDefault, color );\n\n\t\tsetAttributes( {\n\t\t\t// Clear all related attributes (only one should be set).\n\t\t\toverlayColor: colorValue?.slug ?? undefined,\n\t\t\tcustomOverlayColor: ( ! colorValue?.slug && color ) ?? undefined,\n\t\t\tgradient: undefined,\n\t\t\tcustomGradient: undefined,\n\t\t} );\n\t}\n\n\tfunction openColorPicker() {\n\t\tselectBlock();\n\t\tsetCustomColorPickerShowing( true );\n\t\topenGeneralSidebar();\n\t}\n\n\tconst { __unstableMarkNextChangeAsNotPersistent } =\n\t\tuseDispatch( blockEditorStore );\n\tconst isCoverDark = useCoverIsDark(\n\t\tisDark,\n\t\turl,\n\t\tdimRatio,\n\t\toverlayColorValue?.color\n\t);\n\n\tuseEffect( () => {\n\t\t// This side-effect should not create an undo level.\n\t\t__unstableMarkNextChangeAsNotPersistent();\n\t\t// Used to set a default color for its InnerBlocks\n\t\t// since there's no system to inherit styles yet\n\t\t// the RichText component will check if there are\n\t\t// parent styles for the current block. If there are,\n\t\t// it will use that color instead.\n\t\tsetAttributes( {\n\t\t\tisDark: isCoverDark,\n\t\t\tchildrenStyles: isCoverDark\n\t\t\t\t? styles.defaultColor\n\t\t\t\t: styles.defaultColorLightMode,\n\t\t} );\n\n\t\t// Ensure that \"is-light\" is removed from \"className\" attribute if cover background is dark.\n\t\tif ( isCoverDark && attributes.className?.includes( 'is-light' ) ) {\n\t\t\tconst className = classnames( attributes.className, {\n\t\t\t\t'is-light': false,\n\t\t\t} );\n\t\t\tsetAttributes( {\n\t\t\t\tclassName: className !== '' ? className : undefined,\n\t\t\t} );\n\t\t}\n\t}, [ isCoverDark ] );\n\n\tconst backgroundColor = getStylesFromColorScheme(\n\t\tstyles.backgroundSolid,\n\t\tstyles.backgroundSolidDark\n\t);\n\n\tconst overlayStyles = [\n\t\tstyles.overlay,\n\t\turl && { opacity: dimRatio / 100 },\n\t\t! gradientValue && {\n\t\t\tbackgroundColor:\n\t\t\t\tcustomOverlayColor ||\n\t\t\t\toverlayColorValue?.color ||\n\t\t\t\tstyle?.color?.background ||\n\t\t\t\tstyles.overlay?.color,\n\t\t},\n\t\t// While we don't support theme colors we add a default bg color.\n\t\t! overlayColorValue.color && ! url ? backgroundColor : {},\n\t\tisImage &&\n\t\t\tisParentSelected &&\n\t\t\t! isUploadInProgress &&\n\t\t\t! didUploadFail &&\n\t\t\tstyles.overlaySelected,\n\t];\n\n\tconst placeholderIconStyle = getStylesFromColorScheme(\n\t\tstyles.icon,\n\t\tstyles.iconDark\n\t);\n\n\tconst placeholderIcon = <Icon icon={ icon } { ...placeholderIconStyle } />;\n\n\tconst toolbarControls = ( open ) => (\n\t\t<BlockControls group=\"other\">\n\t\t\t<ToolbarButton\n\t\t\t\ttitle={ __( 'Edit cover media' ) }\n\t\t\t\ticon={ replace }\n\t\t\t\tonClick={ open }\n\t\t\t/>\n\t\t</BlockControls>\n\t);\n\n\tconst accessibilityHint =\n\t\tPlatform.OS === 'ios'\n\t\t\t? __( 'Double tap to open Action Sheet to add image or video' )\n\t\t\t: __( 'Double tap to open Bottom Sheet to add image or video' );\n\n\tconst addMediaButton = () => (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessibilityHint={ accessibilityHint }\n\t\t\taccessibilityLabel={ __( 'Add image or video' ) }\n\t\t\taccessibilityRole=\"button\"\n\t\t\tonPress={ openMediaOptionsRef.current }\n\t\t>\n\t\t\t<View style={ styles.selectImageContainer }>\n\t\t\t\t<View style={ styles.selectImage }>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\tsize={ 16 }\n\t\t\t\t\t\ticon={ image }\n\t\t\t\t\t\t{ ...styles.selectImageIcon }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n\n\tconst onBottomSheetClosed = useCallback( () => {\n\t\tInteractionManager.runAfterInteractions( () => {\n\t\t\tsetCustomColorPickerShowing( false );\n\t\t} );\n\t}, [] );\n\n\tconst colorPickerControls = (\n\t\t<InspectorControls>\n\t\t\t<BottomSheetConsumer>\n\t\t\t\t{ ( {\n\t\t\t\t\tshouldEnableBottomSheetScroll,\n\t\t\t\t\tshouldEnableBottomSheetMaxHeight,\n\t\t\t\t\tonHandleClosingBottomSheet,\n\t\t\t\t\tonHandleHardwareButtonPress,\n\t\t\t\t\tisBottomSheetContentScrolling,\n\t\t\t\t} ) => (\n\t\t\t\t\t<ColorPicker\n\t\t\t\t\t\tshouldEnableBottomSheetScroll={\n\t\t\t\t\t\t\tshouldEnableBottomSheetScroll\n\t\t\t\t\t\t}\n\t\t\t\t\t\tshouldEnableBottomSheetMaxHeight={\n\t\t\t\t\t\t\tshouldEnableBottomSheetMaxHeight\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetColor={ setColor }\n\t\t\t\t\t\tonNavigationBack={ closeSettingsBottomSheet }\n\t\t\t\t\t\tonHandleClosingBottomSheet={\n\t\t\t\t\t\t\tonHandleClosingBottomSheet\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonHandleHardwareButtonPress={\n\t\t\t\t\t\t\tonHandleHardwareButtonPress\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonBottomSheetClosed={ onBottomSheetClosed }\n\t\t\t\t\t\tisBottomSheetContentScrolling={\n\t\t\t\t\t\t\tisBottomSheetContentScrolling\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbottomLabelText={ __( 'Select a color' ) }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</BottomSheetConsumer>\n\t\t</InspectorControls>\n\t);\n\n\tconst renderContent = ( getMediaOptions ) => (\n\t\t<>\n\t\t\t{ renderBackground( getMediaOptions ) }\n\t\t\t{ isParentSelected && hasOnlyColorBackground && addMediaButton() }\n\t\t</>\n\t);\n\n\tconst renderBackground = ( getMediaOptions ) => (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isParentSelected }\n\t\t\tonPress={ onMediaPressed }\n\t\t\tdisabled={ ! isParentSelected }\n\t\t>\n\t\t\t<View style={ [ styles.background, backgroundColor ] }>\n\t\t\t\t{ getMediaOptions() }\n\t\t\t\t{ isParentSelected &&\n\t\t\t\t\tbackgroundType === VIDEO_BACKGROUND_TYPE &&\n\t\t\t\t\ttoolbarControls( openMediaOptionsRef.current ) }\n\t\t\t\t<MediaUploadProgress\n\t\t\t\t\tmediaId={ id }\n\t\t\t\t\tonUpdateMediaProgress={ () => {\n\t\t\t\t\t\tsetIsUploadInProgress( true );\n\t\t\t\t\t} }\n\t\t\t\t\tonFinishMediaUploadWithSuccess={ ( {\n\t\t\t\t\t\tmediaServerId,\n\t\t\t\t\t\tmediaUrl,\n\t\t\t\t\t} ) => {\n\t\t\t\t\t\tsetIsUploadInProgress( false );\n\t\t\t\t\t\tsetDidUploadFail( false );\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\tid: mediaServerId,\n\t\t\t\t\t\t\turl: mediaUrl,\n\t\t\t\t\t\t\tbackgroundType,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t\tonFinishMediaUploadWithFailure={ () => {\n\t\t\t\t\t\tsetIsUploadInProgress( false );\n\t\t\t\t\t\tsetDidUploadFail( true );\n\t\t\t\t\t} }\n\t\t\t\t\tonMediaUploadStateReset={ () => {\n\t\t\t\t\t\tsetIsUploadInProgress( false );\n\t\t\t\t\t\tsetDidUploadFail( false );\n\t\t\t\t\t\tsetAttributes( { id: undefined, url: undefined } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\n\t\t\t\t{ IMAGE_BACKGROUND_TYPE === backgroundType && (\n\t\t\t\t\t<View style={ styles.imageContainer }>\n\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\teditButton={ false }\n\t\t\t\t\t\t\tfocalPoint={\n\t\t\t\t\t\t\t\tfocalPoint || IMAGE_DEFAULT_FOCAL_POINT\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tisSelected={ isParentSelected }\n\t\t\t\t\t\t\tisUploadFailed={ didUploadFail }\n\t\t\t\t\t\t\tisUploadInProgress={ isUploadInProgress }\n\t\t\t\t\t\t\tonSelectMediaUploadOption={ onSelectMedia }\n\t\t\t\t\t\t\topenMediaOptions={ openMediaOptionsRef.current }\n\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t\twidth={ styles.image?.width }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t) }\n\n\t\t\t\t{ VIDEO_BACKGROUND_TYPE === backgroundType && (\n\t\t\t\t\t<Video\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tdisableFocus\n\t\t\t\t\t\trepeat\n\t\t\t\t\t\tresizeMode={ 'cover' }\n\t\t\t\t\t\tsource={ { uri: url } }\n\t\t\t\t\t\tonLoad={ onVideoLoad }\n\t\t\t\t\t\tonLoadStart={ onVideoLoadStart }\n\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\tstyles.background,\n\t\t\t\t\t\t\t// Hide Video component since it has black background while loading the source.\n\t\t\t\t\t\t\t{ opacity: isVideoLoading ? 0 : 1 },\n\t\t\t\t\t\t] }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n\n\tif (\n\t\t( ! hasBackground && ! hasInnerBlocks ) ||\n\t\tisCustomColorPickerShowing\n\t) {\n\t\treturn (\n\t\t\t<View>\n\t\t\t\t{ isCustomColorPickerShowing && colorPickerControls }\n\t\t\t\t<MediaPlaceholder\n\t\t\t\t\theight={\n\t\t\t\t\t\tstyles.mediaPlaceholderEmptyStateContainer?.height\n\t\t\t\t\t}\n\t\t\t\t\tbackgroundColor={ customOverlayColor }\n\t\t\t\t\thideContent={\n\t\t\t\t\t\tcustomOverlayColor !== '' &&\n\t\t\t\t\t\tcustomOverlayColor !== undefined\n\t\t\t\t\t}\n\t\t\t\t\ticon={ placeholderIcon }\n\t\t\t\t\tlabels={ {\n\t\t\t\t\t\ttitle: __( 'Cover' ),\n\t\t\t\t\t} }\n\t\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\tonFocus={ onFocus }\n\t\t\t\t>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={ styles.colorPaletteWrapper }\n\t\t\t\t\t\tpointerEvents={\n\t\t\t\t\t\t\tisScreenReaderEnabled ? 'none' : 'auto'\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<BottomSheetConsumer>\n\t\t\t\t\t\t\t{ ( { shouldEnableBottomSheetScroll } ) => (\n\t\t\t\t\t\t\t\t<ColorPalette\n\t\t\t\t\t\t\t\t\tcustomColorIndicatorStyles={\n\t\t\t\t\t\t\t\t\t\tstyles.paletteColorIndicator\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcustomIndicatorWrapperStyles={\n\t\t\t\t\t\t\t\t\t\tstyles.paletteCustomIndicatorWrapper\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsetColor={ setColor }\n\t\t\t\t\t\t\t\t\tonCustomPress={ openColorPicker }\n\t\t\t\t\t\t\t\t\tdefaultSettings={ coverDefaultPalette }\n\t\t\t\t\t\t\t\t\tshouldShowCustomLabel={ false }\n\t\t\t\t\t\t\t\t\tshouldShowCustomVerticalSeparator={ false }\n\t\t\t\t\t\t\t\t\tshouldEnableBottomSheetScroll={\n\t\t\t\t\t\t\t\t\t\tshouldEnableBottomSheetScroll\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</BottomSheetConsumer>\n\t\t\t\t\t</View>\n\t\t\t\t</MediaPlaceholder>\n\t\t\t</View>\n\t\t);\n\t}\n\n\treturn (\n\t\t<View style={ styles.backgroundContainer }>\n\t\t\t{ isSelected && (\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<Controls\n\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\tdidUploadFail={ didUploadFail }\n\t\t\t\t\t\thasOnlyColorBackground={ hasOnlyColorBackground }\n\t\t\t\t\t\tisUploadInProgress={ isUploadInProgress }\n\t\t\t\t\t\tonClearMedia={ onClearMedia }\n\t\t\t\t\t\tonSelectMedia={ onSelectMedia }\n\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t/>\n\t\t\t\t</InspectorControls>\n\t\t\t) }\n\n\t\t\t<View\n\t\t\t\tpointerEvents=\"box-none\"\n\t\t\t\tstyle={ [ styles.content, { minHeight: convertedMinHeight } ] }\n\t\t\t>\n\t\t\t\t<InnerBlocks\n\t\t\t\t\tallowedBlocks={ allowedBlocks }\n\t\t\t\t\ttemplate={ INNER_BLOCKS_TEMPLATE }\n\t\t\t\t\ttemplateLock={ templateLock }\n\t\t\t\t\ttemplateInsertUpdatesSelection\n\t\t\t\t\tblockWidth={ blockWidth }\n\t\t\t\t/>\n\t\t\t</View>\n\n\t\t\t<View pointerEvents=\"none\" style={ styles.overlayContainer }>\n\t\t\t\t<View style={ overlayStyles }>\n\t\t\t\t\t{ gradientValue && (\n\t\t\t\t\t\t<Gradient\n\t\t\t\t\t\t\tgradientValue={ gradientValue }\n\t\t\t\t\t\t\tstyle={ styles.background }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</View>\n\t\t\t</View>\n\n\t\t\t<MediaUpload\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tisReplacingMedia={ ! hasOnlyColorBackground }\n\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t\trender={ ( { open, getMediaOptions } ) => {\n\t\t\t\t\topenMediaOptionsRef.current = open;\n\t\t\t\t\treturn renderContent( getMediaOptions );\n\t\t\t\t} }\n\t\t\t/>\n\n\t\t\t{ isImage &&\n\t\t\t\turl &&\n\t\t\t\topenMediaOptionsRef.current &&\n\t\t\t\tisParentSelected &&\n\t\t\t\t! isUploadInProgress &&\n\t\t\t\t! didUploadFail && (\n\t\t\t\t\t<View style={ styles.imageEditButton }>\n\t\t\t\t\t\t<ImageEditingButton\n\t\t\t\t\t\t\tonSelectMediaUploadOption={ onSelectMedia }\n\t\t\t\t\t\t\topenMediaOptions={ openMediaOptionsRef.current }\n\t\t\t\t\t\t\tpickerOptions={ [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdestructiveButton: true,\n\t\t\t\t\t\t\t\t\tid: 'clearMedia',\n\t\t\t\t\t\t\t\t\tlabel: __( 'Clear Media' ),\n\t\t\t\t\t\t\t\t\tonPress: onClearMedia,\n\t\t\t\t\t\t\t\t\tseparated: true,\n\t\t\t\t\t\t\t\t\tvalue: 'clearMedia',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t) }\n\n\t\t\t{ shouldShowFailure && (\n\t\t\t\t<View\n\t\t\t\t\tpointerEvents=\"none\"\n\t\t\t\t\tstyle={ styles.uploadFailedContainer }\n\t\t\t\t>\n\t\t\t\t\t<View style={ styles.uploadFailed }>\n\t\t\t\t\t\t<Icon icon={ warning } { ...styles.uploadFailedIcon } />\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t) }\n\t\t</View>\n\t);\n};\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst { getSelectedBlockClientId, getBlock } =\n\t\t\tselect( blockEditorStore );\n\n\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\n\t\tconst hasInnerBlocks = getBlock( clientId )?.innerBlocks.length > 0;\n\n\t\treturn {\n\t\t\tisParentSelected: selectedBlockClientId === clientId,\n\t\t\thasInnerBlocks,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\tconst { openGeneralSidebar } = dispatch( editPostStore );\n\t\tconst { selectBlock } = dispatch( blockEditorStore );\n\n\t\treturn {\n\t\t\topenGeneralSidebar: () => openGeneralSidebar( 'edit-post/block' ),\n\t\t\tcloseSettingsBottomSheet() {\n\t\t\t\tdispatch( editPostStore ).closeGeneralSidebar();\n\t\t\t},\n\t\t\tselectBlock: () => selectBlock( clientId ),\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( Cover );\n"]}