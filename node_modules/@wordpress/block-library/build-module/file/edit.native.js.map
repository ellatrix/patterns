{"version":3,"sources":["@wordpress/block-library/src/file/edit.native.js"],"names":["View","TouchableWithoutFeedback","Text","Clipboard","requestImageFailedRetryDialog","requestImageUploadCancelDialog","mediaUploadSync","BlockIcon","MediaPlaceholder","MediaUploadProgress","RichText","PlainText","BlockControls","MediaUpload","InspectorControls","MEDIA_TYPE_ANY","store","blockEditorStore","ToolbarButton","ToolbarGroup","PanelBody","ToggleControl","TextControl","SelectControl","Icon","file","icon","replace","button","external","link","warning","Component","__","_x","compose","withPreferredColorScheme","withDispatch","withSelect","getProtocol","coreStore","styles","URL_COPIED_NOTIFICATION_DURATION_MS","MIN_WIDTH","FileEdit","constructor","props","state","isUploadInProgress","isSidebarLinkSettings","placeholderTextWidth","maxWidth","timerRef","onLayout","bind","onSelectFile","onChangeFileName","onChangeDownloadButtonText","updateMediaProgress","finishMediaUploadWithSuccess","finishMediaUploadWithFailure","getFileComponent","onChangeDownloadButtonVisibility","onCopyURL","onChangeOpenInNewWindow","onChangeLinkDestinationOption","onShowLinkSettings","onFilePressed","mediaUploadStateReset","componentDidMount","attributes","setAttributes","downloadButtonText","undefined","id","url","componentWillUnmount","clearTimeout","componentDidUpdate","prevProps","isSidebarOpened","setState","media","href","fileName","title","textLinkHref","showDownloadButton","newHref","isUrlCopied","setString","setTimeout","newValue","textLinkTarget","payload","mediaUrl","mediaServerId","mediaId","openSidebar","getToolbarEditButton","open","getInspectorControls","isUploadFailed","linkDestinationOptions","value","label","attachmentPage","actionButtonStyle","getStylesFromColorScheme","actionButton","actionButtonDark","isCopyUrlDisabled","dimmedActionButtonStyle","dimmedActionButton","dimmedActionButtonDark","finalButtonStyle","getStyleForAlignment","align","getFlexAlign","alignment","alignSelf","getTextAlignmentForAlignment","nativeEvent","width","layout","paddingLeft","paddingRight","defaultButton","getPlaceholderWidth","placeholderText","placeholder","textWidth","lines","Math","min","openMediaOptions","getMediaOptions","isSelected","isButtonFocused","minWidth","dimmedStyle","disabledButton","errorIconStyle","Object","assign","errorIcon","uploadFailed","container","errorContainer","buttonText","color","placeholderTextColor","render","wasBlockJustInserted","instructions","onFocus","select","clientId","isEditorSidebarOpened","isNotFileHref","getMedia","dispatch","openGeneralSidebar"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, TouchableWithoutFeedback, Text } from 'react-native';\nimport Clipboard from '@react-native-clipboard/clipboard';\n\n/**\n * WordPress dependencies\n */\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n\tmediaUploadSync,\n} from '@wordpress/react-native-bridge';\nimport {\n\tBlockIcon,\n\tMediaPlaceholder,\n\tMediaUploadProgress,\n\tRichText,\n\tPlainText,\n\tBlockControls,\n\tMediaUpload,\n\tInspectorControls,\n\tMEDIA_TYPE_ANY,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport {\n\tToolbarButton,\n\tToolbarGroup,\n\tPanelBody,\n\tToggleControl,\n\tTextControl,\n\tSelectControl,\n\tIcon,\n} from '@wordpress/components';\nimport {\n\tfile as icon,\n\treplace,\n\tbutton,\n\texternal,\n\tlink,\n\twarning,\n} from '@wordpress/icons';\nimport { Component } from '@wordpress/element';\nimport { __, _x } from '@wordpress/i18n';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { getProtocol } from '@wordpress/url';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\n\nconst URL_COPIED_NOTIFICATION_DURATION_MS = 1500;\nconst MIN_WIDTH = 40;\n\nexport class FileEdit extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tisUploadInProgress: false,\n\t\t\tisSidebarLinkSettings: false,\n\t\t\tplaceholderTextWidth: 0,\n\t\t\tmaxWidth: 0,\n\t\t};\n\n\t\tthis.timerRef = null;\n\n\t\tthis.onLayout = this.onLayout.bind( this );\n\t\tthis.onSelectFile = this.onSelectFile.bind( this );\n\t\tthis.onChangeFileName = this.onChangeFileName.bind( this );\n\t\tthis.onChangeDownloadButtonText =\n\t\t\tthis.onChangeDownloadButtonText.bind( this );\n\t\tthis.updateMediaProgress = this.updateMediaProgress.bind( this );\n\t\tthis.finishMediaUploadWithSuccess =\n\t\t\tthis.finishMediaUploadWithSuccess.bind( this );\n\t\tthis.finishMediaUploadWithFailure =\n\t\t\tthis.finishMediaUploadWithFailure.bind( this );\n\t\tthis.getFileComponent = this.getFileComponent.bind( this );\n\t\tthis.onChangeDownloadButtonVisibility =\n\t\t\tthis.onChangeDownloadButtonVisibility.bind( this );\n\t\tthis.onCopyURL = this.onCopyURL.bind( this );\n\t\tthis.onChangeOpenInNewWindow =\n\t\t\tthis.onChangeOpenInNewWindow.bind( this );\n\n\t\tthis.onChangeLinkDestinationOption =\n\t\t\tthis.onChangeLinkDestinationOption.bind( this );\n\t\tthis.onShowLinkSettings = this.onShowLinkSettings.bind( this );\n\t\tthis.onFilePressed = this.onFilePressed.bind( this );\n\t\tthis.mediaUploadStateReset = this.mediaUploadStateReset.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { downloadButtonText } = attributes;\n\n\t\tif ( downloadButtonText === undefined || downloadButtonText === '' ) {\n\t\t\tsetAttributes( {\n\t\t\t\tdownloadButtonText: _x( 'Download', 'button label' ),\n\t\t\t} );\n\t\t}\n\n\t\tif (\n\t\t\tattributes.id &&\n\t\t\tattributes.url &&\n\t\t\tgetProtocol( attributes.url ) === 'file:'\n\t\t) {\n\t\t\tmediaUploadSync();\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout( this.timerRef );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif (\n\t\t\tprevProps.isSidebarOpened &&\n\t\t\t! this.props.isSidebarOpened &&\n\t\t\tthis.state.isSidebarLinkSettings\n\t\t) {\n\t\t\tthis.setState( { isSidebarLinkSettings: false } );\n\t\t}\n\t}\n\n\tonSelectFile( media ) {\n\t\tthis.props.setAttributes( {\n\t\t\thref: media.url,\n\t\t\tfileName: media.title,\n\t\t\ttextLinkHref: media.url,\n\t\t\tid: media.id,\n\t\t} );\n\t}\n\n\tonChangeFileName( fileName ) {\n\t\tthis.props.setAttributes( { fileName } );\n\t}\n\n\tonChangeDownloadButtonText( downloadButtonText ) {\n\t\tthis.props.setAttributes( { downloadButtonText } );\n\t}\n\n\tonChangeDownloadButtonVisibility( showDownloadButton ) {\n\t\tthis.props.setAttributes( { showDownloadButton } );\n\t}\n\n\tonChangeLinkDestinationOption( newHref ) {\n\t\t// Choose Media File or Attachment Page (when file is in Media Library)\n\t\tthis.props.setAttributes( { textLinkHref: newHref } );\n\t}\n\n\tonCopyURL() {\n\t\tif ( this.state.isUrlCopied ) {\n\t\t\treturn;\n\t\t}\n\t\tconst { href } = this.props.attributes;\n\t\tClipboard.setString( href );\n\n\t\tthis.setState( { isUrlCopied: true } );\n\t\tthis.timerRef = setTimeout( () => {\n\t\t\tthis.setState( { isUrlCopied: false } );\n\t\t}, URL_COPIED_NOTIFICATION_DURATION_MS );\n\t}\n\n\tonChangeOpenInNewWindow( newValue ) {\n\t\tthis.props.setAttributes( {\n\t\t\ttextLinkTarget: newValue ? '_blank' : false,\n\t\t} );\n\t}\n\n\tupdateMediaProgress( payload ) {\n\t\tconst { setAttributes } = this.props;\n\t\tif ( payload.mediaUrl ) {\n\t\t\tsetAttributes( { url: payload.mediaUrl } );\n\t\t}\n\t\tif ( ! this.state.isUploadInProgress ) {\n\t\t\tthis.setState( { isUploadInProgress: true } );\n\t\t}\n\t}\n\n\tfinishMediaUploadWithSuccess( payload ) {\n\t\tconst { setAttributes } = this.props;\n\n\t\tsetAttributes( {\n\t\t\thref: payload.mediaUrl,\n\t\t\tid: payload.mediaServerId,\n\t\t\ttextLinkHref: payload.mediaUrl,\n\t\t} );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tfinishMediaUploadWithFailure( payload ) {\n\t\tthis.props.setAttributes( { id: payload.mediaId } );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tmediaUploadStateReset() {\n\t\tconst { setAttributes } = this.props;\n\n\t\tsetAttributes( {\n\t\t\tid: null,\n\t\t\thref: null,\n\t\t\ttextLinkHref: null,\n\t\t\tfileName: null,\n\t\t} );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tonShowLinkSettings() {\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tisSidebarLinkSettings: true,\n\t\t\t},\n\t\t\tthis.props.openSidebar\n\t\t);\n\t}\n\n\tgetToolbarEditButton( open ) {\n\t\treturn (\n\t\t\t<BlockControls>\n\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\ttitle={ __( 'Edit file' ) }\n\t\t\t\t\t\ticon={ replace }\n\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\ttitle={ __( 'Link To' ) }\n\t\t\t\t\t\ticon={ link }\n\t\t\t\t\t\tonClick={ this.onShowLinkSettings }\n\t\t\t\t\t/>\n\t\t\t\t</ToolbarGroup>\n\t\t\t</BlockControls>\n\t\t);\n\t}\n\n\tgetInspectorControls(\n\t\t{ showDownloadButton, textLinkTarget, href, textLinkHref },\n\t\tmedia,\n\t\tisUploadInProgress,\n\t\tisUploadFailed\n\t) {\n\t\tlet linkDestinationOptions = [ { value: href, label: __( 'URL' ) } ];\n\t\tconst attachmentPage = media && media.link;\n\t\tconst { isSidebarLinkSettings } = this.state;\n\n\t\tif ( attachmentPage ) {\n\t\t\tlinkDestinationOptions = [\n\t\t\t\t{ value: href, label: __( 'Media file' ) },\n\t\t\t\t{ value: attachmentPage, label: __( 'Attachment page' ) },\n\t\t\t];\n\t\t}\n\n\t\tconst actionButtonStyle = this.props.getStylesFromColorScheme(\n\t\t\tstyles.actionButton,\n\t\t\tstyles.actionButtonDark\n\t\t);\n\n\t\tconst isCopyUrlDisabled = isUploadFailed || isUploadInProgress;\n\n\t\tconst dimmedActionButtonStyle = this.props.getStylesFromColorScheme(\n\t\t\tstyles.dimmedActionButton,\n\t\t\tstyles.dimmedActionButtonDark\n\t\t);\n\n\t\tconst finalButtonStyle = isCopyUrlDisabled\n\t\t\t? dimmedActionButtonStyle\n\t\t\t: actionButtonStyle;\n\n\t\treturn (\n\t\t\t<InspectorControls>\n\t\t\t\t{ isSidebarLinkSettings || (\n\t\t\t\t\t<PanelBody title={ __( 'File block settings' ) } />\n\t\t\t\t) }\n\t\t\t\t<PanelBody>\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\ticon={ link }\n\t\t\t\t\t\tlabel={ __( 'Link to' ) }\n\t\t\t\t\t\tvalue={ textLinkHref }\n\t\t\t\t\t\tonChange={ this.onChangeLinkDestinationOption }\n\t\t\t\t\t\toptions={ linkDestinationOptions }\n\t\t\t\t\t\thideCancelButton={ true }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\ticon={ external }\n\t\t\t\t\t\tlabel={ __( 'Open in new tab' ) }\n\t\t\t\t\t\tchecked={ textLinkTarget === '_blank' }\n\t\t\t\t\t\tonChange={ this.onChangeOpenInNewWindow }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ! isSidebarLinkSettings && (\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\ticon={ button }\n\t\t\t\t\t\t\tlabel={ __( 'Show download button' ) }\n\t\t\t\t\t\t\tchecked={ showDownloadButton }\n\t\t\t\t\t\t\tonChange={ this.onChangeDownloadButtonVisibility }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tdisabled={ isCopyUrlDisabled }\n\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\tthis.state.isUrlCopied\n\t\t\t\t\t\t\t\t? __( 'Copied!' )\n\t\t\t\t\t\t\t\t: __( 'Copy file URL' )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabelStyle={\n\t\t\t\t\t\t\tthis.state.isUrlCopied || finalButtonStyle\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonPress={ this.onCopyURL }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t);\n\t}\n\n\tgetStyleForAlignment( align ) {\n\t\tconst getFlexAlign = ( alignment ) => {\n\t\t\tswitch ( alignment ) {\n\t\t\t\tcase 'right':\n\t\t\t\t\treturn 'flex-end';\n\t\t\t\tcase 'center':\n\t\t\t\t\treturn 'center';\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'flex-start';\n\t\t\t}\n\t\t};\n\t\treturn { alignSelf: getFlexAlign( align ) };\n\t}\n\n\tgetTextAlignmentForAlignment( align ) {\n\t\tswitch ( align ) {\n\t\t\tcase 'right':\n\t\t\t\treturn 'right';\n\t\t\tcase 'center':\n\t\t\t\treturn 'center';\n\t\t\tdefault:\n\t\t\t\treturn 'left';\n\t\t}\n\t}\n\n\tonFilePressed() {\n\t\tconst { attributes } = this.props;\n\n\t\tif ( this.state.isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( attributes.id );\n\t\t} else if (\n\t\t\tattributes.id &&\n\t\t\tgetProtocol( attributes.href ) === 'file:'\n\t\t) {\n\t\t\trequestImageFailedRetryDialog( attributes.id );\n\t\t}\n\t}\n\n\tonLayout( { nativeEvent } ) {\n\t\tconst { width } = nativeEvent.layout;\n\t\tconst { paddingLeft, paddingRight } = styles.defaultButton;\n\t\tthis.setState( {\n\t\t\tmaxWidth: width - ( paddingLeft + paddingRight ),\n\t\t} );\n\t}\n\n\t// Render `Text` with `placeholderText` styled as a placeholder\n\t// to calculate its width which then is set as a `minWidth`\n\t// This should be fixed on RNAztec level. In the mean time,\n\t// We use the same strategy implemented in Button block.\n\tgetPlaceholderWidth( placeholderText ) {\n\t\tconst { maxWidth, placeholderTextWidth } = this.state;\n\t\treturn (\n\t\t\t<Text\n\t\t\t\tstyle={ styles.placeholder }\n\t\t\t\tonTextLayout={ ( { nativeEvent } ) => {\n\t\t\t\t\tconst textWidth =\n\t\t\t\t\t\tnativeEvent.lines[ 0 ] && nativeEvent.lines[ 0 ].width;\n\t\t\t\t\tif ( textWidth && textWidth !== placeholderTextWidth ) {\n\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\tplaceholderTextWidth: Math.min(\n\t\t\t\t\t\t\t\ttextWidth,\n\t\t\t\t\t\t\t\tmaxWidth\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ placeholderText }\n\t\t\t</Text>\n\t\t);\n\t}\n\n\tgetFileComponent( openMediaOptions, getMediaOptions ) {\n\t\tconst { attributes, media, isSelected } = this.props;\n\t\tconst { isButtonFocused, placeholderTextWidth } = this.state;\n\n\t\tconst { fileName, downloadButtonText, id, showDownloadButton, align } =\n\t\t\tattributes;\n\n\t\tconst minWidth =\n\t\t\tisButtonFocused ||\n\t\t\t( ! isButtonFocused &&\n\t\t\t\tdownloadButtonText &&\n\t\t\t\tdownloadButtonText !== '' )\n\t\t\t\t? MIN_WIDTH\n\t\t\t\t: placeholderTextWidth;\n\n\t\tconst placeholderText =\n\t\t\tisButtonFocused ||\n\t\t\t( ! isButtonFocused &&\n\t\t\t\tdownloadButtonText &&\n\t\t\t\tdownloadButtonText !== '' )\n\t\t\t\t? ''\n\t\t\t\t: __( 'Add text…' );\n\n\t\treturn (\n\t\t\t<MediaUploadProgress\n\t\t\t\tmediaId={ id }\n\t\t\t\tonUpdateMediaProgress={ this.updateMediaProgress }\n\t\t\t\tonFinishMediaUploadWithSuccess={\n\t\t\t\t\tthis.finishMediaUploadWithSuccess\n\t\t\t\t}\n\t\t\t\tonFinishMediaUploadWithFailure={\n\t\t\t\t\tthis.finishMediaUploadWithFailure\n\t\t\t\t}\n\t\t\t\tonMediaUploadStateReset={ this.mediaUploadStateReset }\n\t\t\t\trenderContent={ ( { isUploadInProgress, isUploadFailed } ) => {\n\t\t\t\t\tconst dimmedStyle =\n\t\t\t\t\t\t( this.state.isUploadInProgress || isUploadFailed ) &&\n\t\t\t\t\t\tstyles.disabledButton;\n\t\t\t\t\tconst finalButtonStyle = [\n\t\t\t\t\t\tstyles.defaultButton,\n\t\t\t\t\t\tdimmedStyle,\n\t\t\t\t\t];\n\n\t\t\t\t\tconst errorIconStyle = Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tstyles.errorIcon,\n\t\t\t\t\t\tstyles.uploadFailed\n\t\t\t\t\t);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\t\taccessible={ ! isSelected }\n\t\t\t\t\t\t\tonPress={ this.onFilePressed }\n\t\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tonLayout={ this.onLayout }\n\t\t\t\t\t\t\t\ttestID=\"file-edit-container\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ this.getPlaceholderWidth( placeholderText ) }\n\t\t\t\t\t\t\t\t{ isUploadInProgress ||\n\t\t\t\t\t\t\t\t\tthis.getToolbarEditButton(\n\t\t\t\t\t\t\t\t\t\topenMediaOptions\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ getMediaOptions() }\n\t\t\t\t\t\t\t\t{ isSelected &&\n\t\t\t\t\t\t\t\t\tthis.getInspectorControls(\n\t\t\t\t\t\t\t\t\t\tattributes,\n\t\t\t\t\t\t\t\t\t\tmedia,\n\t\t\t\t\t\t\t\t\t\tisUploadInProgress,\n\t\t\t\t\t\t\t\t\t\tisUploadFailed\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t<View style={ styles.container }>\n\t\t\t\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\t\t\t\twithoutInteractiveFormatting\n\t\t\t\t\t\t\t\t\t\t__unstableMobileNoFocusOnMount\n\t\t\t\t\t\t\t\t\t\tonChange={ this.onChangeFileName }\n\t\t\t\t\t\t\t\t\t\tplaceholder={ __( 'File name' ) }\n\t\t\t\t\t\t\t\t\t\trootTagsToEliminate={ [ 'p' ] }\n\t\t\t\t\t\t\t\t\t\ttagName=\"p\"\n\t\t\t\t\t\t\t\t\t\tunderlineColorAndroid=\"transparent\"\n\t\t\t\t\t\t\t\t\t\tvalue={ fileName }\n\t\t\t\t\t\t\t\t\t\tdeleteEnter={ true }\n\t\t\t\t\t\t\t\t\t\ttextAlign={ this.getTextAlignmentForAlignment(\n\t\t\t\t\t\t\t\t\t\t\talign\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t\t\t\t<View style={ styles.errorContainer }>\n\t\t\t\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\t\t\t\ticon={ warning }\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={ errorIconStyle }\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<PlainText\n\t\t\t\t\t\t\t\t\t\t\t\teditable={ false }\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ __( 'Error' ) }\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={ styles.uploadFailed }\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t{ showDownloadButton &&\n\t\t\t\t\t\t\t\t\tthis.state.maxWidth > 0 && (\n\t\t\t\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\t\t\t\t\tfinalButtonStyle,\n\t\t\t\t\t\t\t\t\t\t\t\tthis.getStyleForAlignment(\n\t\t\t\t\t\t\t\t\t\t\t\t\talign\n\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\t\t\t\t\t\twithoutInteractiveFormatting\n\t\t\t\t\t\t\t\t\t\t\t\t__unstableMobileNoFocusOnMount\n\t\t\t\t\t\t\t\t\t\t\t\trootTagsToEliminate={ [ 'p' ] }\n\t\t\t\t\t\t\t\t\t\t\t\ttagName=\"p\"\n\t\t\t\t\t\t\t\t\t\t\t\ttextAlign=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\tminWidth={ minWidth }\n\t\t\t\t\t\t\t\t\t\t\t\tmaxWidth={ this.state.maxWidth }\n\t\t\t\t\t\t\t\t\t\t\t\tdeleteEnter={ true }\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={ styles.buttonText }\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ downloadButtonText }\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={ placeholderText }\n\t\t\t\t\t\t\t\t\t\t\t\tunstableOnFocus={ () =>\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisButtonFocused: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tonBlur={ () =>\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisButtonFocused: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tselectionColor={\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyles.buttonText.color\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholderTextColor={\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyles.placeholderTextColor\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.color\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tunderlineColorAndroid=\"transparent\"\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.onChangeDownloadButtonText\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { attributes, wasBlockJustInserted, isSelected } = this.props;\n\t\tconst { href } = attributes;\n\n\t\tif ( ! href ) {\n\t\t\treturn (\n\t\t\t\t<MediaPlaceholder\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\t\tlabels={ {\n\t\t\t\t\t\ttitle: __( 'File' ),\n\t\t\t\t\t\tinstructions: __( 'CHOOSE A FILE' ),\n\t\t\t\t\t} }\n\t\t\t\t\tonSelect={ this.onSelectFile }\n\t\t\t\t\tonFocus={ this.props.onFocus }\n\t\t\t\t\tallowedTypes={ [ MEDIA_TYPE_ANY ] }\n\t\t\t\t\tautoOpenMediaUpload={ isSelected && wasBlockJustInserted }\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<MediaUpload\n\t\t\t\tallowedTypes={ [ MEDIA_TYPE_ANY ] }\n\t\t\t\tisReplacingMedia={ true }\n\t\t\t\tonSelect={ this.onSelectFile }\n\t\t\t\trender={ ( { open, getMediaOptions } ) => {\n\t\t\t\t\treturn this.getFileComponent( open, getMediaOptions );\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, props ) => {\n\t\tconst { attributes, isSelected, clientId } = props;\n\t\tconst { id, href } = attributes;\n\t\tconst { isEditorSidebarOpened } = select( 'core/edit-post' );\n\t\tconst isNotFileHref = id && getProtocol( href ) !== 'file:';\n\t\treturn {\n\t\t\tmedia: isNotFileHref\n\t\t\t\t? select( coreStore ).getMedia( id )\n\t\t\t\t: undefined,\n\t\t\tisSidebarOpened: isSelected && isEditorSidebarOpened(),\n\t\t\twasBlockJustInserted: select(\n\t\t\t\tblockEditorStore\n\t\t\t).wasBlockJustInserted( clientId, 'inserter_menu' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { openGeneralSidebar } = dispatch( 'core/edit-post' );\n\t\treturn {\n\t\t\topenSidebar: () => openGeneralSidebar( 'edit-post/block' ),\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( FileEdit );\n"]}