{"version":3,"sources":["@wordpress/block-library/src/gallery/shared.js"],"names":["Platform","defaultColumnsNumber","imageCount","Math","min","pickRelevantMediaFiles","image","sizeSlug","imageProps","Object","fromEntries","entries","filter","key","includes","url","sizes","media_details","source_url","fullUrl","full","getGalleryBlockV2Enabled","window","wp","galleryBlockV2Enabled","isGalleryV2Enabled","isNative"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAT,QAAyB,oBAAzB;AAEA,OAAO,SAASC,oBAAT,CAA+BC,UAA/B,EAA4C;AAClD,SAAOA,UAAU,GAAGC,IAAI,CAACC,GAAL,CAAU,CAAV,EAAaF,UAAb,CAAH,GAA+B,CAAhD;AACA;AAED,OAAO,MAAMG,sBAAsB,GAAG,UAAEC,KAAF,EAAiC;AAAA;;AAAA,MAAxBC,QAAwB,uEAAb,OAAa;AACtE,QAAMC,UAAU,GAAGC,MAAM,CAACC,WAAP,CAClBD,MAAM,CAACE,OAAP,CAAgBL,KAAhB,aAAgBA,KAAhB,cAAgBA,KAAhB,GAAyB,EAAzB,EAA8BM,MAA9B,CAAsC;AAAA,QAAE,CAAEC,GAAF,CAAF;AAAA,WACrC,CAAE,KAAF,EAAS,IAAT,EAAe,MAAf,EAAwBC,QAAxB,CAAkCD,GAAlC,CADqC;AAAA,GAAtC,CADkB,CAAnB;AAMAL,EAAAA,UAAU,CAACO,GAAX,GACC,CAAAT,KAAK,SAAL,IAAAA,KAAK,WAAL,4BAAAA,KAAK,CAAEU,KAAP,uFAAgBT,QAAhB,iFAA4BQ,GAA5B,MACAT,KADA,aACAA,KADA,+CACAA,KAAK,CAAEW,aADP,kFACA,qBAAsBD,KADtB,oFACA,sBAA+BT,QAA/B,CADA,2DACA,uBAA2CW,UAD3C,MAEAZ,KAFA,aAEAA,KAFA,uBAEAA,KAAK,CAAES,GAFP,MAGAT,KAHA,aAGAA,KAHA,uBAGAA,KAAK,CAAEY,UAHP,CADD;AAKA,QAAMC,OAAO,GACZ,CAAAb,KAAK,SAAL,IAAAA,KAAK,WAAL,6BAAAA,KAAK,CAAEU,KAAP,sFAAcI,IAAd,0EAAoBL,GAApB,MACAT,KADA,aACAA,KADA,gDACAA,KAAK,CAAEW,aADP,mFACA,sBAAsBD,KADtB,mFACA,sBAA6BI,IAD7B,0DACA,sBAAmCF,UADnC,CADD;;AAGA,MAAKC,OAAL,EAAe;AACdX,IAAAA,UAAU,CAACW,OAAX,GAAqBA,OAArB;AACA;;AACD,SAAOX,UAAP;AACA,CAnBM;;AAqBP,SAASa,wBAAT,GAAoC;AACnC;AACA;AACA,MAAK,CAAEC,MAAM,CAACC,EAAT,IAAe,OAAOD,MAAM,CAACC,EAAP,CAAUC,qBAAjB,KAA2C,SAA/D,EAA2E;AAC1E,UAAM,gDAAN;AACA;;AACD,SAAOF,MAAM,CAACC,EAAP,CAAUC,qBAAjB;AACA;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,SAASC,kBAAT,GAA8B;AACpC,MAAKzB,QAAQ,CAAC0B,QAAd,EAAyB;AACxB,WAAOL,wBAAwB,EAA/B;AACA;;AAED,SAAO,IAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Platform } from '@wordpress/element';\n\nexport function defaultColumnsNumber( imageCount ) {\n\treturn imageCount ? Math.min( 3, imageCount ) : 3;\n}\n\nexport const pickRelevantMediaFiles = ( image, sizeSlug = 'large' ) => {\n\tconst imageProps = Object.fromEntries(\n\t\tObject.entries( image ?? {} ).filter( ( [ key ] ) =>\n\t\t\t[ 'alt', 'id', 'link' ].includes( key )\n\t\t)\n\t);\n\n\timageProps.url =\n\t\timage?.sizes?.[ sizeSlug ]?.url ||\n\t\timage?.media_details?.sizes?.[ sizeSlug ]?.source_url ||\n\t\timage?.url ||\n\t\timage?.source_url;\n\tconst fullUrl =\n\t\timage?.sizes?.full?.url ||\n\t\timage?.media_details?.sizes?.full?.source_url;\n\tif ( fullUrl ) {\n\t\timageProps.fullUrl = fullUrl;\n\t}\n\treturn imageProps;\n};\n\nfunction getGalleryBlockV2Enabled() {\n\t// We want to fail early here, at least during beta testing phase, to ensure\n\t// there aren't instances where undefined values cause false negatives.\n\tif ( ! window.wp || typeof window.wp.galleryBlockV2Enabled !== 'boolean' ) {\n\t\tthrow 'window.wp.galleryBlockV2Enabled is not defined';\n\t}\n\treturn window.wp.galleryBlockV2Enabled;\n}\n\n/**\n * The new gallery block format is not compatible with the use_BalanceTags option\n * in WP versions <= 5.8 https://core.trac.wordpress.org/ticket/54130. The\n * window.wp.galleryBlockV2Enabled flag is set in lib/compat.php. This method\n * can be removed when minimum supported WP version >=5.9.\n */\nexport function isGalleryV2Enabled() {\n\tif ( Platform.isNative ) {\n\t\treturn getGalleryBlockV2Enabled();\n\t}\n\n\treturn true;\n}\n"]}