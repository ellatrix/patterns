{"version":3,"sources":["@wordpress/block-library/src/avatar/hooks.js"],"names":["getAvatarSizes","sizes","minSize","maxSize","length","maxSizeBuffer","Math","floor","useDefaultAvatar","avatarURL","defaultAvatarUrl","select","getSettings","blockEditorStore","__experimentalDiscussionSettings","useCommentAvatar","commentId","avatars","authorName","avatarUrls","Object","values","keys","defaultAvatar","src","alt","useUserAvatar","userId","postId","postType","authorDetails","getEditedEntityRecord","getUser","coreStore","_authorId","author","avatar_urls","name"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { store as coreStore, useEntityProp } from '@wordpress/core-data';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\n\nfunction getAvatarSizes( sizes ) {\n\tconst minSize = sizes ? sizes[ 0 ] : 24;\n\tconst maxSize = sizes ? sizes[ sizes.length - 1 ] : 96;\n\tconst maxSizeBuffer = Math.floor( maxSize * 2.5 );\n\treturn {\n\t\tminSize,\n\t\tmaxSize: maxSizeBuffer,\n\t};\n}\n\nfunction useDefaultAvatar() {\n\tconst { avatarURL: defaultAvatarUrl } = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst { __experimentalDiscussionSettings } = getSettings();\n\t\treturn __experimentalDiscussionSettings;\n\t} );\n\treturn defaultAvatarUrl;\n}\n\nexport function useCommentAvatar( { commentId } ) {\n\tconst [ avatars ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_avatar_urls',\n\t\tcommentId\n\t);\n\n\tconst [ authorName ] = useEntityProp(\n\t\t'root',\n\t\t'comment',\n\t\t'author_name',\n\t\tcommentId\n\t);\n\tconst avatarUrls = avatars ? Object.values( avatars ) : null;\n\tconst sizes = avatars ? Object.keys( avatars ) : null;\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\n\tconst defaultAvatar = useDefaultAvatar();\n\treturn {\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\n\t\tminSize,\n\t\tmaxSize,\n\t\t// translators: %s is the Author name.\n\t\talt: authorName\n\t\t\t? // translators: %s is the Author name.\n\t\t\t  sprintf( __( '%s Avatar' ), authorName )\n\t\t\t: __( 'Default Avatar' ),\n\t};\n}\n\nexport function useUserAvatar( { userId, postId, postType } ) {\n\tconst { authorDetails } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEditedEntityRecord, getUser } = select( coreStore );\n\t\t\tif ( userId ) {\n\t\t\t\treturn {\n\t\t\t\t\tauthorDetails: getUser( userId ),\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst _authorId = getEditedEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\tpostType,\n\t\t\t\tpostId\n\t\t\t)?.author;\n\n\t\t\treturn {\n\t\t\t\tauthorDetails: _authorId ? getUser( _authorId ) : null,\n\t\t\t};\n\t\t},\n\t\t[ postType, postId, userId ]\n\t);\n\tconst avatarUrls = authorDetails?.avatar_urls\n\t\t? Object.values( authorDetails.avatar_urls )\n\t\t: null;\n\tconst sizes = authorDetails?.avatar_urls\n\t\t? Object.keys( authorDetails.avatar_urls )\n\t\t: null;\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\n\tconst defaultAvatar = useDefaultAvatar();\n\treturn {\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\n\t\tminSize,\n\t\tmaxSize,\n\t\talt: authorDetails\n\t\t\t? // translators: %s is the Author name.\n\t\t\t  sprintf( __( '%s Avatar' ), authorDetails?.name )\n\t\t\t: __( 'Default Avatar' ),\n\t};\n}\n"]}