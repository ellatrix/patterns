{"version":3,"sources":["@wordpress/block-library/src/list/edit.js"],"names":["TEMPLATE","NATIVE_MARGIN_SPACING","useMigrateOnLoad","attributes","clientId","registry","updateBlockAttributes","replaceInnerBlocks","blockEditorStore","values","newAttributes","newInnerBlocks","since","version","alternative","batch","useOutdentList","canOutdent","innerSelect","getBlockRootClientId","getBlock","parentId","name","replaceBlocks","selectionChange","getBlockAttributes","parentBlockId","parentBlockAttributes","newParentBlock","innerBlocks","length","IndentUI","outdentList","formatOutdentRTL","formatOutdent","Edit","setAttributes","style","blockProps","Platform","isNative","innerBlocksProps","allowedBlocks","template","templateLock","templateInsertUpdatesSelection","marginVertical","marginHorizontal","useCompactList","ordered","type","reversed","start","controls","formatListBulletsRTL","formatListBullets","formatListNumberedRTL","formatListNumbered"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { ToolbarButton } from '@wordpress/components';\nimport { useDispatch, useSelect, useRegistry } from '@wordpress/data';\nimport { isRTL, __ } from '@wordpress/i18n';\nimport {\n\tformatListBullets,\n\tformatListBulletsRTL,\n\tformatListNumbered,\n\tformatListNumberedRTL,\n\tformatOutdent,\n\tformatOutdentRTL,\n} from '@wordpress/icons';\nimport { createBlock } from '@wordpress/blocks';\nimport { useCallback, useEffect, Platform } from '@wordpress/element';\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport OrderedListSettings from './ordered-list-settings';\nimport { migrateToListV2 } from './utils';\nimport TagName from './tag-name';\n\nconst TEMPLATE = [ [ 'core/list-item' ] ];\nconst NATIVE_MARGIN_SPACING = 8;\n\n/**\n * At the moment, deprecations don't handle create blocks from attributes\n * (like when using CPT templates). For this reason, this hook is necessary\n * to avoid breaking templates using the old list block format.\n *\n * @param {Object} attributes Block attributes.\n * @param {string} clientId   Block client ID.\n */\nfunction useMigrateOnLoad( attributes, clientId ) {\n\tconst registry = useRegistry();\n\tconst { updateBlockAttributes, replaceInnerBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tuseEffect( () => {\n\t\t// As soon as the block is loaded, migrate it to the new version.\n\n\t\tif ( ! attributes.values ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [ newAttributes, newInnerBlocks ] = migrateToListV2( attributes );\n\n\t\tdeprecated( 'Value attribute on the list block', {\n\t\t\tsince: '6.0',\n\t\t\tversion: '6.5',\n\t\t\talternative: 'inner blocks',\n\t\t} );\n\n\t\tregistry.batch( () => {\n\t\t\tupdateBlockAttributes( clientId, newAttributes );\n\t\t\treplaceInnerBlocks( clientId, newInnerBlocks );\n\t\t} );\n\t}, [ attributes.values ] );\n}\n\nfunction useOutdentList( clientId ) {\n\tconst { canOutdent } = useSelect(\n\t\t( innerSelect ) => {\n\t\t\tconst { getBlockRootClientId, getBlock } =\n\t\t\t\tinnerSelect( blockEditorStore );\n\t\t\tconst parentId = getBlockRootClientId( clientId );\n\t\t\treturn {\n\t\t\t\tcanOutdent:\n\t\t\t\t\t!! parentId &&\n\t\t\t\t\tgetBlock( parentId ).name === 'core/list-item',\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\tconst { replaceBlocks, selectionChange } = useDispatch( blockEditorStore );\n\tconst { getBlockRootClientId, getBlockAttributes, getBlock } =\n\t\tuseSelect( blockEditorStore );\n\n\treturn [\n\t\tcanOutdent,\n\t\tuseCallback( () => {\n\t\t\tconst parentBlockId = getBlockRootClientId( clientId );\n\t\t\tconst parentBlockAttributes = getBlockAttributes( parentBlockId );\n\t\t\t// Create a new parent block without the inner blocks.\n\t\t\tconst newParentBlock = createBlock(\n\t\t\t\t'core/list-item',\n\t\t\t\tparentBlockAttributes\n\t\t\t);\n\t\t\tconst { innerBlocks } = getBlock( clientId );\n\t\t\t// Replace the parent block with a new parent block without inner blocks,\n\t\t\t// and make the inner blocks siblings of the parent.\n\t\t\treplaceBlocks(\n\t\t\t\t[ parentBlockId ],\n\t\t\t\t[ newParentBlock, ...innerBlocks ]\n\t\t\t);\n\t\t\t// Select the last child of the list being outdent.\n\t\t\tselectionChange( innerBlocks[ innerBlocks.length - 1 ].clientId );\n\t\t}, [ clientId ] ),\n\t];\n}\n\nfunction IndentUI( { clientId } ) {\n\tconst [ canOutdent, outdentList ] = useOutdentList( clientId );\n\treturn (\n\t\t<>\n\t\t\t<ToolbarButton\n\t\t\t\ticon={ isRTL() ? formatOutdentRTL : formatOutdent }\n\t\t\t\ttitle={ __( 'Outdent' ) }\n\t\t\t\tdescribedBy={ __( 'Outdent list item' ) }\n\t\t\t\tdisabled={ ! canOutdent }\n\t\t\t\tonClick={ outdentList }\n\t\t\t/>\n\t\t</>\n\t);\n}\n\nexport default function Edit( { attributes, setAttributes, clientId, style } ) {\n\tconst blockProps = useBlockProps( {\n\t\t...( Platform.isNative && { style } ),\n\t} );\n\tconst innerBlocksProps = useInnerBlocksProps( blockProps, {\n\t\tallowedBlocks: [ 'core/list-item' ],\n\t\ttemplate: TEMPLATE,\n\t\ttemplateLock: false,\n\t\ttemplateInsertUpdatesSelection: true,\n\t\t...( Platform.isNative && {\n\t\t\tmarginVertical: NATIVE_MARGIN_SPACING,\n\t\t\tmarginHorizontal: NATIVE_MARGIN_SPACING,\n\t\t\tuseCompactList: true,\n\t\t} ),\n\t} );\n\tuseMigrateOnLoad( attributes, clientId );\n\tconst { ordered, type, reversed, start } = attributes;\n\n\tconst controls = (\n\t\t<BlockControls group=\"block\">\n\t\t\t<ToolbarButton\n\t\t\t\ticon={ isRTL() ? formatListBulletsRTL : formatListBullets }\n\t\t\t\ttitle={ __( 'Unordered' ) }\n\t\t\t\tdescribedBy={ __( 'Convert to unordered list' ) }\n\t\t\t\tisActive={ ordered === false }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tsetAttributes( { ordered: false } );\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<ToolbarButton\n\t\t\t\ticon={ isRTL() ? formatListNumberedRTL : formatListNumbered }\n\t\t\t\ttitle={ __( 'Ordered' ) }\n\t\t\t\tdescribedBy={ __( 'Convert to ordered list' ) }\n\t\t\t\tisActive={ ordered === true }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tsetAttributes( { ordered: true } );\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<IndentUI clientId={ clientId } />\n\t\t</BlockControls>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<TagName\n\t\t\t\tordered={ ordered }\n\t\t\t\treversed={ reversed }\n\t\t\t\tstart={ start }\n\t\t\t\ttype={ type }\n\t\t\t\t{ ...innerBlocksProps }\n\t\t\t/>\n\t\t\t{ controls }\n\t\t\t{ ordered && (\n\t\t\t\t<OrderedListSettings\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\tordered={ ordered }\n\t\t\t\t\treversed={ reversed }\n\t\t\t\t\tstart={ start }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n}\n"]}