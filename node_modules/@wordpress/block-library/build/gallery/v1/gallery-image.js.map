{"version":3,"sources":["@wordpress/block-library/src/gallery/v1/gallery-image.js"],"names":["isTemporaryImage","id","url","GalleryImage","Component","constructor","arguments","onSelectImage","bind","onRemoveImage","bindContainer","onEdit","onSelectImageFromLibrary","onSelectCustomURL","state","isEditing","ref","container","props","isSelected","onSelect","event","ownerDocument","activeElement","BACKSPACE","DELETE","indexOf","keyCode","preventDefault","onRemove","setState","componentDidUpdate","image","__unstableMarkNextChangeAsNotPersistent","setAttributes","source_url","alt","alt_text","deselectOnBlur","onDeselect","media","caption","sizeSlug","mediaAttributes","omittedAlt","restMediaAttributes","omittedCaption","newURL","undefined","render","linkTo","link","isFirstItem","isLastItem","onMoveForward","onMoveBackward","ariaLabel","href","LINK_DESTINATION_MEDIA","LINK_DESTINATION_ATTACHMENT","img","className","title","imageIcon","src","chevronLeft","chevronRight","edit","closeSmall","newCaption","select","ownProps","getMedia","coreStore","parseInt","dispatch","blockEditorStore"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { Button, Spinner, ButtonGroup } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { BACKSPACE, DELETE } from '@wordpress/keycodes';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport {\n\tRichText,\n\tMediaPlaceholder,\n\tstore as blockEditorStore,\n\t__experimentalGetElementClassName,\n} from '@wordpress/block-editor';\nimport { isBlobURL } from '@wordpress/blob';\nimport { compose } from '@wordpress/compose';\nimport {\n\tcloseSmall,\n\tchevronLeft,\n\tchevronRight,\n\tedit,\n\timage as imageIcon,\n} from '@wordpress/icons';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { pickRelevantMediaFiles } from './shared';\nimport {\n\tLINK_DESTINATION_ATTACHMENT,\n\tLINK_DESTINATION_MEDIA,\n} from './constants';\n\nconst isTemporaryImage = ( id, url ) => ! id && isBlobURL( url );\n\nclass GalleryImage extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSelectImage = this.onSelectImage.bind( this );\n\t\tthis.onRemoveImage = this.onRemoveImage.bind( this );\n\t\tthis.bindContainer = this.bindContainer.bind( this );\n\t\tthis.onEdit = this.onEdit.bind( this );\n\t\tthis.onSelectImageFromLibrary =\n\t\t\tthis.onSelectImageFromLibrary.bind( this );\n\t\tthis.onSelectCustomURL = this.onSelectCustomURL.bind( this );\n\t\tthis.state = {\n\t\t\tisEditing: false,\n\t\t};\n\t}\n\n\tbindContainer( ref ) {\n\t\tthis.container = ref;\n\t}\n\n\tonSelectImage() {\n\t\tif ( ! this.props.isSelected ) {\n\t\t\tthis.props.onSelect();\n\t\t}\n\t}\n\n\tonRemoveImage( event ) {\n\t\tif (\n\t\t\tthis.container === this.container.ownerDocument.activeElement &&\n\t\t\tthis.props.isSelected &&\n\t\t\t[ BACKSPACE, DELETE ].indexOf( event.keyCode ) !== -1\n\t\t) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.props.onRemove();\n\t\t}\n\t}\n\n\tonEdit() {\n\t\tthis.setState( {\n\t\t\tisEditing: true,\n\t\t} );\n\t}\n\n\tcomponentDidUpdate() {\n\t\tconst { image, url, __unstableMarkNextChangeAsNotPersistent } =\n\t\t\tthis.props;\n\t\tif ( image && ! url ) {\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\n\t\t\tthis.props.setAttributes( {\n\t\t\t\turl: image.source_url,\n\t\t\t\talt: image.alt_text,\n\t\t\t} );\n\t\t}\n\t}\n\n\tdeselectOnBlur() {\n\t\tthis.props.onDeselect();\n\t}\n\n\tonSelectImageFromLibrary( media ) {\n\t\tconst { setAttributes, id, url, alt, caption, sizeSlug } = this.props;\n\t\tif ( ! media || ! media.url ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet mediaAttributes = pickRelevantMediaFiles( media, sizeSlug );\n\n\t\t// If the current image is temporary but an alt text was meanwhile\n\t\t// written by the user, make sure the text is not overwritten.\n\t\tif ( isTemporaryImage( id, url ) ) {\n\t\t\tif ( alt ) {\n\t\t\t\tconst { alt: omittedAlt, ...restMediaAttributes } =\n\t\t\t\t\tmediaAttributes;\n\t\t\t\tmediaAttributes = restMediaAttributes;\n\t\t\t}\n\t\t}\n\n\t\t// If a caption text was meanwhile written by the user,\n\t\t// make sure the text is not overwritten by empty captions.\n\t\tif ( caption && ! mediaAttributes.caption ) {\n\t\t\tconst { caption: omittedCaption, ...restMediaAttributes } =\n\t\t\t\tmediaAttributes;\n\t\t\tmediaAttributes = restMediaAttributes;\n\t\t}\n\n\t\tsetAttributes( mediaAttributes );\n\t\tthis.setState( {\n\t\t\tisEditing: false,\n\t\t} );\n\t}\n\n\tonSelectCustomURL( newURL ) {\n\t\tconst { setAttributes, url } = this.props;\n\t\tif ( newURL !== url ) {\n\t\t\tsetAttributes( {\n\t\t\t\turl: newURL,\n\t\t\t\tid: undefined,\n\t\t\t} );\n\t\t\tthis.setState( {\n\t\t\t\tisEditing: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\turl,\n\t\t\talt,\n\t\t\tid,\n\t\t\tlinkTo,\n\t\t\tlink,\n\t\t\tisFirstItem,\n\t\t\tisLastItem,\n\t\t\tisSelected,\n\t\t\tcaption,\n\t\t\tonRemove,\n\t\t\tonMoveForward,\n\t\t\tonMoveBackward,\n\t\t\tsetAttributes,\n\t\t\t'aria-label': ariaLabel,\n\t\t} = this.props;\n\t\tconst { isEditing } = this.state;\n\n\t\tlet href;\n\n\t\tswitch ( linkTo ) {\n\t\t\tcase LINK_DESTINATION_MEDIA:\n\t\t\t\thref = url;\n\t\t\t\tbreak;\n\t\t\tcase LINK_DESTINATION_ATTACHMENT:\n\t\t\t\thref = link;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst img = (\n\t\t\t// Disable reason: Image itself is not meant to be interactive, but should\n\t\t\t// direct image selection and unfocus caption fields.\n\t\t\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n\t\t\t<>\n\t\t\t\t<img\n\t\t\t\t\tsrc={ url }\n\t\t\t\t\talt={ alt }\n\t\t\t\t\tdata-id={ id }\n\t\t\t\t\tonKeyDown={ this.onRemoveImage }\n\t\t\t\t\ttabIndex=\"0\"\n\t\t\t\t\taria-label={ ariaLabel }\n\t\t\t\t\tref={ this.bindContainer }\n\t\t\t\t/>\n\t\t\t\t{ isBlobURL( url ) && <Spinner /> }\n\t\t\t</>\n\t\t\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions */\n\t\t);\n\n\t\tconst className = classnames( {\n\t\t\t'is-selected': isSelected,\n\t\t\t'is-transient': isBlobURL( url ),\n\t\t} );\n\n\t\treturn (\n\t\t\t// eslint-disable-next-line jsx-a11y/click-events-have-key-events, jsx-a11y/no-noninteractive-element-interactions\n\t\t\t<figure\n\t\t\t\tclassName={ className }\n\t\t\t\tonClick={ this.onSelectImage }\n\t\t\t\tonFocus={ this.onSelectImage }\n\t\t\t>\n\t\t\t\t{ ! isEditing && ( href ? <a href={ href }>{ img }</a> : img ) }\n\t\t\t\t{ isEditing && (\n\t\t\t\t\t<MediaPlaceholder\n\t\t\t\t\t\tlabels={ { title: __( 'Edit gallery image' ) } }\n\t\t\t\t\t\ticon={ imageIcon }\n\t\t\t\t\t\tonSelect={ this.onSelectImageFromLibrary }\n\t\t\t\t\t\tonSelectURL={ this.onSelectCustomURL }\n\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\tallowedTypes={ [ 'image' ] }\n\t\t\t\t\t\tvalue={ { id, src: url } }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t<ButtonGroup className=\"block-library-gallery-item__inline-menu is-left\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ticon={ chevronLeft }\n\t\t\t\t\t\tonClick={ isFirstItem ? undefined : onMoveBackward }\n\t\t\t\t\t\tlabel={ __( 'Move image backward' ) }\n\t\t\t\t\t\taria-disabled={ isFirstItem }\n\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\ticon={ chevronRight }\n\t\t\t\t\t\tonClick={ isLastItem ? undefined : onMoveForward }\n\t\t\t\t\t\tlabel={ __( 'Move image forward' ) }\n\t\t\t\t\t\taria-disabled={ isLastItem }\n\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t/>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t<ButtonGroup className=\"block-library-gallery-item__inline-menu is-right\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ticon={ edit }\n\t\t\t\t\t\tonClick={ this.onEdit }\n\t\t\t\t\t\tlabel={ __( 'Replace image' ) }\n\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\ticon={ closeSmall }\n\t\t\t\t\t\tonClick={ onRemove }\n\t\t\t\t\t\tlabel={ __( 'Remove image' ) }\n\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t/>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t{ ! isEditing && ( isSelected || caption ) && (\n\t\t\t\t\t<RichText\n\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\tclassName={ __experimentalGetElementClassName(\n\t\t\t\t\t\t\t'caption'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\taria-label={ __( 'Image caption text' ) }\n\t\t\t\t\t\tplaceholder={ isSelected ? __( 'Add caption' ) : null }\n\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\tonChange={ ( newCaption ) =>\n\t\t\t\t\t\t\tsetAttributes( { caption: newCaption } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinlineToolbar\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</figure>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, ownProps ) => {\n\t\tconst { getMedia } = select( coreStore );\n\t\tconst { id } = ownProps;\n\n\t\treturn {\n\t\t\timage: id ? getMedia( parseInt( id, 10 ) ) : null,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { __unstableMarkNextChangeAsNotPersistent } =\n\t\t\tdispatch( blockEditorStore );\n\t\treturn {\n\t\t\t__unstableMarkNextChangeAsNotPersistent,\n\t\t};\n\t} ),\n] )( GalleryImage );\n"]}