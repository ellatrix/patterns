{"version":3,"sources":["@wordpress/block-library/src/file/transforms.js"],"names":["transforms","from","type","isMatch","files","length","priority","transform","blocks","forEach","file","blobURL","push","href","fileName","name","textLinkHref","attributes","src","caption","id","anchor","url","to","getMedia","coreStore","media","mime_type","includes"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createBlobURL } from '@wordpress/blob';\nimport { createBlock } from '@wordpress/blocks';\nimport { select } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { getFilename } from '@wordpress/url';\n\nconst transforms = {\n\tfrom: [\n\t\t{\n\t\t\ttype: 'files',\n\t\t\tisMatch( files ) {\n\t\t\t\treturn files.length > 0;\n\t\t\t},\n\t\t\t// We define a lower priorty (higher number) than the default of 10. This\n\t\t\t// ensures that the File block is only created as a fallback.\n\t\t\tpriority: 15,\n\t\t\ttransform: ( files ) => {\n\t\t\t\tconst blocks = [];\n\n\t\t\t\tfiles.forEach( ( file ) => {\n\t\t\t\t\tconst blobURL = createBlobURL( file );\n\n\t\t\t\t\t// File will be uploaded in componentDidMount()\n\t\t\t\t\tblocks.push(\n\t\t\t\t\t\tcreateBlock( 'core/file', {\n\t\t\t\t\t\t\thref: blobURL,\n\t\t\t\t\t\t\tfileName: file.name,\n\t\t\t\t\t\t\ttextLinkHref: blobURL,\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t} );\n\n\t\t\t\treturn blocks;\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/audio' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/file', {\n\t\t\t\t\thref: attributes.src,\n\t\t\t\t\tfileName: attributes.caption,\n\t\t\t\t\ttextLinkHref: attributes.src,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t\tanchor: attributes.anchor,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/video' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/file', {\n\t\t\t\t\thref: attributes.src,\n\t\t\t\t\tfileName: attributes.caption,\n\t\t\t\t\ttextLinkHref: attributes.src,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t\tanchor: attributes.anchor,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/image' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/file', {\n\t\t\t\t\thref: attributes.url,\n\t\t\t\t\tfileName:\n\t\t\t\t\t\tattributes.caption || getFilename( attributes.url ),\n\t\t\t\t\ttextLinkHref: attributes.url,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t\tanchor: attributes.anchor,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t],\n\tto: [\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/audio' ],\n\t\t\tisMatch: ( { id } ) => {\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { getMedia } = select( coreStore );\n\t\t\t\tconst media = getMedia( id );\n\t\t\t\treturn !! media && media.mime_type.includes( 'audio' );\n\t\t\t},\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/audio', {\n\t\t\t\t\tsrc: attributes.href,\n\t\t\t\t\tcaption: attributes.fileName,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t\tanchor: attributes.anchor,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/video' ],\n\t\t\tisMatch: ( { id } ) => {\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { getMedia } = select( coreStore );\n\t\t\t\tconst media = getMedia( id );\n\t\t\t\treturn !! media && media.mime_type.includes( 'video' );\n\t\t\t},\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/video', {\n\t\t\t\t\tsrc: attributes.href,\n\t\t\t\t\tcaption: attributes.fileName,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t\tanchor: attributes.anchor,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/image' ],\n\t\t\tisMatch: ( { id } ) => {\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { getMedia } = select( coreStore );\n\t\t\t\tconst media = getMedia( id );\n\t\t\t\treturn !! media && media.mime_type.includes( 'image' );\n\t\t\t},\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\treturn createBlock( 'core/image', {\n\t\t\t\t\turl: attributes.href,\n\t\t\t\t\tcaption: attributes.fileName,\n\t\t\t\t\tid: attributes.id,\n\t\t\t\t\tanchor: attributes.anchor,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t],\n};\n\nexport default transforms;\n"]}