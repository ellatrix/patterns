{"version":3,"sources":["@wordpress/viewport/src/listener.js"],"names":["addDimensionsEventListener","breakpoints","operators","setIsMatching","values","Object","fromEntries","queries","map","key","query","matches","store","leading","operatorEntries","entries","flatMap","name","width","operator","condition","list","window","matchMedia","addEventListener","flush"],"mappings":";;;;;;;AAGA;;AACA;;AAKA;;AATA;AACA;AACA;;AAIA;AACA;AACA;AAGA,MAAMA,0BAA0B,GAAG,CAAEC,WAAF,EAAeC,SAAf,KAA8B;AAChE;AACD;AACA;AACA;AACC,QAAMC,aAAa,GAAG,uBACrB,MAAM;AACL,UAAMC,MAAM,GAAGC,MAAM,CAACC,WAAP,CACdC,OAAO,CAACC,GAAR,CAAa;AAAA,UAAE,CAAEC,GAAF,EAAOC,KAAP,CAAF;AAAA,aAAsB,CAAED,GAAF,EAAOC,KAAK,CAACC,OAAb,CAAtB;AAAA,KAAb,CADc,CAAf;AAGA,wBAAUC,YAAV,EAAkBT,aAAlB,CAAiCC,MAAjC;AACA,GANoB,EAOrB,CAPqB,EAQrB;AAAES,IAAAA,OAAO,EAAE;AAAX,GARqB,CAAtB;AAWA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACC,QAAMC,eAAe,GAAGT,MAAM,CAACU,OAAP,CAAgBb,SAAhB,CAAxB;AACA,QAAMK,OAAO,GAAGF,MAAM,CAACU,OAAP,CAAgBd,WAAhB,EAA8Be,OAA9B,CACf,SAAuB;AAAA,QAArB,CAAEC,IAAF,EAAQC,KAAR,CAAqB;AACtB,WAAOJ,eAAe,CAACN,GAAhB,CAAqB,SAA+B;AAAA,UAA7B,CAAEW,QAAF,EAAYC,SAAZ,CAA6B;AAC1D,YAAMC,IAAI,GAAGC,MAAM,CAACC,UAAP,CACX,IAAIH,SAAW,KAAKF,KAAO,KADhB,CAAb;AAGAG,MAAAA,IAAI,CAACG,gBAAL,CAAuB,QAAvB,EAAiCrB,aAAjC;AACA,aAAO,CAAG,GAAGgB,QAAU,IAAIF,IAAM,EAA1B,EAA6BI,IAA7B,CAAP;AACA,KANM,CAAP;AAOA,GATc,CAAhB;AAYAC,EAAAA,MAAM,CAACE,gBAAP,CAAyB,mBAAzB,EAA8CrB,aAA9C,EAtCgE,CAwChE;;AACAA,EAAAA,aAAa;AACbA,EAAAA,aAAa,CAACsB,KAAd;AACA,CA3CD;;eA6CezB,0B","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { debounce } from '@wordpress/compose';\nimport { dispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { store } from './store';\n\nconst addDimensionsEventListener = ( breakpoints, operators ) => {\n\t/**\n\t * Callback invoked when media query state should be updated. Is invoked a\n\t * maximum of one time per call stack.\n\t */\n\tconst setIsMatching = debounce(\n\t\t() => {\n\t\t\tconst values = Object.fromEntries(\n\t\t\t\tqueries.map( ( [ key, query ] ) => [ key, query.matches ] )\n\t\t\t);\n\t\t\tdispatch( store ).setIsMatching( values );\n\t\t},\n\t\t0,\n\t\t{ leading: true }\n\t);\n\n\t/**\n\t * Hash of breakpoint names with generated MediaQueryList for corresponding\n\t * media query.\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList\n\t *\n\t * @type {Object<string,MediaQueryList>}\n\t */\n\tconst operatorEntries = Object.entries( operators );\n\tconst queries = Object.entries( breakpoints ).flatMap(\n\t\t( [ name, width ] ) => {\n\t\t\treturn operatorEntries.map( ( [ operator, condition ] ) => {\n\t\t\t\tconst list = window.matchMedia(\n\t\t\t\t\t`(${ condition }: ${ width }px)`\n\t\t\t\t);\n\t\t\t\tlist.addEventListener( 'change', setIsMatching );\n\t\t\t\treturn [ `${ operator } ${ name }`, list ];\n\t\t\t} );\n\t\t}\n\t);\n\n\twindow.addEventListener( 'orientationchange', setIsMatching );\n\n\t// Set initial values.\n\tsetIsMatching();\n\tsetIsMatching.flush();\n};\n\nexport default addDimensionsEventListener;\n"]}