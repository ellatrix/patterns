{"version":3,"sources":["@wordpress/block-editor/src/components/rich-text/use-undo-automatic-change.js"],"names":["useUndoAutomaticChange","didAutomaticChange","getSettings","blockEditorStore","element","onKeyDown","event","keyCode","defaultPrevented","DELETE","BACKSPACE","ESCAPE","__experimentalUndo","preventDefault","addEventListener","removeEventListener"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;AAKA;;AAVA;AACA;AACA;;AAKA;AACA;AACA;AAGO,SAASA,sBAAT,GAAkC;AACxC,QAAM;AAAEC,IAAAA,kBAAF;AAAsBC,IAAAA;AAAtB,MAAsC,qBAAWC,YAAX,CAA5C;AACA,SAAO,2BAAgBC,OAAF,IAAe;AACnC,aAASC,SAAT,CAAoBC,KAApB,EAA4B;AAC3B,YAAM;AAAEC,QAAAA;AAAF,UAAcD,KAApB;;AAEA,UAAKA,KAAK,CAACE,gBAAX,EAA8B;AAC7B;AACA;;AAED,UACCD,OAAO,KAAKE,gBAAZ,IACAF,OAAO,KAAKG,mBADZ,IAEAH,OAAO,KAAKI,gBAHb,EAIE;AACD;AACA;;AAED,YAAM;AAAEC,QAAAA;AAAF,UAAyBV,WAAW,EAA1C;;AAEA,UAAK,CAAEU,kBAAP,EAA4B;AAC3B;AACA;;AAED,UAAK,CAAEX,kBAAkB,EAAzB,EAA8B;AAC7B;AACA;;AAEDK,MAAAA,KAAK,CAACO,cAAN;;AACAD,MAAAA,kBAAkB;AAClB;;AAEDR,IAAAA,OAAO,CAACU,gBAAR,CAA0B,SAA1B,EAAqCT,SAArC;AACA,WAAO,MAAM;AACZD,MAAAA,OAAO,CAACW,mBAAR,CAA6B,SAA7B,EAAwCV,SAAxC;AACA,KAFD;AAGA,GAlCM,EAkCJ,EAlCI,CAAP;AAmCA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { useRefEffect } from '@wordpress/compose';\nimport { BACKSPACE, DELETE, ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../store';\n\nexport function useUndoAutomaticChange() {\n\tconst { didAutomaticChange, getSettings } = useSelect( blockEditorStore );\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onKeyDown( event ) {\n\t\t\tconst { keyCode } = event;\n\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tkeyCode !== DELETE &&\n\t\t\t\tkeyCode !== BACKSPACE &&\n\t\t\t\tkeyCode !== ESCAPE\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { __experimentalUndo } = getSettings();\n\n\t\t\tif ( ! __experimentalUndo ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( ! didAutomaticChange() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t\t__experimentalUndo();\n\t\t}\n\n\t\telement.addEventListener( 'keydown', onKeyDown );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [] );\n}\n"]}