{"version":3,"sources":["@wordpress/block-editor/src/components/media-upload/index.native.js"],"names":["Platform","prompt","Component","React","__","Picker","getOtherMediaOptions","requestMediaPicker","mediaSources","capturePhoto","captureVideo","image","wordpress","mobile","globe","store","blockEditorStore","compose","withSelect","MEDIA_TYPE_IMAGE","MEDIA_TYPE_VIDEO","MEDIA_TYPE_AUDIO","MEDIA_TYPE_ANY","OPTION_TAKE_VIDEO","OPTION_TAKE_PHOTO","OPTION_TAKE_PHOTO_OR_VIDEO","OPTION_INSERT_FROM_URL","OPTION_WORDPRESS_MEDIA_LIBRARY","URL_MEDIA_SOURCE","PICKER_OPENING_DELAY","MediaUpload","pickerTimeout","constructor","props","onPickerPresent","bind","onPickerSelect","getAllSources","state","otherMediaOptions","componentDidMount","allowedTypes","autoOpen","otherMediaOptionsWithIcons","map","option","requiresModal","types","id","value","setState","componentWillUnmount","clearTimeout","onSelectURL","cameraImageSource","deviceCamera","label","icon","cameraVideoSource","deviceLibrarySource","deviceLibrary","siteLibrarySource","siteMediaLibrary","mediaLibrary","urlSource","internalSources","concat","getMediaOptionsItems","__experimentalOnlyMediaLibrary","isAudioBlockMediaUploadEnabled","filter","source","every","allowedType","includes","some","getChooseFromDeviceIcon","isIOS","OS","picker","setTimeout","presentPicker","onSelect","multiple","undefined","text","style","onPress","mediaSource","shift","type","media","render","isReplacingMedia","isOneType","length","isImage","isVideo","isAudio","isAnyType","isImageOrVideo","pickerTitle","getMediaOptions","instance","open","select","capabilities","getSettings"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Platform } from 'react-native';\n\nimport prompt from 'react-native-prompt-android';\n\n/**\n * WordPress dependencies\n */\nimport { Component, React } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { Picker } from '@wordpress/components';\nimport {\n\tgetOtherMediaOptions,\n\trequestMediaPicker,\n\tmediaSources,\n} from '@wordpress/react-native-bridge';\nimport {\n\tcapturePhoto,\n\tcaptureVideo,\n\timage,\n\twordpress,\n\tmobile,\n\tglobe,\n} from '@wordpress/icons';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { compose } from '@wordpress/compose';\nimport { withSelect } from '@wordpress/data';\n\nexport const MEDIA_TYPE_IMAGE = 'image';\nexport const MEDIA_TYPE_VIDEO = 'video';\nexport const MEDIA_TYPE_AUDIO = 'audio';\nexport const MEDIA_TYPE_ANY = 'any';\n\nexport const OPTION_TAKE_VIDEO = __( 'Take a Video' );\nexport const OPTION_TAKE_PHOTO = __( 'Take a Photo' );\nexport const OPTION_TAKE_PHOTO_OR_VIDEO = __( 'Take a Photo or Video' );\nexport const OPTION_INSERT_FROM_URL = __( 'Insert from URL' );\nexport const OPTION_WORDPRESS_MEDIA_LIBRARY = __( 'WordPress Media Library' );\n\nconst URL_MEDIA_SOURCE = 'URL';\n\nconst PICKER_OPENING_DELAY = 200;\n\nexport class MediaUpload extends Component {\n\tpickerTimeout;\n\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.onPickerPresent = this.onPickerPresent.bind( this );\n\t\tthis.onPickerSelect = this.onPickerSelect.bind( this );\n\t\tthis.getAllSources = this.getAllSources.bind( this );\n\t\tthis.state = {\n\t\t\totherMediaOptions: [],\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { allowedTypes = [], autoOpen } = this.props;\n\t\tgetOtherMediaOptions( allowedTypes, ( otherMediaOptions ) => {\n\t\t\tconst otherMediaOptionsWithIcons = otherMediaOptions.map(\n\t\t\t\t( option ) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...option,\n\t\t\t\t\t\trequiresModal: true,\n\t\t\t\t\t\ttypes: allowedTypes,\n\t\t\t\t\t\tid: option.value,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.setState( { otherMediaOptions: otherMediaOptionsWithIcons } );\n\t\t} );\n\n\t\tif ( autoOpen ) {\n\t\t\tthis.onPickerPresent();\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout( this.pickerTimeout );\n\t}\n\n\tgetAllSources() {\n\t\tconst { onSelectURL } = this.props;\n\n\t\tconst cameraImageSource = {\n\t\t\tid: mediaSources.deviceCamera, // ID is the value sent to native.\n\t\t\tvalue: mediaSources.deviceCamera + '-IMAGE', // This is needed to diferenciate image-camera from video-camera sources.\n\t\t\tlabel: __( 'Take a Photo' ),\n\t\t\trequiresModal: true,\n\t\t\ttypes: [ MEDIA_TYPE_IMAGE ],\n\t\t\ticon: capturePhoto,\n\t\t};\n\n\t\tconst cameraVideoSource = {\n\t\t\tid: mediaSources.deviceCamera,\n\t\t\tvalue: mediaSources.deviceCamera,\n\t\t\tlabel: __( 'Take a Video' ),\n\t\t\trequiresModal: true,\n\t\t\ttypes: [ MEDIA_TYPE_VIDEO ],\n\t\t\ticon: captureVideo,\n\t\t};\n\n\t\tconst deviceLibrarySource = {\n\t\t\tid: mediaSources.deviceLibrary,\n\t\t\tvalue: mediaSources.deviceLibrary,\n\t\t\tlabel: __( 'Choose from device' ),\n\t\t\trequiresModal: true,\n\t\t\ttypes: [ MEDIA_TYPE_IMAGE, MEDIA_TYPE_VIDEO ],\n\t\t\ticon: image,\n\t\t};\n\n\t\tconst siteLibrarySource = {\n\t\t\tid: mediaSources.siteMediaLibrary,\n\t\t\tvalue: mediaSources.siteMediaLibrary,\n\t\t\tlabel: __( 'WordPress Media Library' ),\n\t\t\trequiresModal: true,\n\t\t\ttypes: [\n\t\t\t\tMEDIA_TYPE_IMAGE,\n\t\t\t\tMEDIA_TYPE_VIDEO,\n\t\t\t\tMEDIA_TYPE_AUDIO,\n\t\t\t\tMEDIA_TYPE_ANY,\n\t\t\t],\n\t\t\ticon: wordpress,\n\t\t\tmediaLibrary: true,\n\t\t};\n\n\t\tconst urlSource = {\n\t\t\tid: URL_MEDIA_SOURCE,\n\t\t\tvalue: URL_MEDIA_SOURCE,\n\t\t\tlabel: __( 'Insert from URL' ),\n\t\t\ttypes: [ MEDIA_TYPE_AUDIO, MEDIA_TYPE_IMAGE, MEDIA_TYPE_VIDEO ],\n\t\t\ticon: globe,\n\t\t};\n\n\t\t// Only include `urlSource` option if `onSelectURL` prop is present, in order to match the web behavior.\n\t\tconst internalSources = [\n\t\t\tdeviceLibrarySource,\n\t\t\tcameraImageSource,\n\t\t\tcameraVideoSource,\n\t\t\tsiteLibrarySource,\n\t\t\t...( onSelectURL ? [ urlSource ] : [] ),\n\t\t];\n\n\t\treturn internalSources.concat( this.state.otherMediaOptions );\n\t}\n\n\tgetMediaOptionsItems() {\n\t\tconst {\n\t\t\tallowedTypes = [],\n\t\t\t__experimentalOnlyMediaLibrary,\n\t\t\tisAudioBlockMediaUploadEnabled,\n\t\t} = this.props;\n\n\t\treturn this.getAllSources()\n\t\t\t.filter( ( source ) => {\n\t\t\t\tif ( __experimentalOnlyMediaLibrary ) {\n\t\t\t\t\treturn source.mediaLibrary;\n\t\t\t\t} else if (\n\t\t\t\t\tallowedTypes.every(\n\t\t\t\t\t\t( allowedType ) =>\n\t\t\t\t\t\t\tallowedType === MEDIA_TYPE_AUDIO &&\n\t\t\t\t\t\t\tsource.types.includes( allowedType )\n\t\t\t\t\t) &&\n\t\t\t\t\tsource.id !== URL_MEDIA_SOURCE\n\t\t\t\t) {\n\t\t\t\t\treturn isAudioBlockMediaUploadEnabled === true;\n\t\t\t\t}\n\n\t\t\t\treturn allowedTypes.some( ( allowedType ) =>\n\t\t\t\t\tsource.types.includes( allowedType )\n\t\t\t\t);\n\t\t\t} )\n\t\t\t.map( ( source ) => {\n\t\t\t\treturn {\n\t\t\t\t\t...source,\n\t\t\t\t\ticon: source.icon || this.getChooseFromDeviceIcon(),\n\t\t\t\t};\n\t\t\t} );\n\t}\n\n\tgetChooseFromDeviceIcon() {\n\t\treturn mobile;\n\t}\n\n\tonPickerPresent() {\n\t\tconst { autoOpen } = this.props;\n\t\tconst isIOS = Platform.OS === 'ios';\n\n\t\tif ( this.picker ) {\n\t\t\t// the delay below is required because on iOS this action sheet gets dismissed by the close event of the Inserter\n\t\t\t// so this delay allows the Inserter to be closed fully before presenting action sheet.\n\t\t\tif ( autoOpen && isIOS ) {\n\t\t\t\tthis.pickerTimeout = setTimeout(\n\t\t\t\t\t() => this.picker.presentPicker(),\n\t\t\t\t\tPICKER_OPENING_DELAY\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.picker.presentPicker();\n\t\t\t}\n\t\t}\n\t}\n\n\tonPickerSelect( value ) {\n\t\tconst {\n\t\t\tallowedTypes = [],\n\t\t\tonSelect,\n\t\t\tonSelectURL,\n\t\t\tmultiple = false,\n\t\t} = this.props;\n\n\t\tif ( value === URL_MEDIA_SOURCE ) {\n\t\t\tprompt(\n\t\t\t\t__( 'Type a URL' ), // title\n\t\t\t\tundefined, // message\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: __( 'Cancel' ),\n\t\t\t\t\t\tstyle: 'cancel',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: __( 'Apply' ),\n\t\t\t\t\t\tonPress: onSelectURL,\n\t\t\t\t\t},\n\t\t\t\t], // Buttons.\n\t\t\t\t'plain-text', // type\n\t\t\t\tundefined, // defaultValue\n\t\t\t\t'url' // keyboardType\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst mediaSource = this.getAllSources()\n\t\t\t.filter( ( source ) => source.value === value )\n\t\t\t.shift();\n\t\tconst types = allowedTypes.filter( ( type ) =>\n\t\t\tmediaSource.types.includes( type )\n\t\t);\n\n\t\trequestMediaPicker( mediaSource.id, types, multiple, ( media ) => {\n\t\t\tif ( ( multiple && media ) || ( media && media.id ) ) {\n\t\t\t\tonSelect( media );\n\t\t\t}\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { allowedTypes = [], isReplacingMedia, multiple } = this.props;\n\t\tconst isOneType = allowedTypes.length === 1;\n\t\tconst isImage = isOneType && allowedTypes.includes( MEDIA_TYPE_IMAGE );\n\t\tconst isVideo = isOneType && allowedTypes.includes( MEDIA_TYPE_VIDEO );\n\t\tconst isAudio = isOneType && allowedTypes.includes( MEDIA_TYPE_AUDIO );\n\t\tconst isAnyType = isOneType && allowedTypes.includes( MEDIA_TYPE_ANY );\n\n\t\tconst isImageOrVideo =\n\t\t\tallowedTypes.length === 2 &&\n\t\t\tallowedTypes.includes( MEDIA_TYPE_IMAGE ) &&\n\t\t\tallowedTypes.includes( MEDIA_TYPE_VIDEO );\n\n\t\tlet pickerTitle;\n\t\tif ( isImage ) {\n\t\t\tif ( isReplacingMedia ) {\n\t\t\t\tpickerTitle = __( 'Replace image' );\n\t\t\t} else {\n\t\t\t\tpickerTitle = multiple\n\t\t\t\t\t? __( 'Choose images' )\n\t\t\t\t\t: __( 'Choose image' );\n\t\t\t}\n\t\t} else if ( isVideo ) {\n\t\t\tif ( isReplacingMedia ) {\n\t\t\t\tpickerTitle = __( 'Replace video' );\n\t\t\t} else {\n\t\t\t\tpickerTitle = __( 'Choose video' );\n\t\t\t}\n\t\t} else if ( isImageOrVideo ) {\n\t\t\tif ( isReplacingMedia ) {\n\t\t\t\tpickerTitle = __( 'Replace image or video' );\n\t\t\t} else {\n\t\t\t\tpickerTitle = __( 'Choose image or video' );\n\t\t\t}\n\t\t} else if ( isAudio ) {\n\t\t\tif ( isReplacingMedia ) {\n\t\t\t\tpickerTitle = __( 'Replace audio' );\n\t\t\t} else {\n\t\t\t\tpickerTitle = __( 'Choose audio' );\n\t\t\t}\n\t\t} else if ( isAnyType ) {\n\t\t\tpickerTitle = __( 'Choose file' );\n\t\t\tif ( isReplacingMedia ) {\n\t\t\t\tpickerTitle = __( 'Replace file' );\n\t\t\t} else {\n\t\t\t\tpickerTitle = __( 'Choose file' );\n\t\t\t}\n\t\t}\n\n\t\tconst getMediaOptions = () => (\n\t\t\t<Picker\n\t\t\t\ttitle={ pickerTitle }\n\t\t\t\thideCancelButton\n\t\t\t\tref={ ( instance ) => ( this.picker = instance ) }\n\t\t\t\toptions={ this.getMediaOptionsItems() }\n\t\t\t\tonChange={ this.onPickerSelect }\n\t\t\t\ttestID=\"media-options-picker\"\n\t\t\t/>\n\t\t);\n\n\t\treturn this.props.render( {\n\t\t\topen: this.onPickerPresent,\n\t\t\tgetMediaOptions,\n\t\t} );\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { capabilities } = select( blockEditorStore ).getSettings();\n\t\treturn {\n\t\t\tisAudioBlockMediaUploadEnabled:\n\t\t\t\tcapabilities?.isAudioBlockMediaUploadEnabled === true,\n\t\t};\n\t} ),\n] )( MediaUpload );\n"]}