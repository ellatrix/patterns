{"version":3,"sources":["@wordpress/block-editor/src/components/rich-text/format-edit.js"],"names":["getActiveFormat","getActiveObject","isCollapsed","FormatEdit","formatTypes","onChange","onFocus","value","forwardedRef","map","settings","name","edit","Edit","activeFormat","isActive","undefined","activeObject","isObjectActive","type","formats","linkFormatAtStart","start","find","linkFormatAtEnd","end","attributes"],"mappings":";;AAAA;AACA;AACA;AACA,SACCA,eADD,EAECC,eAFD,EAGCC,WAHD,QAIO,sBAJP;AAMA,eAAe,SAASC,UAAT,OAMX;AAAA,MANgC;AACnCC,IAAAA,WADmC;AAEnCC,IAAAA,QAFmC;AAGnCC,IAAAA,OAHmC;AAInCC,IAAAA,KAJmC;AAKnCC,IAAAA;AALmC,GAMhC;AACH,SAAOJ,WAAW,CAACK,GAAZ,CAAmBC,QAAF,IAAgB;AACvC,UAAM;AAAEC,MAAAA,IAAF;AAAQC,MAAAA,IAAI,EAAEC;AAAd,QAAuBH,QAA7B;;AAEA,QAAK,CAAEG,IAAP,EAAc;AACb,aAAO,IAAP;AACA;;AAED,UAAMC,YAAY,GAAGd,eAAe,CAAEO,KAAF,EAASI,IAAT,CAApC;AACA,QAAII,QAAQ,GAAGD,YAAY,KAAKE,SAAhC;AACA,UAAMC,YAAY,GAAGhB,eAAe,CAAEM,KAAF,CAApC;AACA,UAAMW,cAAc,GACnBD,YAAY,KAAKD,SAAjB,IAA8BC,YAAY,CAACE,IAAb,KAAsBR,IADrD,CAVuC,CAavC;AACA;AACA;AACA;AACA;AACA;;AACA,QAAKA,IAAI,KAAK,WAAT,IAAwB,CAAET,WAAW,CAAEK,KAAF,CAA1C,EAAsD;AAAA;;AACrD,YAAMa,OAAO,GAAGb,KAAK,CAACa,OAAtB;AAEA,YAAMC,iBAAiB,2BAAGD,OAAO,CAAEb,KAAK,CAACe,KAAR,CAAV,yDAAG,qBAAwBC,IAAxB,CACzB;AAAA,YAAE;AAAEJ,UAAAA;AAAF,SAAF;AAAA,eAAgBA,IAAI,KAAK,WAAzB;AAAA,OADyB,CAA1B;AAIA,YAAMK,eAAe,eAAGJ,OAAO,CAAEb,KAAK,CAACkB,GAAN,GAAY,CAAd,CAAV,6CAAG,SAA0BF,IAA1B,CACvB;AAAA,YAAE;AAAEJ,UAAAA;AAAF,SAAF;AAAA,eAAgBA,IAAI,KAAK,WAAzB;AAAA,OADuB,CAAxB;;AAIA,UACC,CAAEE,iBAAF,IACA,CAAEG,eADF,IAEAH,iBAAiB,KAAKG,eAHvB,EAIE;AACDT,QAAAA,QAAQ,GAAG,KAAX;AACA;AACD;;AAED,WACC,cAAC,IAAD;AACC,MAAA,GAAG,EAAGJ,IADP;AAEC,MAAA,QAAQ,EAAGI,QAFZ;AAGC,MAAA,gBAAgB,EACfA,QAAQ,GAAGD,YAAY,CAACY,UAAb,IAA2B,EAA9B,GAAmC,EAJ7C;AAMC,MAAA,cAAc,EAAGR,cANlB;AAOC,MAAA,sBAAsB,EACrBA,cAAc,GAAGD,YAAY,CAACS,UAAb,IAA2B,EAA9B,GAAmC,EARnD;AAUC,MAAA,KAAK,EAAGnB,KAVT;AAWC,MAAA,QAAQ,EAAGF,QAXZ;AAYC,MAAA,OAAO,EAAGC,OAZX;AAaC,MAAA,UAAU,EAAGE;AAbd,MADD;AAiBA,GAxDM,CAAP;AAyDA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tgetActiveFormat,\n\tgetActiveObject,\n\tisCollapsed,\n} from '@wordpress/rich-text';\n\nexport default function FormatEdit( {\n\tformatTypes,\n\tonChange,\n\tonFocus,\n\tvalue,\n\tforwardedRef,\n} ) {\n\treturn formatTypes.map( ( settings ) => {\n\t\tconst { name, edit: Edit } = settings;\n\n\t\tif ( ! Edit ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst activeFormat = getActiveFormat( value, name );\n\t\tlet isActive = activeFormat !== undefined;\n\t\tconst activeObject = getActiveObject( value );\n\t\tconst isObjectActive =\n\t\t\tactiveObject !== undefined && activeObject.type === name;\n\n\t\t// Edge case: un-collapsed link formats.\n\t\t// If there is a missing link format at either end of the selection\n\t\t// then we shouldn't show the Edit UI because the selection has exceeded\n\t\t// the bounds of the link format.\n\t\t// Also if the format objects don't match then we're dealing with two separate\n\t\t// links so we should not allow the link to be modified over the top.\n\t\tif ( name === 'core/link' && ! isCollapsed( value ) ) {\n\t\t\tconst formats = value.formats;\n\n\t\t\tconst linkFormatAtStart = formats[ value.start ]?.find(\n\t\t\t\t( { type } ) => type === 'core/link'\n\t\t\t);\n\n\t\t\tconst linkFormatAtEnd = formats[ value.end - 1 ]?.find(\n\t\t\t\t( { type } ) => type === 'core/link'\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\t! linkFormatAtStart ||\n\t\t\t\t! linkFormatAtEnd ||\n\t\t\t\tlinkFormatAtStart !== linkFormatAtEnd\n\t\t\t) {\n\t\t\t\tisActive = false;\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<Edit\n\t\t\t\tkey={ name }\n\t\t\t\tisActive={ isActive }\n\t\t\t\tactiveAttributes={\n\t\t\t\t\tisActive ? activeFormat.attributes || {} : {}\n\t\t\t\t}\n\t\t\t\tisObjectActive={ isObjectActive }\n\t\t\t\tactiveObjectAttributes={\n\t\t\t\t\tisObjectActive ? activeObject.attributes || {} : {}\n\t\t\t\t}\n\t\t\t\tvalue={ value }\n\t\t\t\tonChange={ onChange }\n\t\t\t\tonFocus={ onFocus }\n\t\t\t\tcontentRef={ forwardedRef }\n\t\t\t/>\n\t\t);\n\t} );\n}\n"]}