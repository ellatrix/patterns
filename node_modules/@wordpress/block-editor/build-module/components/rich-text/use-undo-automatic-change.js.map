{"version":3,"sources":["@wordpress/block-editor/src/components/rich-text/use-undo-automatic-change.js"],"names":["useSelect","useRefEffect","BACKSPACE","DELETE","ESCAPE","store","blockEditorStore","useUndoAutomaticChange","didAutomaticChange","getSettings","element","onKeyDown","event","keyCode","defaultPrevented","__experimentalUndo","preventDefault","addEventListener","removeEventListener"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAT,QAA0B,iBAA1B;AACA,SAASC,YAAT,QAA6B,oBAA7B;AACA,SAASC,SAAT,EAAoBC,MAApB,EAA4BC,MAA5B,QAA0C,qBAA1C;AAEA;AACA;AACA;;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,aAA1C;AAEA,OAAO,SAASC,sBAAT,GAAkC;AACxC,QAAM;AAAEC,IAAAA,kBAAF;AAAsBC,IAAAA;AAAtB,MAAsCT,SAAS,CAAEM,gBAAF,CAArD;AACA,SAAOL,YAAY,CAAIS,OAAF,IAAe;AACnC,aAASC,SAAT,CAAoBC,KAApB,EAA4B;AAC3B,YAAM;AAAEC,QAAAA;AAAF,UAAcD,KAApB;;AAEA,UAAKA,KAAK,CAACE,gBAAX,EAA8B;AAC7B;AACA;;AAED,UACCD,OAAO,KAAKV,MAAZ,IACAU,OAAO,KAAKX,SADZ,IAEAW,OAAO,KAAKT,MAHb,EAIE;AACD;AACA;;AAED,YAAM;AAAEW,QAAAA;AAAF,UAAyBN,WAAW,EAA1C;;AAEA,UAAK,CAAEM,kBAAP,EAA4B;AAC3B;AACA;;AAED,UAAK,CAAEP,kBAAkB,EAAzB,EAA8B;AAC7B;AACA;;AAEDI,MAAAA,KAAK,CAACI,cAAN;;AACAD,MAAAA,kBAAkB;AAClB;;AAEDL,IAAAA,OAAO,CAACO,gBAAR,CAA0B,SAA1B,EAAqCN,SAArC;AACA,WAAO,MAAM;AACZD,MAAAA,OAAO,CAACQ,mBAAR,CAA6B,SAA7B,EAAwCP,SAAxC;AACA,KAFD;AAGA,GAlCkB,EAkChB,EAlCgB,CAAnB;AAmCA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { useRefEffect } from '@wordpress/compose';\nimport { BACKSPACE, DELETE, ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../store';\n\nexport function useUndoAutomaticChange() {\n\tconst { didAutomaticChange, getSettings } = useSelect( blockEditorStore );\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onKeyDown( event ) {\n\t\t\tconst { keyCode } = event;\n\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tkeyCode !== DELETE &&\n\t\t\t\tkeyCode !== BACKSPACE &&\n\t\t\t\tkeyCode !== ESCAPE\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { __experimentalUndo } = getSettings();\n\n\t\t\tif ( ! __experimentalUndo ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( ! didAutomaticChange() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t\t__experimentalUndo();\n\t\t}\n\n\t\telement.addEventListener( 'keydown', onKeyDown );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [] );\n}\n"]}