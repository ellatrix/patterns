{"version":3,"sources":["@wordpress/block-editor/src/components/block-selection-clearer/index.js"],"names":["useSelect","useDispatch","useRefEffect","store","blockEditorStore","useBlockSelectionClearer","getSettings","hasSelectedBlock","hasMultiSelection","clearSelectedBlock","clearBlockSelection","isEnabled","node","onMouseDown","event","target","addEventListener","removeEventListener","BlockSelectionClearer","props"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,SAAT,EAAoBC,WAApB,QAAuC,iBAAvC;AACA,SAASC,YAAT,QAA6B,oBAA7B;AAEA;AACA;AACA;;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,aAA1C;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,wBAAT,GAAoC;AAC1C,QAAM;AAAEC,IAAAA,WAAF;AAAeC,IAAAA,gBAAf;AAAiCC,IAAAA;AAAjC,MACLR,SAAS,CAAEI,gBAAF,CADV;AAEA,QAAM;AAAEK,IAAAA;AAAF,MAAyBR,WAAW,CAAEG,gBAAF,CAA1C;AACA,QAAM;AAAEM,IAAAA,mBAAmB,EAAEC;AAAvB,MAAqCL,WAAW,EAAtD;AAEA,SAAOJ,YAAY,CAChBU,IAAF,IAAY;AACX,QAAK,CAAED,SAAP,EAAmB;AAClB;AACA;;AAED,aAASE,WAAT,CAAsBC,KAAtB,EAA8B;AAC7B,UAAK,CAAEP,gBAAgB,EAAlB,IAAwB,CAAEC,iBAAiB,EAAhD,EAAqD;AACpD;AACA,OAH4B,CAK7B;;;AACA,UAAKM,KAAK,CAACC,MAAN,KAAiBH,IAAtB,EAA6B;AAC5B;AACA;;AAEDH,MAAAA,kBAAkB;AAClB;;AAEDG,IAAAA,IAAI,CAACI,gBAAL,CAAuB,WAAvB,EAAoCH,WAApC;AAEA,WAAO,MAAM;AACZD,MAAAA,IAAI,CAACK,mBAAL,CAA0B,WAA1B,EAAuCJ,WAAvC;AACA,KAFD;AAGA,GAxBiB,EAyBlB,CAAEN,gBAAF,EAAoBC,iBAApB,EAAuCC,kBAAvC,EAA2DE,SAA3D,CAzBkB,CAAnB;AA2BA;AAED,eAAe,SAASO,qBAAT,CAAgCC,KAAhC,EAAwC;AACtD,SAAO;AAAK,IAAA,GAAG,EAAGd,wBAAwB;AAAnC,KAA6Cc,KAA7C,EAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../store';\n\n/**\n * Pass the returned ref callback to an element that should clear block\n * selection. Selection will only be cleared if the element is clicked directly,\n * not if a child element is clicked.\n *\n * @return {import('react').RefCallback} Ref callback.\n */\nexport function useBlockSelectionClearer() {\n\tconst { getSettings, hasSelectedBlock, hasMultiSelection } =\n\t\tuseSelect( blockEditorStore );\n\tconst { clearSelectedBlock } = useDispatch( blockEditorStore );\n\tconst { clearBlockSelection: isEnabled } = getSettings();\n\n\treturn useRefEffect(\n\t\t( node ) => {\n\t\t\tif ( ! isEnabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction onMouseDown( event ) {\n\t\t\t\tif ( ! hasSelectedBlock() && ! hasMultiSelection() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Only handle clicks on the element, not the children.\n\t\t\t\tif ( event.target !== node ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearSelectedBlock();\n\t\t\t}\n\n\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\n\n\t\t\treturn () => {\n\t\t\t\tnode.removeEventListener( 'mousedown', onMouseDown );\n\t\t\t};\n\t\t},\n\t\t[ hasSelectedBlock, hasMultiSelection, clearSelectedBlock, isEnabled ]\n\t);\n}\n\nexport default function BlockSelectionClearer( props ) {\n\treturn <div ref={ useBlockSelectionClearer() } { ...props } />;\n}\n"]}