{"version":3,"sources":["@wordpress/block-editor/src/hooks/margin.js"],"names":["useMemo","useRef","useState","useEffect","isShallowEqual","BlockPopover","getSpacingPresetCssVar","MarginVisualizer","clientId","attributes","forceShow","margin","style","spacing","marginTop","top","marginRight","right","marginBottom","bottom","marginLeft","left","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","isActive","setIsActive","valueRef","timeoutRef","clearTimer","current","window","clearTimeout","setTimeout"],"mappings":";;AAAA;AACA;AACA;AACA,SAASA,OAAT,EAAkBC,MAAlB,EAA0BC,QAA1B,EAAoCC,SAApC,QAAqD,oBAArD;AACA,OAAOC,cAAP,MAA2B,6BAA3B;AAEA;AACA;AACA;;AACA,OAAOC,YAAP,MAAyB,6BAAzB;AACA,SAASC,sBAAT,QAAuC,2CAAvC;AAEA,OAAO,SAASC,gBAAT,OAAiE;AAAA;;AAAA,MAAtC;AAAEC,IAAAA,QAAF;AAAYC,IAAAA,UAAZ;AAAwBC,IAAAA;AAAxB,GAAsC;AACvE,QAAMC,MAAM,GAAGF,UAAH,aAAGA,UAAH,4CAAGA,UAAU,CAAEG,KAAf,+EAAG,kBAAmBC,OAAtB,0DAAG,sBAA4BF,MAA3C;AAEA,QAAMC,KAAK,GAAGZ,OAAO,CAAE,MAAM;AAC5B,UAAMc,SAAS,GAAGH,MAAM,SAAN,IAAAA,MAAM,WAAN,IAAAA,MAAM,CAAEI,GAAR,GACfT,sBAAsB,CAAEK,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAEI,GAAV,CADP,GAEf,CAFH;AAGA,UAAMC,WAAW,GAAGL,MAAM,SAAN,IAAAA,MAAM,WAAN,IAAAA,MAAM,CAAEM,KAAR,GACjBX,sBAAsB,CAAEK,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAEM,KAAV,CADL,GAEjB,CAFH;AAGA,UAAMC,YAAY,GAAGP,MAAM,SAAN,IAAAA,MAAM,WAAN,IAAAA,MAAM,CAAEQ,MAAR,GAClBb,sBAAsB,CAAEK,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAEQ,MAAV,CADJ,GAElB,CAFH;AAGA,UAAMC,UAAU,GAAGT,MAAM,SAAN,IAAAA,MAAM,WAAN,IAAAA,MAAM,CAAEU,IAAR,GAChBf,sBAAsB,CAAEK,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAEU,IAAV,CADN,GAEhB,CAFH;AAIA,WAAO;AACNC,MAAAA,cAAc,EAAER,SADV;AAENS,MAAAA,gBAAgB,EAAEP,WAFZ;AAGNQ,MAAAA,iBAAiB,EAAEN,YAHb;AAINO,MAAAA,eAAe,EAAEL,UAJX;AAKNL,MAAAA,GAAG,EAAED,SAAS,GAAI,QAAQA,SAAW,QAAvB,GAAiC,CALzC;AAMNG,MAAAA,KAAK,EAAED,WAAW,GAAI,QAAQA,WAAa,QAAzB,GAAmC,CAN/C;AAONG,MAAAA,MAAM,EAAED,YAAY,GAAI,QAAQA,YAAc,QAA1B,GAAoC,CAPlD;AAQNG,MAAAA,IAAI,EAAED,UAAU,GAAI,QAAQA,UAAY,QAAxB,GAAkC;AAR5C,KAAP;AAUA,GAxBoB,EAwBlB,CAAET,MAAF,CAxBkB,CAArB;AA0BA,QAAM,CAAEe,QAAF,EAAYC,WAAZ,IAA4BzB,QAAQ,CAAE,KAAF,CAA1C;AACA,QAAM0B,QAAQ,GAAG3B,MAAM,CAAEU,MAAF,CAAvB;AACA,QAAMkB,UAAU,GAAG5B,MAAM,EAAzB;;AAEA,QAAM6B,UAAU,GAAG,MAAM;AACxB,QAAKD,UAAU,CAACE,OAAhB,EAA0B;AACzBC,MAAAA,MAAM,CAACC,YAAP,CAAqBJ,UAAU,CAACE,OAAhC;AACA;AACD,GAJD;;AAMA5B,EAAAA,SAAS,CAAE,MAAM;AAChB,QAAK,CAAEC,cAAc,CAAEO,MAAF,EAAUiB,QAAQ,CAACG,OAAnB,CAAhB,IAAgD,CAAErB,SAAvD,EAAmE;AAClEiB,MAAAA,WAAW,CAAE,IAAF,CAAX;AACAC,MAAAA,QAAQ,CAACG,OAAT,GAAmBpB,MAAnB;AAEAkB,MAAAA,UAAU,CAACE,OAAX,GAAqBG,UAAU,CAAE,MAAM;AACtCP,QAAAA,WAAW,CAAE,KAAF,CAAX;AACA,OAF8B,EAE5B,GAF4B,CAA/B;AAGA;;AAED,WAAO,MAAM;AACZA,MAAAA,WAAW,CAAE,KAAF,CAAX;AACAG,MAAAA,UAAU;AACV,KAHD;AAIA,GAdQ,EAcN,CAAEnB,MAAF,EAAUD,SAAV,CAdM,CAAT;;AAgBA,MAAK,CAAEgB,QAAF,IAAc,CAAEhB,SAArB,EAAiC;AAChC,WAAO,IAAP;AACA;;AAED,SACC,cAAC,YAAD;AACC,IAAA,QAAQ,EAAGF,QADZ;AAEC,IAAA,qBAAqB,MAFtB;AAGC,IAAA,qBAAqB,EAAGG,MAHzB;AAIC,IAAA,qBAAqB,EAAC,eAJvB;AAKC,IAAA,KAAK,EAAG;AALT,KAOC;AAAK,IAAA,SAAS,EAAC,kCAAf;AAAkD,IAAA,KAAK,EAAGC;AAA1D,IAPD,CADD;AAWA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useMemo, useRef, useState, useEffect } from '@wordpress/element';\nimport isShallowEqual from '@wordpress/is-shallow-equal';\n\n/**\n * Internal dependencies\n */\nimport BlockPopover from '../components/block-popover';\nimport { getSpacingPresetCssVar } from '../components/spacing-sizes-control/utils';\n\nexport function MarginVisualizer( { clientId, attributes, forceShow } ) {\n\tconst margin = attributes?.style?.spacing?.margin;\n\n\tconst style = useMemo( () => {\n\t\tconst marginTop = margin?.top\n\t\t\t? getSpacingPresetCssVar( margin?.top )\n\t\t\t: 0;\n\t\tconst marginRight = margin?.right\n\t\t\t? getSpacingPresetCssVar( margin?.right )\n\t\t\t: 0;\n\t\tconst marginBottom = margin?.bottom\n\t\t\t? getSpacingPresetCssVar( margin?.bottom )\n\t\t\t: 0;\n\t\tconst marginLeft = margin?.left\n\t\t\t? getSpacingPresetCssVar( margin?.left )\n\t\t\t: 0;\n\n\t\treturn {\n\t\t\tborderTopWidth: marginTop,\n\t\t\tborderRightWidth: marginRight,\n\t\t\tborderBottomWidth: marginBottom,\n\t\t\tborderLeftWidth: marginLeft,\n\t\t\ttop: marginTop ? `calc(${ marginTop } * -1)` : 0,\n\t\t\tright: marginRight ? `calc(${ marginRight } * -1)` : 0,\n\t\t\tbottom: marginBottom ? `calc(${ marginBottom } * -1)` : 0,\n\t\t\tleft: marginLeft ? `calc(${ marginLeft } * -1)` : 0,\n\t\t};\n\t}, [ margin ] );\n\n\tconst [ isActive, setIsActive ] = useState( false );\n\tconst valueRef = useRef( margin );\n\tconst timeoutRef = useRef();\n\n\tconst clearTimer = () => {\n\t\tif ( timeoutRef.current ) {\n\t\t\twindow.clearTimeout( timeoutRef.current );\n\t\t}\n\t};\n\n\tuseEffect( () => {\n\t\tif ( ! isShallowEqual( margin, valueRef.current ) && ! forceShow ) {\n\t\t\tsetIsActive( true );\n\t\t\tvalueRef.current = margin;\n\n\t\t\ttimeoutRef.current = setTimeout( () => {\n\t\t\t\tsetIsActive( false );\n\t\t\t}, 400 );\n\t\t}\n\n\t\treturn () => {\n\t\t\tsetIsActive( false );\n\t\t\tclearTimer();\n\t\t};\n\t}, [ margin, forceShow ] );\n\n\tif ( ! isActive && ! forceShow ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<BlockPopover\n\t\t\tclientId={ clientId }\n\t\t\t__unstableCoverTarget\n\t\t\t__unstableRefreshSize={ margin }\n\t\t\t__unstablePopoverSlot=\"block-toolbar\"\n\t\t\tshift={ false }\n\t\t>\n\t\t\t<div className=\"block-editor__padding-visualizer\" style={ style } />\n\t\t</BlockPopover>\n\t);\n}\n"]}