{"version":3,"sources":["@wordpress/wordcount/src/index.js"],"names":["defaultSettings","stripTags","transposeAstralsToCountableChar","stripHTMLEntities","stripConnectors","stripRemovables","stripHTMLComments","stripShortcodes","stripSpaces","transposeHTMLEntitiesToCountableChars","loadSettings","type","userSettings","settings","Object","assign","shortcodes","l10n","length","shortcodesRegExp","RegExp","join","countWords","text","regex","bind","reduce","result","fn","match","countCharacters","count","matchRegExp","wordsRegExp","characters_including_spacesRegExp","characters_excluding_spacesRegExp"],"mappings":"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","sourcesContent":["/**\n * Internal dependencies\n */\nimport { defaultSettings } from './defaultSettings';\nimport stripTags from './stripTags';\nimport transposeAstralsToCountableChar from './transposeAstralsToCountableChar';\nimport stripHTMLEntities from './stripHTMLEntities';\nimport stripConnectors from './stripConnectors';\nimport stripRemovables from './stripRemovables';\nimport stripHTMLComments from './stripHTMLComments';\nimport stripShortcodes from './stripShortcodes';\nimport stripSpaces from './stripSpaces';\nimport transposeHTMLEntitiesToCountableChars from './transposeHTMLEntitiesToCountableChars';\n\n/**\n * @typedef {import('./defaultSettings').WPWordCountDefaultSettings}  WPWordCountSettings\n * @typedef {import('./defaultSettings').WPWordCountUserSettings}     WPWordCountUserSettings\n */\n\n/**\n * Possible ways of counting.\n *\n * @typedef {'words'|'characters_excluding_spaces'|'characters_including_spaces'} WPWordCountStrategy\n */\n\n/**\n * Private function to manage the settings.\n *\n * @param {WPWordCountStrategy}     type         The type of count to be done.\n * @param {WPWordCountUserSettings} userSettings Custom settings for the count.\n *\n * @return {WPWordCountSettings} The combined settings object to be used.\n */\nfunction loadSettings( type, userSettings ) {\n\tconst settings = Object.assign( {}, defaultSettings, userSettings );\n\n\tsettings.shortcodes = settings.l10n?.shortcodes ?? [];\n\n\tif ( settings.shortcodes && settings.shortcodes.length ) {\n\t\tsettings.shortcodesRegExp = new RegExp(\n\t\t\t'\\\\[\\\\/?(?:' + settings.shortcodes.join( '|' ) + ')[^\\\\]]*?\\\\]',\n\t\t\t'g'\n\t\t);\n\t}\n\n\tsettings.type = type;\n\n\tif (\n\t\tsettings.type !== 'characters_excluding_spaces' &&\n\t\tsettings.type !== 'characters_including_spaces'\n\t) {\n\t\tsettings.type = 'words';\n\t}\n\n\treturn settings;\n}\n\n/**\n * Count the words in text\n *\n * @param {string}              text     The text being processed\n * @param {RegExp}              regex    The regular expression pattern being matched\n * @param {WPWordCountSettings} settings Settings object containing regular expressions for each strip function\n *\n * @return {number} Count of words.\n */\nfunction countWords( text, regex, settings ) {\n\ttext = [\n\t\tstripTags.bind( null, settings ),\n\t\tstripHTMLComments.bind( null, settings ),\n\t\tstripShortcodes.bind( null, settings ),\n\t\tstripSpaces.bind( null, settings ),\n\t\tstripHTMLEntities.bind( null, settings ),\n\t\tstripConnectors.bind( null, settings ),\n\t\tstripRemovables.bind( null, settings ),\n\t].reduce( ( result, fn ) => fn( result ), text );\n\ttext = text + '\\n';\n\treturn text.match( regex )?.length ?? 0;\n}\n\n/**\n * Count the characters in text\n *\n * @param {string}              text     The text being processed\n * @param {RegExp}              regex    The regular expression pattern being matched\n * @param {WPWordCountSettings} settings Settings object containing regular expressions for each strip function\n *\n * @return {number} Count of characters.\n */\nfunction countCharacters( text, regex, settings ) {\n\ttext = [\n\t\tstripTags.bind( null, settings ),\n\t\tstripHTMLComments.bind( null, settings ),\n\t\tstripShortcodes.bind( null, settings ),\n\t\ttransposeAstralsToCountableChar.bind( null, settings ),\n\t\tstripSpaces.bind( null, settings ),\n\t\ttransposeHTMLEntitiesToCountableChars.bind( null, settings ),\n\t].reduce( ( result, fn ) => fn( result ), text );\n\ttext = text + '\\n';\n\treturn text.match( regex )?.length ?? 0;\n}\n\n/**\n * Count some words.\n *\n * @param {string}                  text         The text being processed\n * @param {WPWordCountStrategy}     type         The type of count. Accepts 'words', 'characters_excluding_spaces', or 'characters_including_spaces'.\n * @param {WPWordCountUserSettings} userSettings Custom settings object.\n *\n * @example\n * ```js\n * import { count } from '@wordpress/wordcount';\n * const numberOfWords = count( 'Words to count', 'words', {} )\n * ```\n *\n * @return {number} The word or character count.\n */\nexport function count( text, type, userSettings ) {\n\tconst settings = loadSettings( type, userSettings );\n\tlet matchRegExp;\n\tswitch ( settings.type ) {\n\t\tcase 'words':\n\t\t\tmatchRegExp = settings.wordsRegExp;\n\t\t\treturn countWords( text, matchRegExp, settings );\n\t\tcase 'characters_including_spaces':\n\t\t\tmatchRegExp = settings.characters_including_spacesRegExp;\n\t\t\treturn countCharacters( text, matchRegExp, settings );\n\t\tcase 'characters_excluding_spaces':\n\t\t\tmatchRegExp = settings.characters_excluding_spacesRegExp;\n\t\t\treturn countCharacters( text, matchRegExp, settings );\n\t\tdefault:\n\t\t\treturn 0;\n\t}\n}\n"]}